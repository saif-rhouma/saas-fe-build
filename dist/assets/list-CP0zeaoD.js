import{r as m,j as t,w as B,bG as F,bL as A,y as N,I as g,dz as L,bI as w,bJ as S,e as R,S as T,o as q,dC as H,eq as K,dL as M,p as x,eb as O,R as Q,aF as z,B as $,dB as G,er as J,dM as b,dK as j,dN as P,ef as W,H as U,C as V}from"./index-C-IhHuTJ.js";import{u as _,E as X}from"./error-block-BR6CrtTz.js";import{u as y}from"./useMutation-CsQJW4rY.js";import{C as Y}from"./custom-breadcrumbs-uFAKtVA_.js";import{u as Z,g as ee,r as te,T as se,a as ae,e as ne}from"./table-selected-action-BOiNrM4L.js";import{T as oe}from"./table-no-data-CPZHThY_.js";import{T as re,a as ie,b as le,c as de}from"./table-head-custom-c1vpDJbN.js";import{T as ce}from"./table-pagination-custom-RNRyjqlB.js";import{F as me,a as he,c as ue}from"./filters-result-CL5afXpK.js";import{C as fe}from"./Chip-DE7nSvgd.js";import{C as pe}from"./confirm-dialog-CKBnhmtr.js";import{T as p}from"./TableCell-YKx_Gzup.js";import{T as xe}from"./TextField-9UQBwjuM.js";import{I as ge}from"./InputAdornment-epef3vq8.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./Checkbox-OM-b9iKh.js";import"./empty-content-CHLoRVuk.js";import"./TablePagination-CKbxZQl-.js";import"./LastPage-C_sr1jh1.js";import"./Select-aS6O7ajU.js";import"./Menu-CrioubDI.js";import"./utils-DoM3o7-Q.js";import"./formControlState-Dq1zat_P.js";import"./InputBase-T30htlau.js";import"./FormControlLabel-BpukUZ1g.js";import"./DialogContent-7B2ADHjp.js";import"./DialogTitle-DncFMmYB.js";import"./FormControl-Cqn5KMTu.js";import"./InputLabel-Di_kJ4FW.js";import"./FormLabel-Cjr_5zdF.js";import"./FormHelperText-Bk0TYkV4.js";function be({filters:e,totalResults:s,onResetPage:i,sx:d}){const c=m.useCallback(()=>{i(),e.setState({name:""})},[e,i]),a=m.useCallback(()=>{i(),e.onResetState()},[e,i]);return t.jsx(me,{totalResults:s,onReset:a,sx:d,children:t.jsx(he,{label:"Keyword:",isShow:!!e.state.name,children:t.jsx(fe,{...ue,label:e.state.name,onDelete:c})})})}const je=({row:e,selected:s,onEditRow:i,onDeleteRow:d,handler:c})=>{const a=B(),l=F(),[r,h]=m.useState(e==null?void 0:e.isActive);m.useEffect(()=>{h(e==null?void 0:e.isActive)},[e]);const n=f=>()=>{h(!r),c({id:f,isActive:!r})},u=t.jsxs(re,{hover:!0,selected:s,children:[t.jsx(p,{children:e==null?void 0:e.id}),t.jsx(p,{children:`${e==null?void 0:e.firstName} ${e==null?void 0:e.lastName}`}),t.jsx(p,{children:e==null?void 0:e.phoneNumber}),t.jsx(p,{children:e==null?void 0:e.email}),t.jsx(p,{children:t.jsx(A,{checked:r,onChange:n(e.id),color:"primary"})}),t.jsx(p,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:t.jsx(N,{color:l.open?"inherit":"default",onClick:l.onOpen,children:t.jsx(g,{icon:"eva:more-vertical-fill"})})})]});return t.jsxs(t.Fragment,{children:[u,t.jsx(L,{open:l.open,anchorEl:l.anchorEl,onClose:l.onClose,slotProps:{arrow:{placement:"right-top"}},children:t.jsxs(w,{children:[t.jsxs(S,{onClick:()=>{i()},children:[t.jsx(g,{icon:"solar:pen-bold"}),"Edit"]}),t.jsxs(S,{onClick:()=>{a.onTrue(),l.onClose()},sx:{color:"error.main"},children:[t.jsx(g,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),t.jsx(pe,{open:a.value,onClose:a.onFalse,title:"Delete",content:"Are you sure want to delete?",action:t.jsx(R,{variant:"contained",color:"error",onClick:d,children:"Delete"})})]})};function Ce({filters:e,onResetPage:s,options:i}){const d=m.useCallback(c=>{s(),e.setState({name:c.target.value})},[e,s]);return t.jsx(T,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:t.jsx(xe,{sx:{width:420},value:e.state.name,onChange:d,placeholder:"Search staff or email...",InputProps:{startAdornment:t.jsx(ge,{position:"start",children:t.jsx(g,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}const Se=[{id:"reminderId",label:"#",width:140},{id:"staffName",label:"Staff Name",width:280},{id:"phoneNumber",label:"Phone Number"},{id:"emailAddress",label:"Email Address"},{id:"status",label:"Status"},{id:"",width:88}],Pe=({staffs:e})=>{const s=Z({defaultOrderBy:"orderNumber"}),i=q(),[d,c]=m.useState(e),a=H({name:"",status:"all",startDate:null,endDate:null});m.useEffect(()=>{c(e)},[e]);const l=K(a.state.startDate,a.state.endDate),r=ye({inputData:d,comparator:ee(s.order,s.orderBy),filters:a.state,dateError:l}),h=te(r,s.page,s.rowsPerPage),n=!!a.state.name||a.state.status!=="all"||!!a.state.startDate&&!!a.state.endDate,u=!r.length&&n||!r.length,f=m.useCallback(o=>{D(o)},[h.length,s,d]),C=M(),{mutate:v}=y({mutationFn:o=>b.patch(j.staff.edit,o),onSuccess:async()=>{P.success("Staff Has Been Modified!")},onSettled:async()=>{await C.invalidateQueries({queryKey:["staffs"]})},onError:o=>{console.log(o)}}),{mutate:D}=y({mutationFn:o=>b.delete(j.staff.delete+o),onSuccess:async o=>{const I=d.filter(k=>k.id!==o);P.success("Delete success!"),c(I),s.onUpdatePageDeleteRow(h.length)},onSettled:async()=>{await C.invalidateQueries({queryKey:["staffs"]})},onError:()=>{}}),E=m.useCallback(o=>{i.push(x.dashboard.staff.edit(o))},[i]);return t.jsx(O,{maxWidth:"xl",children:t.jsxs(T,{spacing:3,children:[t.jsx(Y,{links:[{name:"Dashboard",href:x.dashboard.root},{name:"Staff",href:x.dashboard.staff.root}],action:t.jsx(R,{component:Q,href:x.dashboard.staff.new,variant:"contained",startIcon:t.jsx(g,{icon:"mingcute:add-line"}),children:"Add New Staff"})}),t.jsxs(z,{children:[t.jsx(Ce,{filters:a,onResetPage:s.onResetPage,dateError:l}),n&&t.jsx(be,{filters:a,totalResults:r.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),t.jsxs($,{sx:{position:"relative"},children:[t.jsx(se,{dense:s.dense,numSelected:s.selected.length,rowCount:r.length}),t.jsx(G,{sx:{minHeight:444},children:t.jsxs(ie,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[t.jsx(le,{order:s.order,orderBy:s.orderBy,headLabel:Se,rowCount:r.length}),t.jsxs(de,{children:[r.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(o=>t.jsx(je,{row:o,selected:s.selected.includes(o.id),onSelectRow:()=>s.onSelectRow(o.id),onDeleteRow:()=>f(o.id),onEditRow:()=>E(o.id),handler:v},o.id)),t.jsx(ae,{height:s.dense?56:76,emptyRows:ne(s.page,s.rowsPerPage,r.length)}),t.jsx(oe,{notFound:u})]})]})})]}),t.jsx(ce,{page:s.page,dense:s.dense,count:r.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})]})})};function ye({inputData:e,comparator:s,filters:i,dateError:d}){const{status:c,name:a,startDate:l,endDate:r}=i,h=e.map((n,u)=>[n,u]);return h.sort((n,u)=>{const f=s(n[0],u[0]);return f!==0?f:n[1]-u[1]}),e=h.map(n=>n[0]),a&&(e=e.filter(n=>n.id.toString().toLowerCase().indexOf(a.toLowerCase())!==-1||n.staffName.toLowerCase().indexOf(a.toLowerCase())!==-1)),c!=="all"&&(e=e.filter(n=>n.status===c)),d||l&&r&&(e=e.filter(n=>J(n.createdAt,l,r))),e}const Re={title:`Staff list | Dashboard - ${V.site.name}`};function nt(){const e=_({queryKey:["staffs"],queryFn:async()=>{const{data:s}=await b.get(j.staff.list);return s}});return e.isPending||e.isLoading?t.jsx(W,{}):e.isError?t.jsx(X,{route:x.dashboard.staff.root}):t.jsxs(t.Fragment,{children:[t.jsx(U,{children:t.jsxs("title",{children:[" ",Re.title]})}),t.jsx(Pe,{staffs:e.data})]})}export{nt as default};
