import{w as y,bI as v,j as e,L as B,aN as L,dw as F,y as R,I as j,dB as I,bK as A,bL as p,e as D,r as h,S as E,eu as N,o as O,dE as H,er as q,p as b,ed as z,G as w,R as K,aH as G,B as M,dy as Q,dD as V,es as W,eh as $,H as _,C as J,dO as U,dM as X}from"./index-DxrsDIwY.js";import{u as Y,E as Z}from"./error-block-Cg6RpAZK.js";import{C as T}from"./confirm-dialog-tDH-oZWO.js";import{C as ee}from"./custom-breadcrumbs-Dd3lNCwD.js";import{u as te,g as ae,r as se,T as ne,a as oe,e as re}from"./table-selected-action-DOkqk6zb.js";import{T as le}from"./table-no-data-DzXXEfeL.js";import{T as ie,a as de,b as ce,c as he}from"./table-head-custom-w-4MLJlt.js";import{T as me}from"./table-pagination-custom-BDQuCrzU.js";import{T as x}from"./TableCell-CJNt5t20.js";import{C as ue}from"./Checkbox-ylG2wecL.js";import{T as xe}from"./TextField-C2VP4uls.js";import{I as pe}from"./InputAdornment-D2FMqto9.js";import{S as je}from"./Select-eQVewVvt.js";import{F as be,a as f,c as P}from"./filters-result-Br0EFulp.js";import{C as S}from"./Chip-Bq-6ExUD.js";import"./incrementer-button-BtQ5_PmY.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./DialogContent-262oYdAn.js";import"./DialogTitle-C_65wNCI.js";import"./empty-content-Der9frKm.js";import"./TablePagination-Bol3AgoD.js";import"./LastPage-Ct_4tubK.js";import"./InputBase-B9Lf9cs-.js";import"./formControlState-Dq1zat_P.js";import"./utils-DoM3o7-Q.js";import"./FormControlLabel-DKxiCaQc.js";import"./FormControl-CC-u2HkW.js";import"./InputLabel-CQVMsmZY.js";import"./FormLabel-EgLeF9WB.js";import"./FormHelperText-DMsDqsw2.js";import"./Menu-C6l2dIf8.js";function ge({row:t,selected:a,onViewRow:o,onEditRow:c,onSelectRow:m,onDeleteRow:d}){var n,u;const s=y();y();const r=v(),l=e.jsxs(ie,{hover:!0,selected:a,children:[e.jsx(x,{padding:"checkbox",children:e.jsx(ue,{checked:a,onClick:m,inputProps:{id:`row-checkbox-${t.id}`,"aria-label":"Row checkbox"}})}),e.jsx(x,{children:e.jsxs(B,{color:"inherit",onClick:o,underline:"always",sx:{cursor:"pointer"},children:["PLN-",t.id]})}),e.jsx(x,{children:L(t.planDate)}),e.jsx(x,{children:t.product.name}),e.jsxs(x,{align:"center",children:[" ",t.quantity," "]}),e.jsx(x,{children:e.jsx(F,{variant:"soft",color:t.status==="completed"&&"success"||t.status==="Pending"&&"warning"||t.status==="cancelled"&&"error"||"default",children:t.status})}),e.jsxs(x,{children:[(n=t.createdBy)==null?void 0:n.firstName," ",(u=t.createdBy)==null?void 0:u.lastName]}),e.jsx(x,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:e.jsx(R,{color:r.open?"inherit":"default",onClick:r.onOpen,children:e.jsx(j,{icon:"eva:more-vertical-fill"})})})]});return e.jsxs(e.Fragment,{children:[l,e.jsx(I,{open:r.open,anchorEl:r.anchorEl,onClose:r.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(A,{children:[e.jsxs(p,{onClick:()=>{o(),r.onClose()},children:[e.jsx(j,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(p,{onClick:()=>{c(),r.onClose()},children:[e.jsx(j,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(p,{onClick:()=>{s.onTrue(),r.onClose()},sx:{color:"error.main"},children:[e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(T,{open:s.value,onClose:s.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(D,{variant:"contained",color:"error",onClick:d,children:"Delete"})})]})}function Ce({filters:t,onResetPage:a}){const[o,c]=h.useState("all"),m=h.useCallback(s=>{a(),t.setState({name:s.target.value})},[t,a]),d=h.useCallback(s=>{a(),t.setState({status:s.target.value}),c(s.target.value)},[t,a]);return e.jsxs(E,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:[e.jsx(xe,{sx:{width:420},value:t.state.name,onChange:m,placeholder:"Search by product or plan number...",InputProps:{startAdornment:e.jsx(pe,{position:"start",children:e.jsx(j,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),e.jsxs(je,{sx:{width:420,textTransform:"capitalize"},value:o,onChange:d,children:[e.jsx(p,{value:"all",children:"All Plans"}),e.jsx(p,{value:"Pending",children:"Pending"}),e.jsx(p,{value:"ProcessingA",children:"Processing-A"}),e.jsx(p,{value:"ProcessingB",children:"Processing-B"}),e.jsx(p,{value:"Ready",children:"Ready"})]})]})}function we({filters:t,totalResults:a,onResetPage:o,sx:c}){const m=h.useCallback(()=>{o(),t.setState({name:""})},[t,o]),d=h.useCallback(()=>{o(),t.setState({status:"all"})},[t,o]),s=h.useCallback(()=>{o(),t.setState({startDate:null,endDate:null})},[t,o]),r=h.useCallback(()=>{o(),t.onResetState()},[t,o]);return e.jsxs(be,{totalResults:a,onReset:r,sx:c,children:[e.jsx(f,{label:"Status:",isShow:t.state.status!=="all",children:e.jsx(S,{...P,label:t.state.status,onDelete:d,sx:{textTransform:"capitalize"}})}),e.jsx(f,{label:"Date:",isShow:!!(t.state.startDate&&t.state.endDate),children:e.jsx(S,{...P,label:N(t.state.startDate,t.state.endDate),onDelete:s})}),e.jsx(f,{label:"Keyword:",isShow:!!t.state.name,children:e.jsx(S,{...P,label:t.state.name,onDelete:m})})]})}const fe=[{id:"planId",label:"Plan ID",width:60},{id:"planDate",label:"Plan Date",width:140},{id:"product",label:"Product",width:140},{id:"quantity",label:"Quantity",width:120,align:"center"},{id:"status",label:"Status",width:140},{id:"createdBy",label:"Created By",width:140},{id:"",width:88}];function Pe({plans:t}){const a=te({defaultOrderBy:"planId"}),o=O(),c=y(),[m,d]=h.useState(t),s=H({name:"",status:"all",startDate:null,endDate:null});h.useEffect(()=>{d(t)},[t]);const r=q(s.state.startDate,s.state.endDate),l=Se({inputData:m,comparator:ae(a.order,a.orderBy),filters:s.state,dateError:r});se(l,a.page,a.rowsPerPage);const n=!!s.state.name||s.state.status!=="all"||!!s.state.startDate&&!!s.state.endDate,u=!l.length&&n||!l.length,g=h.useCallback(i=>{o.push(b.dashboard.plan.details(i))},[o]),k=h.useCallback(i=>{o.push(b.dashboard.plan.edit(i))},[o]);return e.jsxs(e.Fragment,{children:[e.jsx(z,{maxWidth:"xl",children:e.jsxs(w,{container:!0,spacing:3,children:[e.jsx(w,{xs:12,md:12,children:e.jsx(ee,{links:[{name:"Dashboard",href:b.dashboard.root},{name:"Plan",href:b.dashboard.plan.root},{name:"List"}],action:e.jsx(D,{component:K,href:b.dashboard.plan.new,variant:"contained",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),children:"Add New Plan"})})}),e.jsx(w,{xs:12,md:12,children:e.jsxs(G,{children:[e.jsx(Ce,{filters:s,onResetPage:a.onResetPage,dateError:r}),n&&e.jsx(we,{filters:s,totalResults:l.length,onResetPage:a.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(M,{sx:{position:"relative"},children:[e.jsx(ne,{dense:a.dense,numSelected:a.selected.length,rowCount:l.length,onSelectAllRows:i=>a.onSelectAllRows(i,l.map(C=>C.id)),action:e.jsx(Q,{title:"Delete",children:e.jsx(R,{color:"primary",onClick:c.onTrue,children:e.jsx(j,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(V,{sx:{minHeight:444},children:e.jsxs(de,{size:a.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(ce,{order:a.order,orderBy:a.orderBy,headLabel:fe,rowCount:l.length,numSelected:a.selected.length,onSort:a.onSort,onSelectAllRows:i=>a.onSelectAllRows(i,l.map(C=>C.id))}),e.jsxs(he,{children:[l.slice(a.page*a.rowsPerPage,a.page*a.rowsPerPage+a.rowsPerPage).map(i=>e.jsx(ge,{row:i,selected:a.selected.includes(i.id),onSelectRow:()=>a.onSelectRow(i.id),onDeleteRow:()=>handleDeleteRow(i.id),onViewRow:()=>g(i.id),onEditRow:()=>k(i.id)},i.id)),e.jsx(oe,{height:a.dense?56:76,emptyRows:re(a.page,a.rowsPerPage,l.length)}),e.jsx(le,{notFound:u})]})]})})]}),e.jsx(me,{page:a.page,dense:a.dense,count:l.length,rowsPerPage:a.rowsPerPage,onPageChange:a.onChangePage,onChangeDense:a.onChangeDense,onRowsPerPageChange:a.onChangeRowsPerPage})]})})]})}),e.jsx(T,{open:c.value,onClose:c.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",a.selected.length," "]})," items?"]}),action:e.jsx(D,{variant:"contained",color:"error",onClick:()=>{handleDeleteRows(),c.onFalse()},children:"Delete"})})]})}function Se({inputData:t,comparator:a,filters:o,dateError:c}){const{status:m,name:d,startDate:s,endDate:r}=o,l=t.map((n,u)=>[n,u]);return l.sort((n,u)=>{const g=a(n[0],u[0]);return g!==0?g:n[1]-u[1]}),t=l.map(n=>n[0]),d&&(t=t.filter(n=>n.id.toString().toLowerCase().indexOf(d.toLowerCase())!==-1||n.product.name.toLowerCase().indexOf(d.toLowerCase())!==-1||n.createdBy.firstName.toLowerCase().indexOf(d.toLowerCase())!==-1||n.createdBy.lastName.toLowerCase().indexOf(d.toLowerCase())!==-1)),m!=="all"&&(t=t.filter(n=>n.status===m)),c||s&&r&&(t=t.filter(n=>W(n.createdAt,s,r))),t}const ye={title:`Plan list | Dashboard - ${J.site.name}`};function nt(){const t=Y({queryKey:["plans"],queryFn:async()=>(await U.get(X.plan.list)).data});return t.isPending||t.isLoading?e.jsx($,{}):t.isError?e.jsx(Z,{route:b.dashboard.plan.root}):e.jsxs(e.Fragment,{children:[e.jsx(_,{children:e.jsxs("title",{children:[" ",ye.title]})}),e.jsx(Pe,{plans:t.data})]})}export{nt as default};
