import{j as t,B as s,S as r,T as E,ew as F,du as I,e as j,I as k,aF as P,aL as v,dB as R,r as h,w as L,dL as N,ex as T,eb as q,p as g,G as f,dM as b,dK as D,dN as C,ef as H,H as $,C as K}from"./index-DAC7DrKI.js";import{u as Q,E as G}from"./error-block-DySOa_eo.js";import{u as M}from"./use-params-BPKTstAt.js";import"./chart-legends-CcNJazeA.js";import{l as W,O as z}from"./order-payment-details-dialog-BWALkep4.js";import{u as O}from"./useMutation-Ds6FyOSf.js";import{C as J}from"./custom-breadcrumbs-DLqq1jlX.js";import{b as m}from"./format-number-BqWqqWdN.js";import{T as V}from"./TextField-BemIARnN.js";import{T as X,t as U,a as Y,b as Z,c as _,d as tt,e as et}from"./TimelineSeparator-BVfsg25G.js";import{C as B}from"./CardHeader-HsFNWzRV.js";import{O as st}from"./order-product-table-C0aCRlMG.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./index-F5Z3hI1r.js";import"./form-provider-w6GRwc9n.js";import"./countries-DSLisFCy.js";import"./InputAdornment-Coc5CotZ.js";import"./upload-avatar-CXZ0NYIu.js";import"./FormHelperText-DDJizVQ2.js";import"./formControlState-Dq1zat_P.js";import"./image-uXppHbLd.js";import"./fields-D3apoPNI.js";import"./Rating-JqEjmuzB.js";import"./visuallyHidden-Dan1xhjv.js";import"./editor-DHP9j2dL.js";import"./Menu-CO2UhTso.js";import"./index-BgeSHDfL.js";import"./Slider-DKXce_Ll.js";import"./FormControl-CAs0fYHm.js";import"./utils-DoM3o7-Q.js";import"./FormLabel-Ohl1t8N_.js";import"./RadioGroup-Cu8878NJ.js";import"./FormGroup-BF5sRrAl.js";import"./FormControlLabel-Dpb-wuL-.js";import"./Autocomplete-Bdm7MKsx.js";import"./Select-VxgK60LB.js";import"./InputBase-CinKVcWY.js";import"./Chip-BV006SG6.js";import"./country-select-B-YEZ-QO.js";import"./InputLabel-BgYGZs-G.js";import"./Checkbox-aWzJpCDA.js";import"./DatePicker-B0W1aFhA.js";import"./DialogContent-CNnwUfBT.js";import"./ListItem-Dtgjcfn6.js";import"./MobileDateTimePicker-DX-_JOo5.js";import"./schema-helper-D1xNGTQ3.js";import"./DialogTitle-BHD_nV8d.js";import"./LoadingButton-CI8i-ssx.js";import"./CircularProgress-DD9i2_Ze.js";import"./table-head-custom-54sFYCX7.js";import"./TableCell-BaRSSNo0.js";import"./incrementer-button-BLReogVb.js";const it=({order:a,payments:e,dialog:o,handleApproveOrder:d,handlePrint:x})=>{const n=t.jsxs(s,{sx:{pr:4,pl:4,pb:4,pt:2},children:[t.jsx(s,{sx:{mb:2},children:t.jsx(V,{size:"small",fullWidth:!0})}),t.jsx(r,{sx:{typography:"subtitle2",width:"100%",marginBottom:1},children:t.jsx("div",{children:"Payments"})}),t.jsx(X,{sx:{p:0,m:0,[`& .${U.root}:before`]:{flex:0,padding:0}},children:e==null?void 0:e.map((l,p)=>{const c=p===0,u=p===e.length-1;return t.jsxs(Y,{children:[t.jsxs(Z,{children:[t.jsx(_,{color:c&&"primary"||"grey"}),u?null:t.jsx(tt,{})]}),t.jsx(et,{children:t.jsxs(s,{sx:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs(s,{children:[t.jsx(E,{variant:"subtitle2",children:m(l.amount)}),t.jsx(s,{sx:{color:"text.disabled",typography:"caption",mt:.5},children:F(l.paymentDate)})]}),t.jsx(I,{color:"success",children:l.paymentType})]})})]},l.id)})}),t.jsxs(r,{justifyContent:"flex-end",spacing:1.5,sx:{marginTop:2},children:[t.jsx(j,{variant:"contained",onClick:()=>o.onTrue(),children:"Add Payment"}),(a==null?void 0:a.status)==="Draft"&&t.jsx(j,{variant:"outlined",onClick:()=>{d(a.id)},children:"Approve"}),t.jsxs(j,{variant:"outlined",color:"info",onClick:()=>x(),children:[t.jsx(k,{icon:"solar:printer-minimalistic-bold"}),t.jsx("span",{style:{margin:4},children:"Print Invoice"})]})]})]});return t.jsxs(P,{children:[t.jsx(B,{title:"Product Addons"}),n]})};function nt({taxes:a,order:e,shipping:o,discount:d,subtotal:x,customer:n,totalAmount:l}){const p=t.jsxs(r,{spacing:2,alignItems:"flex-end",sx:{p:3,textAlign:"right",typography:"body2"},children:[t.jsxs(r,{direction:"row",children:[t.jsx(s,{sx:{color:"text.secondary"},children:"Subtotal"}),t.jsx(s,{sx:{width:160,typography:"subtitle2"},children:m(x)||"-"})]}),t.jsxs(r,{direction:"row",children:[t.jsx(s,{sx:{color:"text.secondary"},children:"Addon"}),t.jsx(s,{sx:{width:160,...o&&{color:"error.main"}},children:o?`- ${m(o)}`:"-"})]}),t.jsxs(r,{direction:"row",children:[t.jsx(s,{sx:{color:"text.secondary"},children:"Discount"}),t.jsx(s,{sx:{width:160,...d&&{color:"error.main"}},children:d?`- ${m(d)}`:"-"})]}),t.jsxs(r,{direction:"row",children:[t.jsx(s,{sx:{color:"text.secondary"},children:"Tax (0%)"}),t.jsx(s,{sx:{width:160},children:a?m(a):"-"})]}),t.jsxs(r,{direction:"row",sx:{typography:"subtitle1"},children:[t.jsx("div",{children:"Gross Total"}),t.jsx(s,{sx:{width:160},children:m(l)||"-"})]})]});return t.jsxs(P,{children:[t.jsx(r,{justifyContent:"center",alignItems:"center",children:t.jsxs("h1",{className:"print-title",children:["Order REF: #ORD-",e.id]})}),t.jsx("style",{jsx:!0,children:`
        .print-title {
          display: none; /* Hide on screen */
        }

        @media print {
          .print-title {
            display: block; /* Show only when printing */
          }
          .print-hide {
            display: none; /* Hide on screen */
          }
        }
      `}),t.jsx(B,{className:"print-hide",title:"Details"}),t.jsxs(r,{direction:"row",justifyContent:"space-between",sx:{p:3,typography:"body2"},children:[t.jsxs(s,{flexDirection:"column",sx:{display:"flex",width:"100%",p:1},children:[t.jsx(r,{direction:"row",sx:{typography:"subtitle2",marginBottom:1},children:t.jsx("div",{children:"Order Details"})}),t.jsxs(s,{sx:{color:"text.secondary"},children:["ORDER ID: #ORD-",e.id]}),t.jsxs(s,{sx:{color:"text.secondary"},children:["Order Date: ",v(e.orderDate)]}),t.jsxs(s,{sx:{color:"text.secondary"},children:["Delivery Date: ",e.deliveryDate?v(e.deliveryDate):t.jsx("span",{children:" - "})]})]}),t.jsxs(s,{flexDirection:"column",gap:.5,sx:{display:"flex",width:"100%",p:1,borderRight:c=>`dashed 2px ${c.vars.palette.background.neutral}`,borderLeft:c=>`dashed 2px ${c.vars.palette.background.neutral}`},children:[t.jsx(r,{display:"flex",justifyContent:"center",alignItems:"center",sx:{typography:"subtitle2",width:"100%",marginBottom:1},children:t.jsx("div",{children:"NFCAC"})}),t.jsxs(s,{sx:{color:"text.secondary"},children:["Status :"," ",t.jsx(I,{variant:"soft",color:(e==null?void 0:e.status)==="Ready"&&"info"||(e==null?void 0:e.status)==="InProcess"&&"warning"||(e==null?void 0:e.status)==="Delivered"&&"success"||"default",children:e==null?void 0:e.status})]}),t.jsxs(s,{sx:{color:"text.secondary"},children:["TAX: ",n==null?void 0:n.taxNumber]})]}),t.jsxs(s,{flexDirection:"column",alignItems:"center",sx:{p:1,display:"flex",width:"100%"},children:[t.jsx(r,{display:"flex",alignItems:"center",gap:1,sx:{typography:"subtitle2",width:"100%",marginBottom:1},children:t.jsx("div",{children:"Invoice To"})}),t.jsx(s,{sx:{color:"text.secondary"},children:n==null?void 0:n.name}),t.jsxs(s,{sx:{color:"text.secondary"},children:["Tel: ",n==null?void 0:n.phoneNumber]})]})]}),t.jsx(R,{children:t.jsx(s,{fullWidth:!0,alignItems:"center",sx:{p:3,borderBottom:c=>`dashed 2px ${c.vars.palette.background.neutral}`},children:t.jsx(st,{products:e.productToOrder,isDetail:!0})})}),p,(e==null?void 0:e.notes)&&t.jsx(r,{justifyContent:"space-between",sx:{p:3,typography:"body2"},children:t.jsxs(s,{flexDirection:"column",sx:{display:"flex",width:"100%",p:1},children:[t.jsx(r,{sx:{typography:"subtitle2",marginBottom:1},children:t.jsx("div",{children:"Notes:"})}),t.jsx(s,{sx:{color:"text.secondary"},children:e==null?void 0:e.notes})]})})]})}function rt({currentOrder:a}){var w;const[e,o]=h.useState(a),d=h.useRef(),x=L(),n=N(),[l,p]=h.useState([]);h.useEffect(()=>{const i=T(e==null?void 0:e.payments,"paymentDate");p(i)},[e==null?void 0:e.payments]);const{mutate:c}=O({mutationFn:i=>b.post(D.payments.create,i),onSuccess:async i=>{C.success("New Payment Has Been Created!");const{data:y}=i,A=T([...l,y],"paymentDate");p(A)},onSettled:async()=>{await n.invalidateQueries({queryKey:["payments"]});const{id:i}=e;await n.invalidateQueries({queryKey:["order",i]}),x.onFalse()},onError:i=>{console.log(i)}}),{mutate:u}=O({mutationFn:i=>b.get(D.order.approve+i),onSuccess:async i=>{C.success("Order Has Been Approved!");const{data:y}=i;o(y)},onSettled:async()=>{const{id:i}=e;await n.invalidateQueries({queryKey:["orders"]}),await n.invalidateQueries({queryKey:["order",i]})},onError:i=>{console.log(i)}}),S=W.useReactToPrint({content:()=>d.current});return t.jsxs(q,{children:[t.jsx(J,{links:[{name:"Dashboard",href:g.dashboard.root},{name:"Order",href:g.dashboard.order.root},{name:"Order Details"}],sx:{mb:{xs:3,md:5}}}),t.jsxs(f,{container:!0,spacing:3,children:[t.jsx(f,{xs:12,md:9,children:t.jsx(r,{ref:d,spacing:3,direction:{xs:"column-reverse",md:"column"},children:t.jsx(nt,{order:e,customer:e==null?void 0:e.customer,taxes:(w=e==null?void 0:e.customer)==null?void 0:w.customer,shipping:e==null?void 0:e.shipping,discount:e==null?void 0:e.discount,subtotal:e==null?void 0:e.subtotal,totalAmount:e==null?void 0:e.totalOrderAmount})})}),t.jsx(f,{xs:12,md:3,children:t.jsx(it,{order:e,payments:l,dialog:x,handleApproveOrder:u,handlePrint:S})})]}),t.jsx(z,{order:e,open:x.value,onClose:x.onFalse,handler:c})]})}const at={title:`Order details | Dashboard - ${K.site.name}`};function oe(){const{id:a=""}=M(),e=Q({queryKey:["order",a],queryFn:async()=>{const{data:o}=await b.get(D.order.details+a);return o}});return e.isPending||e.isLoading?t.jsx(H,{}):e.isError?t.jsx(G,{route:g.dashboard.order.root}):t.jsxs(t.Fragment,{children:[t.jsx($,{children:t.jsxs("title",{children:[" ",at.title]})}),t.jsx(rt,{currentOrder:e.data})]})}export{oe as default};
