import{j as s,aF as h,S as o,B as i,aL as y,du as f,dB as j,r as g,dL as b,eb as l,p as a,e as P,I as D,G as n,dM as u,dK as x,dN as S,ef as w,H as B,C}from"./index-DLJImauo.js";import{u as k,E as v}from"./error-block-CpNyIBSO.js";import{u as I}from"./use-params-DeowL31Y.js";import{u as q}from"./useMutation-7HTcUz2p.js";import{C as L}from"./custom-breadcrumbs-B-49wW2q.js";import{P as E}from"./plan-product-table-i8GoGqny.js";import{C as T}from"./CardHeader-DDkjAWap.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./table-head-custom-D67vLreu.js";import"./TableCell-BVBgA4hr.js";import"./Checkbox-iCj-brcW.js";import"./incrementer-button-zlyzDSeh.js";function F({plan:t,products:e}){return s.jsxs(h,{children:[s.jsx(T,{title:"Details"}),s.jsxs(o,{direction:"row",justifyContent:"space-between",sx:{p:3,typography:"body2"},children:[s.jsxs(i,{flexDirection:"column",sx:{display:"flex",width:"100%",p:1},children:[s.jsx(o,{direction:"row",sx:{typography:"subtitle2",marginBottom:1},children:s.jsx("div",{children:"Plan Details"})}),s.jsxs(i,{sx:{color:"text.secondary"},children:["Plan ID: #PLN-",t==null?void 0:t.id]}),s.jsxs(i,{sx:{color:"text.secondary"},children:["Plan Date: ",y(t==null?void 0:t.planDate)]})]}),s.jsxs(i,{flexDirection:"column",gap:.5,sx:{display:"flex",width:"100%",p:1,borderRight:r=>`dashed 2px ${r.vars.palette.background.neutral}`,borderLeft:r=>`dashed 2px ${r.vars.palette.background.neutral}`},children:[s.jsx(o,{display:"flex",justifyContent:"center",alignItems:"center",sx:{typography:"subtitle2",width:"100%",marginBottom:1},children:s.jsx("div",{children:"Laundry Saas POS"})}),s.jsxs(i,{sx:{color:"text.secondary"},children:["Quantity : ",t==null?void 0:t.quantity]})]}),s.jsxs(i,{flexDirection:"column",alignItems:"center",sx:{p:1,display:"flex",width:"100%"},children:[s.jsx(o,{display:"flex",alignItems:"center",gap:1,sx:{typography:"subtitle2",width:"100%",marginBottom:1},children:s.jsx("div",{children:"Plan Status"})}),s.jsx(f,{variant:"soft",color:(t==null?void 0:t.status)==="Ready"&&"success"||(t==null?void 0:t.status)==="Pending"&&"info"||(t==null?void 0:t.status)==="ProcessingA"&&"warning"||(t==null?void 0:t.status)==="ProcessingB"&&"error"||"default",children:t==null?void 0:t.status})]})]}),s.jsx(j,{children:s.jsx(i,{fullWidth:!0,alignItems:"center",sx:{p:3,borderBottom:r=>`dashed 2px ${r.vars.palette.background.neutral}`},children:s.jsx(E,{products:t==null?void 0:t.product,quantity:t==null?void 0:t.quantity})})})]})}function Q({plan:t}){const[e,r]=g.useState(!(t!=null&&t.isTransferred)&&(t==null?void 0:t.status)==="Ready"),c=b(),{mutate:m}=q({mutationFn:d=>u.post(x.plan.transferToStock+d),onSuccess:async()=>{S.success("Product has been transferred successfully to Stock!"),r(()=>!e)},onSettled:async()=>{const{id:d}=t;await c.invalidateQueries({queryKey:["plans"]}),await c.invalidateQueries({queryKey:["plan",d]})},onError:()=>{}});return s.jsxs(l,{children:[s.jsx(L,{links:[{name:"Dashboard",href:a.dashboard.root},{name:"Plan",href:a.dashboard.plan.root},{name:"Plan Details"}],sx:{mb:{xs:3,md:5}},action:e&&s.jsx(P,{onClick:async()=>{m(t.id)},variant:"contained",startIcon:s.jsx(D,{icon:"solar:home-add-bold"}),children:"Transfer To Stock"})}),s.jsx(n,{container:!0,spacing:3,children:s.jsx(n,{xs:12,md:12,children:s.jsx(o,{spacing:3,direction:{xs:"column-reverse",md:"column"},children:s.jsx(F,{items:t==null?void 0:t.items,plan:t,taxes:t==null?void 0:t.taxes,shipping:t==null?void 0:t.shipping,discount:t==null?void 0:t.discount,subtotal:t==null?void 0:t.subtotal,totalAmount:t==null?void 0:t.totalAmount})})})})]})}const H={title:`Plan details | Dashboard - ${C.site.name}`};function Y(){const{id:t=""}=I(),e=k({queryKey:["plan",t],queryFn:async()=>(await u.get(x.plan.details+t)).data});return e.isPending||e.isLoading?s.jsx(w,{}):e.isError?s.jsx(v,{route:a.dashboard.plan.root}):s.jsxs(s.Fragment,{children:[s.jsx(B,{children:s.jsxs("title",{children:[" ",H.title]})}),s.jsx(Q,{plan:e.data})]})}export{Y as default};
