import{w as P,bG as F,r as h,j as e,bL as B,y as E,I as x,dz as w,bI as A,bJ as j,e as S,S as y,o as N,b as L,dC as H,eq as q,dN as C,dL as K,p as g,eb as M,R as O,aF as z,B as Q,dB as V,er as $,dM as R,dK as T,ef as G,H as J,C as U}from"./index-DLwkls4m.js";import{u as W,E as _}from"./error-block-C30yYsJ6.js";import{u as X}from"./useMutation-Xh_zmf_Z.js";import{C as Y}from"./custom-breadcrumbs-RrbSlijf.js";import{u as Z,g as ee,r as te,T as se,a as ae,e as ne}from"./table-selected-action-Cl0zAfF3.js";import{T as oe}from"./table-no-data-CB8dFdIo.js";import{T as re,a as le,b as ie,c as de}from"./table-head-custom-CxYlI1wv.js";import{T as ce}from"./table-pagination-custom-I1sFEO4C.js";import{C as me}from"./confirm-dialog-B-zGEUbG.js";import{T as p}from"./TableCell-BbkjnoOj.js";import{T as he}from"./TextField-B1Cg5HmH.js";import{I as ue}from"./InputAdornment-MgApCcj1.js";import{F as fe,a as pe,c as xe}from"./filters-result-CVVYvX3A.js";import{C as ge}from"./Chip-BuK2Jq4O.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./Checkbox-ByD5WW94.js";import"./empty-content-G2WqpuZZ.js";import"./TablePagination-3k_k7Jb5.js";import"./LastPage-CCIWXV8U.js";import"./Select-CL6BPU1z.js";import"./Menu-D_Q_wpzJ.js";import"./utils-DoM3o7-Q.js";import"./formControlState-Dq1zat_P.js";import"./InputBase-DNJV1MQo.js";import"./FormControlLabel-7I2uQbxz.js";import"./DialogContent-C4fMf3p5.js";import"./DialogTitle-CwWzRiyw.js";import"./FormControl-SJOyIv6-.js";import"./InputLabel-fkQY0vwD.js";import"./FormLabel-DbiGIO3x.js";import"./FormHelperText-BVmW-5Ni.js";const be=({row:t,selected:s,onViewRow:i,onDeleteRow:d,handler:c})=>{const a=P(),l=F(),[n,m]=h.useState(t==null?void 0:t.isActive);h.useEffect(()=>{m(t==null?void 0:t.isActive)},[t]);const o=f=>()=>{m(!n),c({id:f,isActive:!n})},u=e.jsxs(re,{hover:!0,selected:s,children:[e.jsx(p,{children:t==null?void 0:t.id}),e.jsx(p,{children:`${t==null?void 0:t.firstName} ${t==null?void 0:t.lastName}`}),e.jsx(p,{children:t==null?void 0:t.phoneNumber}),e.jsx(p,{children:t==null?void 0:t.email}),e.jsx(p,{children:e.jsx(B,{checked:n,onChange:o(t.id),color:"primary"})}),e.jsx(p,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:e.jsx(E,{color:l.open?"inherit":"default",onClick:l.onOpen,children:e.jsx(x,{icon:"eva:more-vertical-fill"})})})]});return e.jsxs(e.Fragment,{children:[u,e.jsx(w,{open:l.open,anchorEl:l.anchorEl,onClose:l.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(A,{children:[e.jsxs(j,{onClick:()=>{a.onTrue(),l.onClose()},sx:{color:"error.main"},children:[e.jsx(x,{icon:"solar:trash-bin-trash-bold"}),"Delete"]}),e.jsxs(j,{onClick:()=>{i(),l.onClose()},children:[e.jsx(x,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(j,{onClick:()=>{i(),l.onClose()},children:[e.jsx(x,{icon:"solar:eye-bold"}),"Edit"]})]})}),e.jsx(me,{open:a.value,onClose:a.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(S,{variant:"contained",color:"error",onClick:d,children:"Delete"})})]})};function je({filters:t,onResetPage:s,options:i}){const d=h.useCallback(c=>{s(),t.setState({name:c.target.value})},[t,s]);return e.jsx(y,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(he,{sx:{width:420},value:t.state.name,onChange:d,placeholder:"Search staff or email...",InputProps:{startAdornment:e.jsx(ue,{position:"start",children:e.jsx(x,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}function Ce({filters:t,totalResults:s,onResetPage:i,sx:d}){const c=h.useCallback(()=>{i(),t.setState({name:""})},[t,i]),a=h.useCallback(()=>{i(),t.onResetState()},[t,i]);return e.jsx(fe,{totalResults:s,onReset:a,sx:d,children:e.jsx(pe,{label:"Keyword:",isShow:!!t.state.name,children:e.jsx(ge,{...xe,label:t.state.name,onDelete:c})})})}const Pe=[{id:"reminderId",label:"#",width:140},{id:"staffName",label:"Staff Name",width:280},{id:"phoneNumber",label:"Phone Number"},{id:"emailAddress",label:"Email Address"},{id:"status",label:"Status"},{id:"",width:88}],Se=({staffs:t})=>{const s=Z({defaultOrderBy:"orderNumber"}),i=N();L(),P();const[d,c]=h.useState(t),a=H({name:"",status:"all",startDate:null,endDate:null});h.useEffect(()=>{c(t)},[t]);const l=q(a.state.startDate,a.state.endDate),n=ye({inputData:d,comparator:ee(s.order,s.orderBy),filters:a.state,dateError:l}),m=te(n,s.page,s.rowsPerPage),o=!!a.state.name||a.state.status!=="all"||!!a.state.startDate&&!!a.state.endDate,u=!n.length&&o||!n.length,f=h.useCallback(r=>{const b=d.filter(v=>v.id!==r);C.success("Delete success!"),c(b),s.onUpdatePageDeleteRow(m.length)},[m.length,s,d]);h.useCallback(()=>{const r=d.filter(b=>!s.selected.includes(b.id));C.success("Delete success!"),c(r),s.onUpdatePageDeleteRows({totalRowsInPage:m.length,totalRowsFiltered:n.length})},[n.length,m.length,s,d]);const D=K(),{mutate:k}=X({mutationFn:r=>R.patch(T.staff.edit,r),onSuccess:async()=>{C.success("Staff Has Been Modified!")},onSettled:async()=>{await D.invalidateQueries({queryKey:["staffs"]})},onError:r=>{console.log(r)}}),I=h.useCallback(r=>{i.push(g.dashboard.staff.edit(r))},[i]);return e.jsx(e.Fragment,{children:e.jsx(M,{maxWidth:"xl",children:e.jsxs(y,{spacing:3,children:[e.jsx(Y,{links:[{name:"Dashboard",href:g.dashboard.root},{name:"Staff",href:g.dashboard.staff.root}],action:e.jsx(S,{component:O,href:g.dashboard.staff.new,variant:"contained",startIcon:e.jsx(x,{icon:"mingcute:add-line"}),children:"Add New Staff"})}),e.jsxs(z,{children:[e.jsx(je,{filters:a,onResetPage:s.onResetPage,dateError:l}),o&&e.jsx(Ce,{filters:a,totalResults:n.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(Q,{sx:{position:"relative"},children:[e.jsx(se,{dense:s.dense,numSelected:s.selected.length,rowCount:n.length}),e.jsx(V,{sx:{minHeight:444},children:e.jsxs(le,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(ie,{order:s.order,orderBy:s.orderBy,headLabel:Pe,rowCount:n.length}),e.jsxs(de,{children:[n.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(r=>e.jsx(be,{row:r,selected:s.selected.includes(r.id),onSelectRow:()=>s.onSelectRow(r.id),onDeleteRow:()=>f(r.id),onViewRow:()=>I(r.id),handler:k},r.id)),e.jsx(ae,{height:s.dense?56:76,emptyRows:ne(s.page,s.rowsPerPage,n.length)}),e.jsx(oe,{notFound:u})]})]})})]}),e.jsx(ce,{page:s.page,dense:s.dense,count:n.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})]})})})};function ye({inputData:t,comparator:s,filters:i,dateError:d}){const{status:c,name:a,startDate:l,endDate:n}=i,m=t.map((o,u)=>[o,u]);return m.sort((o,u)=>{const f=s(o[0],u[0]);return f!==0?f:o[1]-u[1]}),t=m.map(o=>o[0]),a&&(t=t.filter(o=>o.id.toString().toLowerCase().indexOf(a.toLowerCase())!==-1||o.staffName.toLowerCase().indexOf(a.toLowerCase())!==-1)),c!=="all"&&(t=t.filter(o=>o.status===c)),d||l&&n&&(t=t.filter(o=>$(o.createdAt,l,n))),t}const Re={title:`Staff list | Dashboard - ${U.site.name}`};function nt(){const t=W({queryKey:["staffs"],queryFn:async()=>{const{data:s}=await R.get(T.staff.list);return s}});return t.isPending||t.isLoading?e.jsx(G,{}):t.isError?e.jsx(_,{route:g.dashboard.staff.root}):e.jsxs(e.Fragment,{children:[e.jsx(J,{children:e.jsxs("title",{children:[" ",Re.title]})}),e.jsx(Se,{staffs:t.data})]})}export{nt as default};
