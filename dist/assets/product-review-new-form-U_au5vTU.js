import{j as e,D as L,S as X,e as F,l as pe,o as Y,r as g,dI as xe,dJ as N,dH as q,dK as B,p as $,aD as he,B as S,I as M,C as ue,dL as z,bN as V,T as ge}from"./index-CGa_Q6Py.js";import{z as f,u as J,t as Z,a as _,F as E}from"./form-provider-B3FvCF-c.js";import{u as H}from"./useMutation-BZyJkW6J.js";import"./image-DKbVqab5.js";import"./editor-COn8_0IM.js";import{C as fe}from"./confirm-dialog-B2c6UDYf.js";import{P as je}from"./product-Item-button-BKk4_42J.js";import{b as ve}from"./upload-avatar-lrMiBpkm.js";import{a as P,b as ee,D as se}from"./DialogContent-CkKaB1Dh.js";import{D as ae}from"./DialogTitle-7P1jGWHj.js";import{L as W}from"./LoadingButton-B5SbTGGo.js";import{A as be,a as ye,b as Ae}from"./AccordionSummary-DYR4C90o.js";import{F as K}from"./FormControlLabel-ULMw-Rz6.js";const Ee=({open:a,onClose:v,handleDrop:d,handleUpload:l,handleDelete:o,file:t})=>e.jsxs(P,{open:a,onClose:v,children:[e.jsx(ae,{children:"Upload Product Image"}),e.jsx(L,{}),e.jsx(ee,{sx:{p:1},children:e.jsx(X,{spacing:1,children:e.jsx(ve,{value:t,onDrop:d,onDelete:o})})}),e.jsxs(se,{children:[e.jsx(W,{type:"submit",variant:"contained",onClick:l,children:"Upload"}),e.jsx(F,{color:"inherit",variant:"outlined",onClick:v,children:"Cancel"})]})]}),Ie=f.object({name:f.string().min(1,{message:"Name is required!"}),price:f.number().min(1,{message:"Price should not be $0.00"}),description:f.string(),isActive:f.boolean()});function Ke({currentProduct:a,productsImages:v}){const d=pe(),l=Y(),o=Y(),t=g.useMemo(()=>({name:(a==null?void 0:a.name)||"",description:(a==null?void 0:a.description)||"",price:(a==null?void 0:a.price)||0,images:(a==null?void 0:a.images)||[],isActive:(a==null?void 0:a.isActive)===void 0?!0:a==null?void 0:a.isActive}),[a]),[n,i]=g.useState(!0),[r,m]=g.useState([]),[c,p]=g.useState(!1),[b,j]=g.useState(),[I,w]=g.useState(),U=J({resolver:Z(Ie),defaultValues:t}),{reset:h,watch:x,setValue:O,handleSubmit:C,formState:{isSubmitting:Q}}=U;g.useEffect(()=>{a&&(h(t),j(a==null?void 0:a.image))},[a,t,h]);const T=C(async s=>{try{if(b&&(s.image=b),a!=null&&a.id){const{id:A}=a;await re({id:A,payload:s})}else await le(s)}catch(A){console.error(A)}}),D=()=>{const s=new FormData;s.append("file",I),ne(s)},u=g.useCallback(s=>{b===s?j():j(s)},[b]),G=g.useCallback(s=>{const A=s[0];w(A)},[]),R=()=>{w(null)},y=xe(),oe={headers:{"content-type":"multipart/form-data"}},{mutate:ne}=H({mutationFn:s=>N.post(q.files.upload,s,oe),onSuccess:async()=>{B.success("New Image Has Been Uploaded!")},onSettled:async()=>{await y.invalidateQueries({queryKey:["products-images"]}),w(null),o.onFalse()},onError:s=>{console.log(s)}}),{mutate:le}=H({mutationFn:s=>N.post(q.products.create,s),onSuccess:async()=>{B.success("New Product Has Been Created!"),h(),d.push($.dashboard.product.root)},onSettled:async()=>{await y.invalidateQueries({queryKey:["products"]}),o.onFalse()},onError:s=>{console.log(s)}}),{mutate:re}=H({mutationFn:({id:s,payload:A})=>N.patch(q.products.edit+s,A),onSuccess:async()=>{B.success("Product Has Been Modified!"),h(),d.push($.dashboard.product.root)},onSettled:async()=>{await y.invalidateQueries({queryKey:["products"]}),o.onFalse()},onError:s=>{console.log(s)}}),ce=s=>{if(r.some(k=>k===s)){const k=r.filter(de=>de!==s);m(k)}else{const k=[...r,s];m(k)}},{mutate:me}=H({mutationFn:s=>N.delete(q.files.deletes,s),onSuccess:async()=>{B.success(`${r.length} has been deleted!`),await y.invalidateQueries({queryKey:["products-images"]})},onSettled:()=>{l.onFalse()},onError:s=>{console.log(s)}});return e.jsxs(e.Fragment,{children:[e.jsx(he,{children:e.jsxs(_,{methods:U,onSubmit:T,children:[e.jsxs(X,{spacing:4,sx:{p:3},display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(2, 1fr)"},children:[e.jsxs(S,{columnGap:2,rowGap:3,display:"flex",flexDirection:"column",children:[e.jsx(E.Text,{fullWidth:!0,label:"Product Name",name:"name"}),e.jsx(E.Text,{fullWidth:!0,name:"description",label:"Description"}),e.jsx(E.Text,{fullWidth:!0,type:"number",label:"Product Price",name:"price"}),a&&e.jsx(E.Switch,{name:"isActive",label:"Is Active?"})]}),e.jsx(S,{children:e.jsx(S,{sx:{borderRadius:1,overflow:"hidden",border:s=>`solid 1px ${s.vars.palette.divider}`},children:e.jsxs(be,{defaultExpanded:a,expanded:n,onChange:()=>{i(!n)},children:[e.jsx(ye,{expandIcon:e.jsx(M,{icon:"eva:arrow-ios-downward-fill"}),children:e.jsxs(S,{sx:{display:"flex",alignItems:"center"},children:[!c&&e.jsx(K,{sx:{ml:1,mr:1},onClick:s=>s.stopPropagation(),onFocus:s=>s.stopPropagation(),control:e.jsx(F,{variant:"outlined",onClick:()=>{i(!0),o.onToggle()},startIcon:e.jsx(M,{icon:"eva:cloud-upload-fill"}),children:"Upload Image"})}),e.jsx(K,{sx:{ml:1,mr:1},onClick:s=>s.stopPropagation(),onFocus:s=>s.stopPropagation(),control:e.jsx(F,{variant:"outlined",color:"error",onClick:s=>{p(!0),i(!0),r.length>0&&l.onToggle()},startIcon:e.jsx(M,{icon:"solar:trash-bin-trash-bold"}),children:c?r.length>0?`Deletes ${r.length} Images`:"Select Image(s)":"Delete"})}),c&&e.jsx(K,{sx:{ml:1,mr:1},onClick:s=>s.stopPropagation(),onFocus:s=>s.stopPropagation(),control:e.jsx(F,{variant:"outlined",color:"warning",startIcon:e.jsx(M,{icon:"ooui:cancel"}),onClick:()=>{p(!1),m([])},children:"Cancel Deletion"})})]})}),e.jsx(L,{}),e.jsx(Ae,{children:e.jsx(S,{spacing:2,gap:3,display:"grid",gridTemplateColumns:{xs:"repeat(2, 1fr)",md:"repeat(6, 1fr)"},children:v.map(s=>e.jsx(je,{image:ue.site.serverFileHost+s.name,handleClick:u,handleDelete:ce,payload:s.name,selected:s.name===b,deletedAction:c,deletedImages:r}))})})]})})})]}),e.jsx(S,{spacing:4,sx:{p:3},display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center",children:e.jsxs(S,{display:"flex",gap:2,height:50,children:[e.jsx(W,{type:"submit",variant:"contained",children:"Save"}),e.jsx(F,{variant:"outlined",children:"Cancel"})]})})]})}),e.jsx(Ee,{open:o.value,onClose:o.onFalse,file:I,handleUpload:D,handleDrop:G,handleDelete:R}),e.jsx(fe,{open:l.value,onClose:l.onFalse,title:"Delete",content:`Are you sure want to delete ${r.length} Images?`,action:e.jsx(F,{variant:"contained",color:"error",onClick:()=>{me({data:{files:r}}),m([]),p(!1)},children:"Delete"})})]})}var te={exports:{}};(function(a,v){(function(d,l){a.exports=l()})(z,()=>{return d={705:o=>{o.exports=function(t,n){const i=[];return n.length===0?i.push({text:t,highlight:!1}):n[0][0]>0&&i.push({text:t.slice(0,n[0][0]),highlight:!1}),n.forEach((r,m)=>{const c=r[0],p=r[1];i.push({text:t.slice(c,p),highlight:!0}),m===n.length-1?p<t.length&&i.push({text:t.slice(p,t.length),highlight:!1}):p<n[m+1][0]&&i.push({text:t.slice(p,n[m+1][0]),highlight:!1})}),i}}},l={},function o(t){var n=l[t];if(n!==void 0)return n.exports;var i=l[t]={exports:{}};return d[t](i,i.exports,o),i.exports}(705);var d,l})})(te);var we=te.exports;const We=V(we);var ie={exports:{}};(function(a,v){(function(d,l){a.exports=l()})(z,()=>{return d={772:(o,t,n)=>{const i=n(826).remove,r=/[.*+?^${}()|[\]\\]/g,m=/[a-z0-9_]/i,c=/\s+/;o.exports=function(p,b,j){var I,w;w={insideWords:!1,findAllOccurrences:!1,requireMatchAll:!1},I=(I=j)||{},Object.keys(I).forEach(x=>{w[x]=!!I[x]}),j=w;const U=Array.from(p).map(x=>i(x));let h=U.join("");return(b=i(b)).trim().split(c).filter(x=>x.length>0).reduce((x,O)=>{const C=O.length,Q=!j.insideWords&&m.test(O[0])?"\\b":"",T=new RegExp(Q+O.replace(r,"\\$&"),"i");let D,u;if(D=T.exec(h),j.requireMatchAll&&D===null)return h="",[];for(;D;){u=D.index;const G=C-U.slice(u,u+C).join("").length,R=u-U.slice(0,u).join("").length,y=[u+R,u+C+R+G];if(y[0]!==y[1]&&x.push(y),h=h.slice(0,u)+new Array(C+1).join(" ")+h.slice(u+C),!j.findAllOccurrences)break;D=T.exec(h)}return x},[]).sort((x,O)=>x[0]-O[0])}},826:o=>{var t={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",Ấ:"A",Ắ:"A",Ẳ:"A",Ẵ:"A",Ặ:"A",Æ:"AE",Ầ:"A",Ằ:"A",Ȃ:"A",Ç:"C",Ḉ:"C",È:"E",É:"E",Ê:"E",Ë:"E",Ế:"E",Ḗ:"E",Ề:"E",Ḕ:"E",Ḝ:"E",Ȇ:"E",Ì:"I",Í:"I",Î:"I",Ï:"I",Ḯ:"I",Ȋ:"I",Ð:"D",Ñ:"N",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",Ố:"O",Ṍ:"O",Ṓ:"O",Ȏ:"O",Ù:"U",Ú:"U",Û:"U",Ü:"U",Ý:"Y",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",ấ:"a",ắ:"a",ẳ:"a",ẵ:"a",ặ:"a",æ:"ae",ầ:"a",ằ:"a",ȃ:"a",ç:"c",ḉ:"c",è:"e",é:"e",ê:"e",ë:"e",ế:"e",ḗ:"e",ề:"e",ḕ:"e",ḝ:"e",ȇ:"e",ì:"i",í:"i",î:"i",ï:"i",ḯ:"i",ȋ:"i",ð:"d",ñ:"n",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",ố:"o",ṍ:"o",ṓ:"o",ȏ:"o",ù:"u",ú:"u",û:"u",ü:"u",ý:"y",ÿ:"y",Ā:"A",ā:"a",Ă:"A",ă:"a",Ą:"A",ą:"a",Ć:"C",ć:"c",Ĉ:"C",ĉ:"c",Ċ:"C",ċ:"c",Č:"C",č:"c",C̆:"C",c̆:"c",Ď:"D",ď:"d",Đ:"D",đ:"d",Ē:"E",ē:"e",Ĕ:"E",ĕ:"e",Ė:"E",ė:"e",Ę:"E",ę:"e",Ě:"E",ě:"e",Ĝ:"G",Ǵ:"G",ĝ:"g",ǵ:"g",Ğ:"G",ğ:"g",Ġ:"G",ġ:"g",Ģ:"G",ģ:"g",Ĥ:"H",ĥ:"h",Ħ:"H",ħ:"h",Ḫ:"H",ḫ:"h",Ĩ:"I",ĩ:"i",Ī:"I",ī:"i",Ĭ:"I",ĭ:"i",Į:"I",į:"i",İ:"I",ı:"i",Ĳ:"IJ",ĳ:"ij",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",Ḱ:"K",ḱ:"k",K̆:"K",k̆:"k",Ĺ:"L",ĺ:"l",Ļ:"L",ļ:"l",Ľ:"L",ľ:"l",Ŀ:"L",ŀ:"l",Ł:"l",ł:"l",Ḿ:"M",ḿ:"m",M̆:"M",m̆:"m",Ń:"N",ń:"n",Ņ:"N",ņ:"n",Ň:"N",ň:"n",ŉ:"n",N̆:"N",n̆:"n",Ō:"O",ō:"o",Ŏ:"O",ŏ:"o",Ő:"O",ő:"o",Œ:"OE",œ:"oe",P̆:"P",p̆:"p",Ŕ:"R",ŕ:"r",Ŗ:"R",ŗ:"r",Ř:"R",ř:"r",R̆:"R",r̆:"r",Ȓ:"R",ȓ:"r",Ś:"S",ś:"s",Ŝ:"S",ŝ:"s",Ş:"S",Ș:"S",ș:"s",ş:"s",Š:"S",š:"s",Ţ:"T",ţ:"t",ț:"t",Ț:"T",Ť:"T",ť:"t",Ŧ:"T",ŧ:"t",T̆:"T",t̆:"t",Ũ:"U",ũ:"u",Ū:"U",ū:"u",Ŭ:"U",ŭ:"u",Ů:"U",ů:"u",Ű:"U",ű:"u",Ų:"U",ų:"u",Ȗ:"U",ȗ:"u",V̆:"V",v̆:"v",Ŵ:"W",ŵ:"w",Ẃ:"W",ẃ:"w",X̆:"X",x̆:"x",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Y̆:"Y",y̆:"y",Ź:"Z",ź:"z",Ż:"Z",ż:"z",Ž:"Z",ž:"z",ſ:"s",ƒ:"f",Ơ:"O",ơ:"o",Ư:"U",ư:"u",Ǎ:"A",ǎ:"a",Ǐ:"I",ǐ:"i",Ǒ:"O",ǒ:"o",Ǔ:"U",ǔ:"u",Ǖ:"U",ǖ:"u",Ǘ:"U",ǘ:"u",Ǚ:"U",ǚ:"u",Ǜ:"U",ǜ:"u",Ứ:"U",ứ:"u",Ṹ:"U",ṹ:"u",Ǻ:"A",ǻ:"a",Ǽ:"AE",ǽ:"ae",Ǿ:"O",ǿ:"o",Þ:"TH",þ:"th",Ṕ:"P",ṕ:"p",Ṥ:"S",ṥ:"s",X́:"X",x́:"x",Ѓ:"Г",ѓ:"г",Ќ:"К",ќ:"к",A̋:"A",a̋:"a",E̋:"E",e̋:"e",I̋:"I",i̋:"i",Ǹ:"N",ǹ:"n",Ồ:"O",ồ:"o",Ṑ:"O",ṑ:"o",Ừ:"U",ừ:"u",Ẁ:"W",ẁ:"w",Ỳ:"Y",ỳ:"y",Ȁ:"A",ȁ:"a",Ȅ:"E",ȅ:"e",Ȉ:"I",ȉ:"i",Ȍ:"O",ȍ:"o",Ȑ:"R",ȑ:"r",Ȕ:"U",ȕ:"u",B̌:"B",b̌:"b",Č̣:"C",č̣:"c",Ê̌:"E",ê̌:"e",F̌:"F",f̌:"f",Ǧ:"G",ǧ:"g",Ȟ:"H",ȟ:"h",J̌:"J",ǰ:"j",Ǩ:"K",ǩ:"k",M̌:"M",m̌:"m",P̌:"P",p̌:"p",Q̌:"Q",q̌:"q",Ř̩:"R",ř̩:"r",Ṧ:"S",ṧ:"s",V̌:"V",v̌:"v",W̌:"W",w̌:"w",X̌:"X",x̌:"x",Y̌:"Y",y̌:"y",A̧:"A",a̧:"a",B̧:"B",b̧:"b",Ḑ:"D",ḑ:"d",Ȩ:"E",ȩ:"e",Ɛ̧:"E",ɛ̧:"e",Ḩ:"H",ḩ:"h",I̧:"I",i̧:"i",Ɨ̧:"I",ɨ̧:"i",M̧:"M",m̧:"m",O̧:"O",o̧:"o",Q̧:"Q",q̧:"q",U̧:"U",u̧:"u",X̧:"X",x̧:"x",Z̧:"Z",z̧:"z"},n=Object.keys(t).join("|"),i=new RegExp(n,"g"),r=new RegExp(n,""),m=function(c){return c.replace(i,function(p){return t[p]})};o.exports=m,o.exports.has=function(c){return!!c.match(r)},o.exports.remove=m}},l={},function o(t){var n=l[t];if(n!==void 0)return n.exports;var i=l[t]={exports:{}};return d[t](i,i.exports,o),i.exports}(772);var d,l})})(ie);var Ce=ie.exports;const Qe=V(Ce),De=f.object({rating:f.number().min(1,"Rating must be greater than or equal to 1!"),name:f.string().min(1,{message:"Name is required!"}),review:f.string().min(1,{message:"Review is required!"}),email:f.string().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"})});function Ye({onClose:a,...v}){const d={rating:0,review:"",name:"",email:""},l=J({mode:"all",resolver:Z(De),defaultValues:d}),{reset:o,handleSubmit:t,formState:{isSubmitting:n}}=l,i=t(async m=>{try{await new Promise(c=>setTimeout(c,500)),o(),a(),console.info("DATA",m)}catch(c){console.error(c)}}),r=g.useCallback(()=>{a(),o()},[a,o]);return e.jsx(P,{onClose:a,...v,children:e.jsxs(_,{methods:l,onSubmit:i,children:[e.jsx(ae,{children:" Add Review "}),e.jsxs(ee,{children:[e.jsxs("div",{children:[e.jsx(ge,{variant:"body2",sx:{mb:1},children:"Your review about this product:"}),e.jsx(E.Rating,{name:"rating"})]}),e.jsx(E.Text,{name:"review",label:"Review *",multiline:!0,rows:3,sx:{mt:3}}),e.jsx(E.Text,{name:"name",label:"Name *",sx:{mt:3}}),e.jsx(E.Text,{name:"email",label:"Email *",sx:{mt:3}})]}),e.jsxs(se,{children:[e.jsx(F,{color:"inherit",variant:"outlined",onClick:r,children:"Cancel"}),e.jsx(W,{type:"submit",variant:"contained",loading:n,children:"Post"})]})]})})}export{Ye as P,Ke as a,Qe as m,We as p};
