import{r as x,i as H,aP as se,g as Z,p as f,j as e,S as v,A as X,C as D,B as C,bx as re,aO as ee,aJ as ae,l as N,I as p,dm as oe,au as ne,e as V,e2 as ie,aQ as le,aR as de,aS as B,e3 as I,aX as ce,ec as pe,dw as me,dP as ue,ay as L,R as he,aB as xe,aV as ge,ed as je,dx as q,b5 as $,dy as fe,dT as be,H as Pe}from"./index-DT04UR_O.js";import{u as w,E as Ce}from"./error-block-BoCOKljz.js";import"./product-review-new-form--1U0rsQw.js";import"./index-gsrIoA7B.js";import"./image-BC3--aR2.js";import"./color-preview-DM7wc96-.js";import{u as ye}from"./useMutation-BAtwb5WR.js";import{C as Te}from"./custom-breadcrumbs-DhAwakkx.js";import{P as A}from"./permission-access-controller-B9qE1dum.js";import{g as Re,r as ve,e as De}from"./utils-MBUcMVfY.js";import{u as Ie}from"./use-table-Dvx8L5Dy.js";import{T as Ae}from"./table-no-data-DSrhKKqU.js";import{T as Se}from"./table-empty-rows-CKpal-Jm.js";import{T as Y,a as ke,b as Ee,c as Oe}from"./table-head-custom-CK_1KHWF.js";import{T as Be}from"./table-selected-action-BJNUh_jK.js";import{T as Le}from"./table-pagination-custom-p7IM4Ndp.js";import{a as F}from"./format-number-Bl4e0oau.js";import{C as Fe}from"./confirm-dialog-DR5RBP9s.js";import{T as j}from"./TableCell-BXVtmUZi.js";import{A as He}from"./AvatarGroup-y4qQUbTM.js";import{T as Ne}from"./TextField-BjQsoMIa.js";import{I as Ve}from"./InputAdornment-Df-7KMx3.js";import{P as qe}from"./product-table-filters-result-AFAVuRFF.js";import"./form-provider-B7hZ-ssH.js";import"./editor-ovNaHRWQ.js";import"./incrementer-button-BVDnxrhf.js";import"./carousel-progress-bar-1Vbm0JX1.js";import"./html-to-markdown-_ruxhgr0.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./product-Item-button-BWk8Ktbg.js";import"./upload-avatar-DKfjcflR.js";import"./FormHelperText-DdVZ689Y.js";import"./formControlState-Dq1zat_P.js";import"./index-aTkpnRqN.js";import"./DialogContent-D3trKXnB.js";import"./DialogTitle-BfjGdi3E.js";import"./LoadingButton-CBaPP7po.js";import"./CircularProgress-DxjMVPSY.js";import"./AccordionSummary-BAUm99pg.js";import"./FormControlLabel-CvWNVptb.js";import"./empty-content-bso-Oats.js";import"./Checkbox-BU7EYPXc.js";import"./TablePagination-BV8aUVPa.js";import"./KeyboardArrowRight-DI6e2iIr.js";import"./LastPage-BaKUnPHk.js";import"./Select-C_-xEl5F.js";import"./Menu-BPDpcHu6.js";import"./utils-DoM3o7-Q.js";import"./InputBase-BM5GWnYp.js";import"./FormControl-CW9RfL9F.js";import"./InputLabel-Dlp26u7k.js";import"./FormLabel-D5kKRx-M.js";import"./filters-result-CIhkXI8P.js";import"./Chip-QNIqa7VZ.js";import"./Rating-yEv_VYnC.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-C2cpfGcN.js";import"./RadioGroup-DtRipWnf.js";import"./FormGroup-BSMNbJJJ.js";import"./utils-CuXi_5LX.js";import"./countries-DSLisFCy.js";import"./Autocomplete-Btx_vR5S.js";import"./country-select-DDYiN-2v.js";import"./DatePicker-B3mVQQbR.js";import"./ListItem-DytXkWka.js";import"./MobileDateTimePicker-BEdQjBBa.js";import"./Tabs-V8wu0P1d.js";import"./index-DFqQWiXf.js";const $e=({row:t,index:l,selected:s,onViewRow:b,onDeleteRow:m,onEditRow:u})=>{var y,T,o,g,R,U;const[P,i]=x.useState(((y=t==null?void 0:t.productToOrder)==null?void 0:y.length)>0),h=H(),r=H(),n=se(),d=Z(),S=x.useCallback(a=>{d.push(f.dashboard.order.details(a))},[d]),k=x.useCallback(a=>{d.push(f.dashboard.product.details(a))},[d]),E=e.jsxs(Y,{hover:!0,selected:s,children:[e.jsx(j,{children:l||(t==null?void 0:t.id)}),e.jsx(j,{children:e.jsxs(v,{spacing:2,direction:"row",alignItems:"center",children:[e.jsx(X,{alt:t==null?void 0:t.name,src:D.site.serverFileHost+((t==null?void 0:t.image)||D.site.defaultImgPlaceHolder)}),e.jsx(C,{component:"span",children:t==null?void 0:t.name})]})}),e.jsx(j,{children:e.jsx(He,{sx:{[`& .${re.avatar}`]:{width:24,height:24}},children:e.jsx(ee,{title:`${(T=t==null?void 0:t.category)==null?void 0:T.name}`,children:e.jsx(X,{alt:(o=t==null?void 0:t.category)==null?void 0:o.name,src:`${D.site.serverFileHost}${(g=t==null?void 0:t.category)==null?void 0:g.image}`})})})}),e.jsx(j,{children:F(t==null?void 0:t.price)}),e.jsxs(j,{align:"center",children:[" ",((R=t==null?void 0:t.stock)==null?void 0:R.quantity)||"0"," "]}),e.jsx(j,{children:e.jsx(ae,{variant:"soft",color:t.isActive===!0&&"success"||t.isActive===!1&&"error"||"default",children:t!=null&&t.isActive?"ACTIVE":"INACTIVE"})}),e.jsxs(j,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[P&&e.jsx(N,{color:r.value?"inherit":"default",onClick:r.onToggle,sx:{...r.value&&{bgcolor:"action.hover"}},children:e.jsx(p,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(N,{color:n.open?"inherit":"default",onClick:n.onOpen,children:e.jsx(p,{icon:"eva:more-vertical-fill"})})]})]}),O=e.jsx(Y,{children:e.jsx(j,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(oe,{in:r.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(ne,{sx:{m:1.5},children:(U=t==null?void 0:t.productToOrder)==null?void 0:U.map((a,te)=>{var _,G,M,Q,W,z,K,J;return te===5?e.jsx(v,{alignItems:"flex-end",sx:{p:c=>c.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:c=>`solid 2px ${c.vars.palette.background.neutral}`}},children:e.jsx(V,{variant:"contained",size:"small",endIcon:e.jsx(p,{icon:"heroicons-outline:external-link"}),onClick:()=>{k(t.id)},children:"See More"})},a.id):e.jsxs(v,{direction:"row",alignItems:"center",sx:{p:c=>c.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:c=>`solid 2px ${c.vars.palette.background.neutral}`}},children:[e.jsxs(C,{onClick:()=>{var c;return S((c=a==null?void 0:a.order)==null?void 0:c.id)},sx:{width:240,display:"flex",gap:1,alignItems:"center",cursor:"pointer",marginRight:5},children:[e.jsx(p,{icon:"heroicons-outline:external-link"}),e.jsx("span",{children:(_=a==null?void 0:a.order)==null?void 0:_.ref})]}),e.jsx(C,{sx:{width:"100%",display:"flex",gap:1,alignItems:"center"},children:e.jsx("span",{children:(M=(G=a.order)==null?void 0:G.customer)==null?void 0:M.name})}),e.jsxs(C,{sx:{width:240,color:"error.main",fontWeight:"bold"},children:["x",a.quantity," ",e.jsx("span",{style:{color:"#000",fontWeight:"400"},children:`(${F(a==null?void 0:a.snapshotProductPrice)})`})]}),e.jsx(C,{sx:{width:200,textAlign:"right"},children:(Q=a.order)==null?void 0:Q.status}),e.jsx(C,{sx:{width:300,textAlign:"right"},children:F(ie(((W=a.order)==null?void 0:W.totalOrderAmount)-((z=a.order)==null?void 0:z.totalOrderAmount)*(((K=a.order)==null?void 0:K.discount)/100),(J=a.order)==null?void 0:J.snapshotTaxPercentage))||"-"})]},a.id)})})})})});return e.jsxs(e.Fragment,{children:[E,O,e.jsx(le,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(de,{children:[e.jsxs(B,{onClick:()=>{b(),n.onClose()},children:[e.jsx(p,{icon:"solar:eye-bold"}),"View"]}),e.jsx(A,{permission:I.EDIT_PRODUCT,children:e.jsxs(B,{onClick:()=>{u(t.id),n.onClose()},children:[e.jsx(p,{icon:"solar:pen-bold"}),"Edit"]})}),e.jsx(A,{permission:I.DELETE_PRODUCT,children:e.jsxs(B,{onClick:()=>{h.onTrue(),n.onClose()},sx:{color:"error.main"},children:[e.jsx(p,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})})]})}),e.jsx(Fe,{open:h.value,onClose:h.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(V,{variant:"contained",color:"error",onClick:m,children:"Delete"})})]})};function Ue({filters:t,onResetPage:l,options:s}){const b=x.useCallback(m=>{l(),t.setState({name:m.target.value})},[t,l]);return e.jsx(v,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(Ne,{sx:{width:420},value:t.state.name,onChange:b,placeholder:"Search by Product Name or Ref",InputProps:{startAdornment:e.jsx(Ve,{position:"start",children:e.jsx(p,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}const _e=[{id:"productId",label:"No.",width:80},{id:"productName",label:"Name"},{id:"productPrice",label:"Category",width:200},{id:"productPrice",label:"Price",width:200},{id:"stock",label:"Stock",align:"center"},{id:"status",label:"Status",width:100},{id:"",width:88}];function Ge({products:t,taxPercentage:l}){const s=Ie({defaultOrderBy:"planId"}),b=H(),m=Z(),[u,P]=x.useState(t),i=ce({name:"",status:"all",startDate:null,endDate:null});x.useEffect(()=>{P(t)},[t]);const h=pe(i.state.startDate,i.state.endDate),r=Me({inputData:u,comparator:Re(s.order,s.orderBy),filters:i.state,dateError:h}),n=ve(r,s.page,s.rowsPerPage),d=!!i.state.name||i.state.status!=="all"||!!i.state.startDate&&!!i.state.endDate,S=!r.length&&d||!r.length,k=x.useCallback(o=>{T(o)},[n.length,s,u]),E=x.useCallback(o=>{m.push(f.dashboard.product.edit(o))},[m]),O=x.useCallback(o=>{m.push(f.dashboard.product.details(o))},[m]),y=me(),{mutate:T}=ye({mutationFn:o=>q.delete($.products.delete+o),onSuccess:async o=>{const g=u.filter(R=>R.id!==o);fe.success("Delete success!"),P(g),s.onUpdatePageDeleteRow(n.length)},onSettled:async()=>{await y.invalidateQueries({queryKey:["products"]})},onError:()=>{}});return e.jsx(ue,{maxWidth:"xl",children:e.jsxs(L,{container:!0,spacing:3,children:[e.jsx(L,{xs:12,md:12,children:e.jsx(Te,{links:[{name:"Dashboard",href:f.dashboard.root},{name:"Product",href:f.dashboard.plan.root},{name:"List"}],action:e.jsx(A,{permission:I.ADD_PRODUCT,children:e.jsx(V,{component:he,href:f.dashboard.product.new,variant:"contained",startIcon:e.jsx(p,{icon:"mingcute:add-line"}),children:"Add New Product"})})})}),e.jsx(A,{permission:I.LIST_PRODUCT,children:e.jsx(L,{xs:12,md:12,children:e.jsxs(xe,{children:[e.jsx(Ue,{filters:i,onResetPage:s.onResetPage,dateError:h}),d&&e.jsx(qe,{filters:i,totalResults:r.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(C,{sx:{position:"relative"},children:[e.jsx(Be,{dense:s.dense,numSelected:s.selected.length,rowCount:r.length,onSelectAllRows:o=>s.onSelectAllRows(o,r.map(g=>g.id)),action:e.jsx(ee,{title:"Delete",children:e.jsx(N,{color:"primary",onClick:b.onTrue,children:e.jsx(p,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(ge,{sx:{minHeight:444},children:e.jsxs(ke,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Ee,{order:s.order,orderBy:s.orderBy,headLabel:_e,rowCount:r.length,numSelected:s.selected.length,onSort:s.onSort}),e.jsxs(Oe,{children:[r.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map((o,g)=>e.jsx($e,{row:o,index:s.page*s.rowsPerPage+g+1,selected:s.selected.includes(o.id),onEditRow:()=>E(o.id),onViewRow:()=>O(o.id),onDeleteRow:()=>k(o.id),taxPercentage:l},o.id)),e.jsx(Se,{height:s.dense?56:76,emptyRows:De(s.page,s.rowsPerPage,r.length)}),e.jsx(Ae,{notFound:S})]})]})})]}),e.jsx(Le,{page:s.page,dense:s.dense,count:r.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})})})]})})}function Me({inputData:t,comparator:l,filters:s,dateError:b}){const{status:m,name:u,startDate:P,endDate:i}=s,h=t.map((r,n)=>[r,n]);return h.sort((r,n)=>{const d=l(r[0],n[0]);return d!==0?d:r[1]-n[1]}),t=h.map(r=>r[0]),u&&(t=t.filter(r=>r.id.toString().toLowerCase().indexOf(u.toLowerCase())!==-1||r.name.toLowerCase().indexOf(u.toLowerCase())!==-1)),b||P&&i&&(t=t.filter(r=>je(r.createdAt,P,i))),t}const Qe={title:`Product list | Dashboard - ${D.site.name}`};function ls(){const t=w({queryKey:["products"],queryFn:async()=>{const{data:s}=await q.get($.products.list);return s}}),l=w({queryKey:["account-application"],queryFn:async()=>{const{data:s}=await q.get($.auth.application);return s}});return l.isLoading||t.isLoading?e.jsx(be,{}):l.isError||t.isError?e.jsx(Ce,{route:f.dashboard.products.root}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{children:e.jsxs("title",{children:[" ",Qe.title]})}),e.jsx(Ge,{products:t.data,taxPercentage:l.data.taxPercentage})]})}export{ls as default};
