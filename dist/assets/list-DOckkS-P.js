import{r as m,j as t,w as B,bG as F,bL as A,y as N,I as g,dz as L,bI as w,bJ as y,e as T,S as v,o as q,dC as K,eq as H,dL as M,p as x,eb as O,R as Q,aF as z,B as $,dB as G,er as J,dM as C,dK as S,dN as P,ef as W,H as U,C as V}from"./index-lMp9zap6.js";import{u as _,E as X}from"./error-block-DXWblvjp.js";import{u as R}from"./useMutation-B2tKEkiI.js";import{C as Y}from"./custom-breadcrumbs-CnRCretL.js";import{u as Z,g as ee,r as te,T as se,a as ae,e as ne}from"./table-selected-action-Cgn9qQis.js";import{T as oe}from"./table-no-data-D5fgAy-Q.js";import{T as re,a as ie,b as le,c as de}from"./table-head-custom-BwAPFtwe.js";import{T as ce}from"./table-pagination-custom-sK7wTfre.js";import{F as me,a as he,c as ue}from"./filters-result-BnQFy5UF.js";import{C as fe}from"./Chip-lc0vODcu.js";import{C as pe}from"./confirm-dialog-CfE53hWp.js";import{T as p}from"./TableCell-ljoaX5oi.js";import{T as xe}from"./TextField-BEm0Gfgz.js";import{I as ge}from"./InputAdornment-CznJJWQj.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./Checkbox-BfbryewD.js";import"./empty-content-v04S0NJf.js";import"./TablePagination-Dir7BHGy.js";import"./LastPage-B3GbPSnl.js";import"./Select-DE7_tqxX.js";import"./Menu-Di83eYAm.js";import"./utils-DoM3o7-Q.js";import"./formControlState-Dq1zat_P.js";import"./InputBase-D6UR9yYG.js";import"./FormControlLabel-CSqTNcaw.js";import"./DialogContent-B0tqVN_s.js";import"./DialogTitle-BCkrw5VA.js";import"./FormControl-BFlCQpvi.js";import"./InputLabel-D2FT-Pcv.js";import"./FormLabel-CKyhTT_V.js";import"./FormHelperText-CiWaMPMf.js";function be({filters:e,totalResults:s,onResetPage:i,sx:d}){const c=m.useCallback(()=>{i(),e.setState({name:""})},[e,i]),n=m.useCallback(()=>{i(),e.onResetState()},[e,i]);return t.jsx(me,{totalResults:s,onReset:n,sx:d,children:t.jsx(he,{label:"Keyword:",isShow:!!e.state.name,children:t.jsx(fe,{...ue,label:e.state.name,onDelete:c})})})}const je=({row:e,selected:s,onEditRow:i,onDeleteRow:d,handler:c})=>{const n=B(),l=F(),[r,h]=m.useState(e==null?void 0:e.isActive);m.useEffect(()=>{h(e==null?void 0:e.isActive)},[e]);const o=f=>()=>{h(!r),c({id:f,payload:{isActive:!r}})},u=t.jsxs(re,{hover:!0,selected:s,children:[t.jsx(p,{children:e==null?void 0:e.id}),t.jsx(p,{children:`${e==null?void 0:e.firstName} ${e==null?void 0:e.lastName}`}),t.jsx(p,{children:e==null?void 0:e.phoneNumber}),t.jsx(p,{children:e==null?void 0:e.email}),t.jsx(p,{children:t.jsx(A,{checked:r,onChange:o(e.id),color:"primary"})}),t.jsx(p,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:t.jsx(N,{color:l.open?"inherit":"default",onClick:l.onOpen,children:t.jsx(g,{icon:"eva:more-vertical-fill"})})})]});return t.jsxs(t.Fragment,{children:[u,t.jsx(L,{open:l.open,anchorEl:l.anchorEl,onClose:l.onClose,slotProps:{arrow:{placement:"right-top"}},children:t.jsxs(w,{children:[t.jsxs(y,{onClick:()=>{i()},children:[t.jsx(g,{icon:"solar:pen-bold"}),"Edit"]}),t.jsxs(y,{onClick:()=>{n.onTrue(),l.onClose()},sx:{color:"error.main"},children:[t.jsx(g,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),t.jsx(pe,{open:n.value,onClose:n.onFalse,title:"Delete",content:"Are you sure want to delete?",action:t.jsx(T,{variant:"contained",color:"error",onClick:d,children:"Delete"})})]})};function Ce({filters:e,onResetPage:s,options:i}){const d=m.useCallback(c=>{s(),e.setState({name:c.target.value})},[e,s]);return t.jsx(v,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:t.jsx(xe,{sx:{width:420},value:e.state.name,onChange:d,placeholder:"Search staff or email...",InputProps:{startAdornment:t.jsx(ge,{position:"start",children:t.jsx(g,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}const Se=[{id:"reminderId",label:"#",width:140},{id:"staffName",label:"Staff Name",width:280},{id:"phoneNumber",label:"Phone Number"},{id:"emailAddress",label:"Email Address"},{id:"status",label:"Status"},{id:"",width:88}],ye=({staffs:e})=>{const s=Z({defaultOrderBy:"orderNumber"}),i=q(),[d,c]=m.useState(e),n=K({name:"",status:"all",startDate:null,endDate:null});m.useEffect(()=>{c(e)},[e]);const l=H(n.state.startDate,n.state.endDate),r=Pe({inputData:d,comparator:ee(s.order,s.orderBy),filters:n.state,dateError:l}),h=te(r,s.page,s.rowsPerPage),o=!!n.state.name||n.state.status!=="all"||!!n.state.startDate&&!!n.state.endDate,u=!r.length&&o||!r.length,f=m.useCallback(a=>{E(a)},[h.length,s,d]),b=M(),{mutate:D}=R({mutationFn:async({id:a,payload:j})=>(await C.patch(S.staff.edit+a,j),a),onSuccess:async a=>{P.success("Staff Has Been Modified!"),await b.invalidateQueries({queryKey:["staff",a]})},onSettled:async()=>{await b.invalidateQueries({queryKey:["staffs"]})},onError:a=>{console.log(a)}}),{mutate:E}=R({mutationFn:a=>C.delete(S.staff.delete+a),onSuccess:async a=>{const j=d.filter(k=>k.id!==a);P.success("Delete success!"),c(j),s.onUpdatePageDeleteRow(h.length)},onSettled:async()=>{await b.invalidateQueries({queryKey:["staffs"]})},onError:()=>{}}),I=m.useCallback(a=>{i.push(x.dashboard.staff.edit(a))},[i]);return t.jsx(O,{maxWidth:"xl",children:t.jsxs(v,{spacing:3,children:[t.jsx(Y,{links:[{name:"Dashboard",href:x.dashboard.root},{name:"Staff",href:x.dashboard.staff.root}],action:t.jsx(T,{component:Q,href:x.dashboard.staff.new,variant:"contained",startIcon:t.jsx(g,{icon:"mingcute:add-line"}),children:"Add New Staff"})}),t.jsxs(z,{children:[t.jsx(Ce,{filters:n,onResetPage:s.onResetPage,dateError:l}),o&&t.jsx(be,{filters:n,totalResults:r.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),t.jsxs($,{sx:{position:"relative"},children:[t.jsx(se,{dense:s.dense,numSelected:s.selected.length,rowCount:r.length}),t.jsx(G,{sx:{minHeight:444},children:t.jsxs(ie,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[t.jsx(le,{order:s.order,orderBy:s.orderBy,headLabel:Se,rowCount:r.length}),t.jsxs(de,{children:[r.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(a=>t.jsx(je,{row:a,selected:s.selected.includes(a.id),onSelectRow:()=>s.onSelectRow(a.id),onDeleteRow:()=>f(a.id),onEditRow:()=>I(a.id),handler:D},a.id)),t.jsx(ae,{height:s.dense?56:76,emptyRows:ne(s.page,s.rowsPerPage,r.length)}),t.jsx(oe,{notFound:u})]})]})})]}),t.jsx(ce,{page:s.page,dense:s.dense,count:r.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})]})})};function Pe({inputData:e,comparator:s,filters:i,dateError:d}){const{status:c,name:n,startDate:l,endDate:r}=i,h=e.map((o,u)=>[o,u]);return h.sort((o,u)=>{const f=s(o[0],u[0]);return f!==0?f:o[1]-u[1]}),e=h.map(o=>o[0]),n&&(e=e.filter(o=>o.id.toString().toLowerCase().indexOf(n.toLowerCase())!==-1||o.staffName.toLowerCase().indexOf(n.toLowerCase())!==-1)),c!=="all"&&(e=e.filter(o=>o.status===c)),d||l&&r&&(e=e.filter(o=>J(o.createdAt,l,r))),e}const Re={title:`Staff list | Dashboard - ${V.site.name}`};function nt(){const e=_({queryKey:["staffs"],queryFn:async()=>{const{data:s}=await C.get(S.staff.list);return s}});return e.isPending||e.isLoading?t.jsx(W,{}):e.isError?t.jsx(X,{route:x.dashboard.staff.root}):t.jsxs(t.Fragment,{children:[t.jsx(U,{children:t.jsxs("title",{children:[" ",Re.title]})}),t.jsx(ye,{staffs:e.data})]})}export{nt as default};
