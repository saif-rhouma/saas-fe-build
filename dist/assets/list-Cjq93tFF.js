import{r as g,Y as L,a3 as ae,W as ee,br as te,p as b,j as e,S as O,A as Y,C as A,B as C,Q as oe,bq as se,$ as F,I as h,cR as ne,b6 as ie,e as q,e8 as le,dc as de,a6 as ce,a7 as $,e4 as I,df as pe,e3 as me,dp as ue,dQ as he,cW as B,R as xe,cZ as ge,de as be,ed as je,dq as U,dn as W,dr as fe,dU as Pe,H as Ce}from"./index-3kUlxXkm.js";import{u as Z,E as ye}from"./error-block-BTCpMwIj.js";import"./product-review-new-form-LuEc95p3.js";import"./index-DSTdp374.js";import"./image-BEDFCDEn.js";import"./color-preview-BUFv9sdW.js";import{u as Te}from"./useMutation-DWyFExRk.js";import{C as Re}from"./custom-breadcrumbs-CQM3hT8w.js";import{P as S}from"./permission-access-controller-6Z2YefAG.js";import{g as De,r as ke,e as ve}from"./utils-MBUcMVfY.js";import{u as Ae}from"./use-table-9MzCtmNE.js";import{T as Ie}from"./table-no-data-DRMtffow.js";import{T as Se}from"./table-empty-rows-R6XLgnwX.js";import{T as X,a as Ee,b as Ve,c as we}from"./table-head-custom-Bzh_BuNQ.js";import{T as Oe}from"./table-selected-action-77MIBAPT.js";import{T as $e}from"./table-pagination-custom-HAHTP3sF.js";import{b as H}from"./format-number-CFuBAOSh.js";import{C as Be}from"./confirm-dialog-DcDyWDMb.js";import{T as P}from"./TableCell-YgDy_fKI.js";import{A as He}from"./AvatarGroup-DZ0cD606.js";import{P as Le}from"./product-table-toolbar-BoILEkhM.js";import{P as Fe}from"./product-table-filters-result-E-AuBH2b.js";import"./form-provider-Ddj1YnLe.js";import"./editor-BMX_0Xq6.js";import"./incrementer-button-DlaR23JU.js";import"./carousel-progress-bar-BxxcJu9e.js";import"./html-to-markdown-C3jyF8fE.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./product-Item-button-aUsvkzkp.js";import"./upload-avatar-BbAzKhJK.js";import"./FormHelperText-47ensrNn.js";import"./formControlState-Dq1zat_P.js";import"./index-BySBJlbP.js";import"./DialogContent-BZuUPSmG.js";import"./DialogTitle-DD3683-9.js";import"./LoadingButton-BtwwM36s.js";import"./CircularProgress-CZhO4lMk.js";import"./AccordionSummary-CGy62VTu.js";import"./FormControlLabel-DWtRb9VA.js";import"./empty-content-DygIpP7Y.js";import"./Checkbox-BPHZ30Zu.js";import"./TablePagination-CVcJMlXd.js";import"./KeyboardArrowRight-o7aJmcRm.js";import"./LastPage-FHI8cfYQ.js";import"./Select-DOB8r047.js";import"./Menu-CsXXwNKW.js";import"./utils-DoM3o7-Q.js";import"./InputBase-Df4WeLlJ.js";import"./TextField-Ff9PgcBD.js";import"./FormControl-BaWzc8Dl.js";import"./InputLabel-Df2ESQnA.js";import"./FormLabel-CX5M124t.js";import"./InputAdornment-Ug97Thua.js";import"./filters-result-CHuN9x5s.js";import"./Chip-yUQfyewU.js";import"./Rating-BWS0RvVN.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-Dlywp6Zb.js";import"./RadioGroup-D6FwwOLi.js";import"./FormGroup-DHewWmvb.js";import"./utils-NIylK1Um.js";import"./countries-DSLisFCy.js";import"./Autocomplete-CuAKdGKX.js";import"./country-select-i0JEsBFQ.js";import"./DatePicker-vbOob6Xb.js";import"./ListItem-CBu29PKK.js";import"./MobileDateTimePicker-DlpjHwQr.js";import"./Tabs-Cs2uCeCP.js";import"./index-nrKetuMS.js";const qe=({row:t,index:p,selected:s,onViewRow:l,onDeleteRow:y,onEditRow:j})=>{var R,D,k,o,x,v;const[m,f]=g.useState(((R=t==null?void 0:t.productToOrder)==null?void 0:R.length)>0),u=L(),r=L(),i=ae(),n=ee(),{t:d}=te("products"),T=g.useCallback(a=>{n.push(b.dashboard.order.details(a))},[n]),E=g.useCallback(a=>{n.push(b.dashboard.product.details(a))},[n]),V=e.jsxs(X,{hover:!0,selected:s,children:[e.jsx(P,{children:p||(t==null?void 0:t.id)}),e.jsx(P,{children:e.jsxs(O,{spacing:2,direction:"row",alignItems:"center",children:[e.jsx(Y,{alt:t==null?void 0:t.name,src:A.site.serverFileHost+((t==null?void 0:t.image)||A.site.defaultImgPlaceHolder)}),e.jsx(C,{component:"span",children:t==null?void 0:t.name})]})}),e.jsx(P,{children:e.jsx(He,{sx:{[`& .${oe.avatar}`]:{width:24,height:24}},children:e.jsx(se,{title:`${(D=t==null?void 0:t.category)==null?void 0:D.name}`,children:e.jsx(Y,{alt:(k=t==null?void 0:t.category)==null?void 0:k.name,src:`${A.site.serverFileHost}${(o=t==null?void 0:t.category)==null?void 0:o.image}`})})})}),e.jsx(P,{children:H(t==null?void 0:t.price)}),e.jsxs(P,{align:"center",children:[" ",((x=t==null?void 0:t.stock)==null?void 0:x.quantity)||"0"," "]}),e.jsxs(P,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[m&&e.jsx(F,{color:r.value?"inherit":"default",onClick:r.onToggle,sx:{...r.value&&{bgcolor:"action.hover"}},children:e.jsx(h,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(F,{color:i.open?"inherit":"default",onClick:i.onOpen,children:e.jsx(h,{icon:"eva:more-vertical-fill"})})]})]}),w=e.jsx(X,{children:e.jsx(P,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(ne,{in:r.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(ie,{sx:{m:1.5},children:(v=t==null?void 0:t.productToOrder)==null?void 0:v.map((a,re)=>{var Q,_,G,M,N,z,K,J;return re===5?e.jsx(O,{alignItems:"flex-end",sx:{p:c=>c.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:c=>`solid 2px ${c.vars.palette.background.neutral}`}},children:e.jsx(q,{variant:"contained",size:"small",endIcon:e.jsx(h,{icon:"heroicons-outline:external-link"}),onClick:()=>{E(t.id)},children:d("listView.table.tableActions.seeMore")})},a.id):e.jsxs(O,{direction:"row",alignItems:"center",sx:{p:c=>c.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:c=>`solid 2px ${c.vars.palette.background.neutral}`}},children:[e.jsxs(C,{onClick:()=>{var c;return T((c=a==null?void 0:a.order)==null?void 0:c.id)},sx:{width:240,display:"flex",gap:1,alignItems:"center",cursor:"pointer",marginRight:5},children:[e.jsx(h,{icon:"heroicons-outline:external-link"}),e.jsx("span",{children:(Q=a==null?void 0:a.order)==null?void 0:Q.ref})]}),e.jsx(C,{sx:{width:"100%",display:"flex",gap:1,alignItems:"center"},children:e.jsx("span",{children:(G=(_=a.order)==null?void 0:_.customer)==null?void 0:G.name})}),e.jsxs(C,{sx:{width:240,color:"error.main",fontWeight:"bold"},children:[a.quantity," ",e.jsx("span",{style:{color:"#000",fontWeight:"400"},children:` (${H(a==null?void 0:a.snapshotProductPrice)})`})]}),e.jsx(C,{sx:{width:200,textAlign:"right"},children:(M=a.order)==null?void 0:M.status}),e.jsx(C,{sx:{width:300,textAlign:"right"},children:H(le(((N=a.order)==null?void 0:N.totalOrderAmount)-((z=a.order)==null?void 0:z.totalOrderAmount)*(((K=a.order)==null?void 0:K.discount)/100),(J=a.order)==null?void 0:J.snapshotTaxPercentage))||"-"})]},a.id)})})})})});return e.jsxs(e.Fragment,{children:[V,w,e.jsx(de,{open:i.open,anchorEl:i.anchorEl,onClose:i.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(ce,{children:[e.jsxs($,{onClick:()=>{l(),i.onClose()},children:[e.jsx(h,{icon:"solar:eye-bold"}),d("listView.table.tableActions.view")]}),e.jsx(S,{permission:I.EDIT_PRODUCT,children:e.jsxs($,{onClick:()=>{j(t.id),i.onClose()},children:[e.jsx(h,{icon:"solar:pen-bold"}),d("listView.table.tableActions.edit")]})}),e.jsx(S,{permission:I.DELETE_PRODUCT,children:e.jsxs($,{onClick:()=>{u.onTrue(),i.onClose()},sx:{color:"error.main"},children:[e.jsx(h,{icon:"solar:trash-bin-trash-bold"}),d("listView.table.tableActions.delete")]})})]})}),e.jsx(Be,{open:u.value,onClose:u.onFalse,title:d("listView.messages.dialogDelete.title"),content:d("listView.messages.dialogDelete.text"),action:e.jsx(q,{variant:"contained",color:"error",onClick:y,children:d("listView.table.tableActions.delete")})})]})};function Ue({products:t,taxPercentage:p}){const s=Ae({defaultOrderBy:"planId"}),{t:l}=te("products"),y=[{id:"productId",label:`${l("listView.table.tableHeader.no")}`,width:80},{id:"productName",label:`${l("listView.table.tableHeader.name")}`},{id:"productCategory",label:`${l("listView.table.tableHeader.category")}`,width:200},{id:"productPrice",label:`${l("listView.table.tableHeader.price")}`,width:200},{id:"stock",label:`${l("listView.table.tableHeader.stock")}`,align:"center"},{id:"",width:88}],j=L(),m=ee(),[f,u]=g.useState(t),r=pe({name:"",status:"all",startDate:null,endDate:null});g.useEffect(()=>{u(t)},[t]);const i=me(r.state.startDate,r.state.endDate),n=We({inputData:f,comparator:De(s.order,s.orderBy),filters:r.state,dateError:i}),d=ke(n,s.page,s.rowsPerPage),T=!!r.state.name||r.state.status!=="all"||!!r.state.startDate&&!!r.state.endDate,E=!n.length&&T||!n.length,V=g.useCallback(o=>{k(o)},[d.length,s,f]),w=g.useCallback(o=>{m.push(b.dashboard.product.edit(o))},[m]),R=g.useCallback(o=>{m.push(b.dashboard.product.details(o))},[m]),D=ue(),{mutate:k}=Te({mutationFn:o=>U.delete(W.products.delete+o),onSuccess:async o=>{const x=f.filter(v=>v.id!==o);fe.success("Delete success!"),u(x),s.onUpdatePageDeleteRow(d.length)},onSettled:async()=>{await D.invalidateQueries({queryKey:["products"]})},onError:()=>{}});return e.jsx(he,{maxWidth:"xl",children:e.jsxs(B,{container:!0,spacing:3,children:[e.jsx(B,{xs:12,md:12,children:e.jsx(Re,{links:[{name:`${l("listView.breadCrumbsPageRootTitle")}`,href:b.dashboard.root},{name:`${l("listView.breadCrumbsParentPageTitle")}`,href:b.dashboard.product.root},{name:`${l("listView.breadCrumbsPageTitle")}`}],action:e.jsx(S,{permission:I.ADD_PRODUCT,children:e.jsx(q,{component:xe,href:b.dashboard.product.new,variant:"contained",startIcon:e.jsx(h,{icon:"mingcute:add-line"}),children:l("listView.addNewProduct")})})})}),e.jsx(S,{permission:I.LIST_PRODUCT,children:e.jsx(B,{xs:12,md:12,children:e.jsxs(ge,{children:[e.jsx(Le,{filters:r,onResetPage:s.onResetPage,dateError:i}),T&&e.jsx(Fe,{filters:r,totalResults:n.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(C,{sx:{position:"relative"},children:[e.jsx(Oe,{dense:s.dense,numSelected:s.selected.length,rowCount:n.length,onSelectAllRows:o=>s.onSelectAllRows(o,n.map(x=>x.id)),action:e.jsx(se,{title:"Delete",children:e.jsx(F,{color:"primary",onClick:j.onTrue,children:e.jsx(h,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(be,{sx:{minHeight:444},children:e.jsxs(Ee,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Ve,{order:s.order,orderBy:s.orderBy,headLabel:y,rowCount:n.length,numSelected:s.selected.length,onSort:s.onSort}),e.jsxs(we,{children:[n.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map((o,x)=>e.jsx(qe,{row:o,index:s.page*s.rowsPerPage+x+1,selected:s.selected.includes(o.id),onEditRow:()=>w(o.id),onViewRow:()=>R(o.id),onDeleteRow:()=>V(o.id),taxPercentage:p},o.id)),e.jsx(Se,{height:s.dense?56:76,emptyRows:ve(s.page,s.rowsPerPage,n.length)}),e.jsx(Ie,{notFound:E})]})]})})]}),e.jsx($e,{page:s.page,dense:s.dense,count:n.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})})})]})})}function We({inputData:t,comparator:p,filters:s,dateError:l}){const{status:y,name:j,startDate:m,endDate:f}=s,u=t.map((r,i)=>[r,i]);return u.sort((r,i)=>{const n=p(r[0],i[0]);return n!==0?n:r[1]-i[1]}),t=u.map(r=>r[0]),j&&(t=t.filter(r=>r.id.toString().toLowerCase().indexOf(j.toLowerCase())!==-1||r.name.toLowerCase().indexOf(j.toLowerCase())!==-1)),l||m&&f&&(t=t.filter(r=>je(r.createdAt,m,f))),t}const Qe={title:`Product list | Dashboard - ${A.site.name}`};function is(){const t=Z({queryKey:["products"],queryFn:async()=>{const{data:s}=await U.get(W.products.list);return s}}),p=Z({queryKey:["account-application"],queryFn:async()=>{const{data:s}=await U.get(W.auth.application);return s}});return p.isLoading||t.isLoading?e.jsx(Pe,{}):p.isError||t.isError?e.jsx(ye,{route:b.dashboard.products.root}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{children:e.jsxs("title",{children:[" ",Qe.title]})}),e.jsx(Ue,{products:t.data,taxPercentage:p.data.taxPercentage})]})}export{is as default};
