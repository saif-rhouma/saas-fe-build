import{o as x,bO as S,j as e,w as B,I as u,dw as F,bQ as k,bR as j,e as b,r as m,S as f,dz as G,eo as L,l as N,p,dI as A,e8 as H,R as O,G as q,aD as Q,B as z,dy as K,dJ as P,dH as C,dK as M,ec as J,H as U,C as V}from"./index-qTpQGZSM.js";import{u as W,E as _}from"./error-block-LdKLJmXG.js";import{u as $}from"./useMutation-DwwxkYn0.js";import{C as X}from"./custom-breadcrumbs-BGUga5Db.js";import{g as Y,r as Z,T as ee,e as se}from"./table-empty-rows-BjNRKAw-.js";import{u as te}from"./use-table-BsmW9kBY.js";import{T as oe}from"./table-no-data-CfTNoIH2.js";import{T as re,a as ae,b as ne,c as ie}from"./table-head-custom-C1TpOHrp.js";import{T as le}from"./table-selected-action-Bi30jodZ.js";import{T as de}from"./table-pagination-custom-CT6oTmvL.js";import{C as ce}from"./confirm-dialog-Bm3fCjvw.js";import{T as h}from"./TableCell-C7feBr2O.js";import{T as me}from"./TextField-DlbgkIdM.js";import{I as pe}from"./InputAdornment-AOuf2E7W.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./empty-content-DkGXVbKZ.js";import"./Checkbox-BIMD_Kz2.js";import"./TablePagination-C-6SVL6T.js";import"./KeyboardArrowRight-BXMkEFXs.js";import"./LastPage-Bn5LqkbT.js";import"./Select-CPhaOcE2.js";import"./Menu-rdkUPF4f.js";import"./utils-DoM3o7-Q.js";import"./formControlState-Dq1zat_P.js";import"./InputBase-iWMV7tHw.js";import"./FormControlLabel-CpHiSJVr.js";import"./DialogContent-BiWMH9ix.js";import"./DialogTitle-D7golWjh.js";import"./FormControl-BpZ03tA-.js";import"./InputLabel-DcOK32WR.js";import"./FormLabel-DnNlyvb5.js";import"./FormHelperText-B0yAPKEP.js";const ue=({row:t,selected:s,onDeleteRow:d,onEditRow:n})=>{var r,c;const i=x(),o=S(),l=e.jsxs(re,{hover:!0,selected:s,children:[e.jsx(h,{children:t==null?void 0:t.name}),e.jsx(h,{children:((r=t==null?void 0:t.permissions)==null?void 0:r.length)||0}),e.jsx(h,{children:((c=t==null?void 0:t.staffs)==null?void 0:c.length)||0}),e.jsx(h,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:e.jsx(B,{color:o.open?"inherit":"default",onClick:o.onOpen,children:e.jsx(u,{icon:"eva:more-vertical-fill"})})})]});return e.jsxs(e.Fragment,{children:[l,e.jsx(F,{open:o.open,anchorEl:o.anchorEl,onClose:o.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(k,{children:[e.jsxs(j,{onClick:()=>{n(),o.onClose()},children:[e.jsx(u,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(j,{onClick:()=>{i.onTrue(),o.onClose()},sx:{color:"error.main"},children:[e.jsx(u,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(ce,{open:i.value,onClose:i.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(b,{variant:"contained",color:"error",onClick:d,children:"Delete"})})]})};function he({filters:t,onResetPage:s}){const d=m.useCallback(n=>{s(),t.setState({name:n.target.value})},[t,s]);return e.jsx(f,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(me,{sx:{width:420},value:t.state.name,onChange:d,placeholder:"Search Here...",InputProps:{startAdornment:e.jsx(pe,{position:"start",children:e.jsx(u,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}const xe=[{id:"year",label:"Name"},{id:"startDate",label:"Permissions Number",width:240},{id:"endDate",label:"Users Number",width:240},{id:"",width:88}];function ge({permissionsGroups:t}){const s=te({defaultOrderBy:"orderNumber"});x(),x();const d=x(),[n,i]=m.useState(t),o=G({name:""}),l=L(o.state.startDate,o.state.endDate);m.useEffect(()=>{i(t)},[t]);const r=je({inputData:n,comparator:Y(s.order,s.orderBy),filters:o.state}),c=Z(r,s.page,s.rowsPerPage),y=!!o.state.name||o.state.status!=="all"||!!o.state.startDate&&!!o.state.endDate,T=!r.length&&y||!r.length,w=m.useCallback(a=>{E(a)},[c.length,s,n]),g=N(),D=m.useCallback(a=>{g.push(p.dashboard.tools.editPermissions(a))},[g]),R=A(),{mutate:E}=$({mutationFn:a=>P.delete(C.permissionsGroup.delete+a),onSuccess:async a=>{const I=n.filter(v=>v.id!==a);M.success("Delete success!"),i(I),s.onUpdatePageDeleteRow(c.length),await R.invalidateQueries({queryKey:["permissions-groups"]})},onSettled:async()=>{d.onFalse()},onError:()=>{}});return e.jsx(H,{children:e.jsxs(f,{spacing:3,children:[e.jsx(X,{links:[{name:"Dashboard",href:p.dashboard.root},{name:"Tools",href:p.dashboard.tools.root},{name:"Permissions Groups"}],sx:{mb:{xs:3,md:5}},action:e.jsx(b,{component:O,href:p.dashboard.tools.newPermissions,variant:"contained",startIcon:e.jsx(u,{icon:"mingcute:add-line"}),children:"New Permissions Group"})}),e.jsx(q,{xs:12,md:12,children:e.jsxs(Q,{children:[e.jsx(he,{filters:o,onResetPage:s.onResetPage,dateError:l}),e.jsxs(z,{sx:{position:"relative"},children:[e.jsx(le,{dense:s.dense,numSelected:s.selected.length,rowCount:r.length}),e.jsx(K,{sx:{minHeight:444},children:e.jsxs(ae,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(ne,{order:s.order,orderBy:s.orderBy,headLabel:xe,rowCount:r.length}),e.jsxs(ie,{children:[r.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(a=>e.jsx(ue,{row:a,selected:s.selected.includes(a.id),onEditRow:()=>D(a.id),onDeleteRow:()=>w(a.id)},a.id)),e.jsx(ee,{height:s.dense?56:76,emptyRows:se(s.page,s.rowsPerPage,r.length)}),e.jsx(oe,{notFound:T})]})]})})]}),e.jsx(de,{page:s.page,dense:s.dense,count:r.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})})]})})}function je({inputData:t,comparator:s,filters:d}){const{name:n}=d,i=t.map((o,l)=>[o,l]);return i.sort((o,l)=>{const r=s(o[0],l[0]);return r!==0?r:o[1]-l[1]}),t=i.map(o=>o[0]),n&&(t=t.filter(o=>o.year.toLowerCase().indexOf(n.toLowerCase())!==-1)),t}const be={title:`Tools | Dashboard - ${V.site.name}`};function Ze(){const t=W({queryKey:["permissions-groups"],queryFn:async()=>{const{data:s}=await P.get(C.permissionsGroup.list);return s}});return t.isLoading?e.jsx(J,{}):t.isError?e.jsx(_,{route:p.dashboard.tools.root}):e.jsxs(e.Fragment,{children:[e.jsx(U,{children:e.jsxs("title",{children:[" ",be.title]})}),e.jsx(ge,{permissionsGroups:t.data})]})}export{Ze as default};
