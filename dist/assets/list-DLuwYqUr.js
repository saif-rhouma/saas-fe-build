import{r as x,o as H,bO as se,l as Z,p as f,j as e,S as v,A as J,C as D,B as C,bm as re,cM as ee,ds as oe,w as N,I as p,dh as ae,az as ne,e as q,ew as ie,dw as le,bQ as de,bR as B,em as I,dz as ce,eo as pe,dI as me,e8 as ue,G as L,R as he,aD as xe,dy as ge,ep as je,dJ as V,dH as $,dK as fe,ec as be,H as Pe}from"./index-D-ZKGqTU.js";import{u as X,E as Ce}from"./error-block-CQIWskvv.js";import"./product-review-new-form-lla7YJ7a.js";import"./index-CksGXw08.js";import"./image-CX1CYgjP.js";import"./color-preview-Dxv-mvrO.js";import{u as ye}from"./useMutation-DZH4G1UV.js";import{C as Te}from"./custom-breadcrumbs-Ce0SsF19.js";import{P as A}from"./permission-access-controller-CFkXurO4.js";import{g as Re,r as ve,e as De}from"./utils-MBUcMVfY.js";import{u as Ie}from"./use-table-DeqmuJBx.js";import{T as Ae}from"./table-no-data-bi3FLgGi.js";import{T as ke}from"./table-empty-rows-ZG1hn5NQ.js";import{T as Y,a as Se,b as Ee,c as Oe}from"./table-head-custom-COak4_H-.js";import{T as Be}from"./table-selected-action-eNFtkPSf.js";import{T as Le}from"./table-pagination-custom-DgvLjnHq.js";import{b as F}from"./format-number-7nwGld6g.js";import{C as Fe}from"./confirm-dialog-BmrK7glg.js";import{T as j}from"./TableCell-FvdEFRkr.js";import{A as He}from"./AvatarGroup-CXQqpOFQ.js";import{T as Ne}from"./TextField-DhW8zjJC.js";import{I as qe}from"./InputAdornment-B2x29rol.js";import{P as Ve}from"./product-table-filters-result-BPnYAZyO.js";import"./form-provider-L0KFjUTq.js";import"./editor-CzmUVphq.js";import"./incrementer-button-ai0czu6f.js";import"./carousel-progress-bar-BQbRyWCv.js";import"./html-to-markdown-BtygCoAR.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./product-Item-button-BItuJ1ve.js";import"./upload-avatar-C3B5eTLv.js";import"./FormHelperText-BHlZRpvh.js";import"./formControlState-Dq1zat_P.js";import"./index-D0kJtIpB.js";import"./DialogContent-CKRoYUkD.js";import"./DialogTitle-B7z_2PjV.js";import"./LoadingButton-C_x5mIfX.js";import"./CircularProgress-Bi1c9VU0.js";import"./AccordionSummary-cFNclxXQ.js";import"./FormControlLabel-5B8r8hjw.js";import"./empty-content-CaftPqQK.js";import"./Checkbox-XoXkZxXm.js";import"./TablePagination-DVtYhtU_.js";import"./KeyboardArrowRight-DzNmTPM2.js";import"./LastPage-CC1oKrM4.js";import"./Select-B6atPAS4.js";import"./Menu-BvjNAHEG.js";import"./utils-DoM3o7-Q.js";import"./InputBase-B9hwN3-B.js";import"./FormControl-n1s9FAXz.js";import"./InputLabel-CCRBBEhV.js";import"./FormLabel-C9Vfi2q1.js";import"./filters-result-lqxp4t27.js";import"./Chip-CYchvRo_.js";import"./Rating-C-gTF_lZ.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-Buv_oatH.js";import"./RadioGroup-Bz4MgZrq.js";import"./FormGroup-CwleoAMr.js";import"./countries-DSLisFCy.js";import"./Autocomplete-C74LI-Rt.js";import"./country-select-CBbXG_H4.js";import"./DatePicker-BiJlOuDh.js";import"./ListItem-CbBrCKNq.js";import"./MobileDateTimePicker-CIeUS7kl.js";import"./Tabs-BAzl82ph.js";import"./index-Bb5BZvNl.js";const $e=({row:t,index:l,selected:s,onViewRow:b,onDeleteRow:m,onEditRow:u})=>{var y,T,a,g,R,z;const[P,i]=x.useState(((y=t==null?void 0:t.productToOrder)==null?void 0:y.length)>0),h=H(),r=H(),n=se(),d=Z(),k=x.useCallback(o=>{d.push(f.dashboard.order.details(o))},[d]),S=x.useCallback(o=>{d.push(f.dashboard.product.details(o))},[d]),E=e.jsxs(Y,{hover:!0,selected:s,children:[e.jsx(j,{children:l||(t==null?void 0:t.id)}),e.jsx(j,{children:e.jsxs(v,{spacing:2,direction:"row",alignItems:"center",children:[e.jsx(J,{alt:t==null?void 0:t.name,src:D.site.serverFileHost+((t==null?void 0:t.image)||D.site.defaultImgPlaceHolder)}),e.jsx(C,{component:"span",children:t==null?void 0:t.name})]})}),e.jsx(j,{children:e.jsx(He,{sx:{[`& .${re.avatar}`]:{width:24,height:24}},children:e.jsx(ee,{title:`${(T=t==null?void 0:t.category)==null?void 0:T.name}`,children:e.jsx(J,{alt:(a=t==null?void 0:t.category)==null?void 0:a.name,src:`${D.site.serverFileHost}${(g=t==null?void 0:t.category)==null?void 0:g.image}`})})})}),e.jsx(j,{children:F(t==null?void 0:t.price)}),e.jsxs(j,{align:"center",children:[" ",((R=t==null?void 0:t.stock)==null?void 0:R.quantity)||"0"," "]}),e.jsx(j,{children:e.jsx(oe,{variant:"soft",color:t.isActive===!0&&"success"||t.isActive===!1&&"error"||"default",children:t!=null&&t.isActive?"ACTIVE":"INACTIVE"})}),e.jsxs(j,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[P&&e.jsx(N,{color:r.value?"inherit":"default",onClick:r.onToggle,sx:{...r.value&&{bgcolor:"action.hover"}},children:e.jsx(p,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(N,{color:n.open?"inherit":"default",onClick:n.onOpen,children:e.jsx(p,{icon:"eva:more-vertical-fill"})})]})]}),O=e.jsx(Y,{children:e.jsx(j,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(ae,{in:r.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(ne,{sx:{m:1.5},children:(z=t==null?void 0:t.productToOrder)==null?void 0:z.map((o,te)=>{var G,M,U,_,K,Q,W,w;return te===5?e.jsx(v,{alignItems:"flex-end",sx:{p:c=>c.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:c=>`solid 2px ${c.vars.palette.background.neutral}`}},children:e.jsx(q,{variant:"contained",size:"small",endIcon:e.jsx(p,{icon:"heroicons-outline:external-link"}),onClick:()=>{S(t.id)},children:"See More"})},o.id):e.jsxs(v,{direction:"row",alignItems:"center",sx:{p:c=>c.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:c=>`solid 2px ${c.vars.palette.background.neutral}`}},children:[e.jsxs(C,{onClick:()=>{var c;return k((c=o==null?void 0:o.order)==null?void 0:c.id)},sx:{width:240,display:"flex",gap:1,alignItems:"center",cursor:"pointer",marginRight:5},children:[e.jsx(p,{icon:"heroicons-outline:external-link"}),e.jsx("span",{children:(G=o==null?void 0:o.order)==null?void 0:G.ref})]}),e.jsx(C,{sx:{width:"100%",display:"flex",gap:1,alignItems:"center"},children:e.jsx("span",{children:(U=(M=o.order)==null?void 0:M.customer)==null?void 0:U.name})}),e.jsxs(C,{sx:{width:240,color:"error.main",fontWeight:"bold"},children:["x",o.quantity," ",e.jsx("span",{style:{color:"#000",fontWeight:"400"},children:`(${F(o==null?void 0:o.snapshotProductPrice)})`})]}),e.jsx(C,{sx:{width:200,textAlign:"right"},children:(_=o.order)==null?void 0:_.status}),e.jsx(C,{sx:{width:300,textAlign:"right"},children:F(ie(((K=o.order)==null?void 0:K.totalOrderAmount)-((Q=o.order)==null?void 0:Q.totalOrderAmount)*(((W=o.order)==null?void 0:W.discount)/100),(w=o.order)==null?void 0:w.snapshotTaxPercentage))||"-"})]},o.id)})})})})});return e.jsxs(e.Fragment,{children:[E,O,e.jsx(le,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(de,{children:[e.jsxs(B,{onClick:()=>{b(),n.onClose()},children:[e.jsx(p,{icon:"solar:eye-bold"}),"View"]}),e.jsx(A,{permission:I.EDIT_PRODUCT,children:e.jsxs(B,{onClick:()=>{u(t.id),n.onClose()},children:[e.jsx(p,{icon:"solar:pen-bold"}),"Edit"]})}),e.jsx(A,{permission:I.DELETE_PRODUCT,children:e.jsxs(B,{onClick:()=>{h.onTrue(),n.onClose()},sx:{color:"error.main"},children:[e.jsx(p,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})})]})}),e.jsx(Fe,{open:h.value,onClose:h.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(q,{variant:"contained",color:"error",onClick:m,children:"Delete"})})]})};function ze({filters:t,onResetPage:l,options:s}){const b=x.useCallback(m=>{l(),t.setState({name:m.target.value})},[t,l]);return e.jsx(v,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(Ne,{sx:{width:420},value:t.state.name,onChange:b,placeholder:"Search by Product Name or Ref",InputProps:{startAdornment:e.jsx(qe,{position:"start",children:e.jsx(p,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}const Ge=[{id:"productId",label:"No.",width:80},{id:"productName",label:"Name"},{id:"productPrice",label:"Category",width:200},{id:"productPrice",label:"Price",width:200},{id:"stock",label:"Stock",align:"center"},{id:"status",label:"Status",width:100},{id:"",width:88}];function Me({products:t,taxPercentage:l}){const s=Ie({defaultOrderBy:"planId"}),b=H(),m=Z(),[u,P]=x.useState(t),i=ce({name:"",status:"all",startDate:null,endDate:null});x.useEffect(()=>{P(t)},[t]);const h=pe(i.state.startDate,i.state.endDate),r=Ue({inputData:u,comparator:Re(s.order,s.orderBy),filters:i.state,dateError:h}),n=ve(r,s.page,s.rowsPerPage),d=!!i.state.name||i.state.status!=="all"||!!i.state.startDate&&!!i.state.endDate,k=!r.length&&d||!r.length,S=x.useCallback(a=>{T(a)},[n.length,s,u]),E=x.useCallback(a=>{m.push(f.dashboard.product.edit(a))},[m]),O=x.useCallback(a=>{m.push(f.dashboard.product.details(a))},[m]),y=me(),{mutate:T}=ye({mutationFn:a=>V.delete($.products.delete+a),onSuccess:async a=>{const g=u.filter(R=>R.id!==a);fe.success("Delete success!"),P(g),s.onUpdatePageDeleteRow(n.length)},onSettled:async()=>{await y.invalidateQueries({queryKey:["products"]})},onError:()=>{}});return e.jsx(ue,{maxWidth:"xl",children:e.jsxs(L,{container:!0,spacing:3,children:[e.jsx(L,{xs:12,md:12,children:e.jsx(Te,{links:[{name:"Dashboard",href:f.dashboard.root},{name:"Product",href:f.dashboard.plan.root},{name:"List"}],action:e.jsx(A,{permission:I.ADD_PRODUCT,children:e.jsx(q,{component:he,href:f.dashboard.product.new,variant:"contained",startIcon:e.jsx(p,{icon:"mingcute:add-line"}),children:"Add New Product"})})})}),e.jsx(A,{permission:I.LIST_PRODUCT,children:e.jsx(L,{xs:12,md:12,children:e.jsxs(xe,{children:[e.jsx(ze,{filters:i,onResetPage:s.onResetPage,dateError:h}),d&&e.jsx(Ve,{filters:i,totalResults:r.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(C,{sx:{position:"relative"},children:[e.jsx(Be,{dense:s.dense,numSelected:s.selected.length,rowCount:r.length,onSelectAllRows:a=>s.onSelectAllRows(a,r.map(g=>g.id)),action:e.jsx(ee,{title:"Delete",children:e.jsx(N,{color:"primary",onClick:b.onTrue,children:e.jsx(p,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(ge,{sx:{minHeight:444},children:e.jsxs(Se,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Ee,{order:s.order,orderBy:s.orderBy,headLabel:Ge,rowCount:r.length,numSelected:s.selected.length,onSort:s.onSort}),e.jsxs(Oe,{children:[r.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map((a,g)=>e.jsx($e,{row:a,index:s.page*s.rowsPerPage+g+1,selected:s.selected.includes(a.id),onEditRow:()=>E(a.id),onViewRow:()=>O(a.id),onDeleteRow:()=>S(a.id),taxPercentage:l},a.id)),e.jsx(ke,{height:s.dense?56:76,emptyRows:De(s.page,s.rowsPerPage,r.length)}),e.jsx(Ae,{notFound:k})]})]})})]}),e.jsx(Le,{page:s.page,dense:s.dense,count:r.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})})})]})})}function Ue({inputData:t,comparator:l,filters:s,dateError:b}){const{status:m,name:u,startDate:P,endDate:i}=s,h=t.map((r,n)=>[r,n]);return h.sort((r,n)=>{const d=l(r[0],n[0]);return d!==0?d:r[1]-n[1]}),t=h.map(r=>r[0]),u&&(t=t.filter(r=>r.id.toString().toLowerCase().indexOf(u.toLowerCase())!==-1||r.name.toLowerCase().indexOf(u.toLowerCase())!==-1)),b||P&&i&&(t=t.filter(r=>je(r.createdAt,P,i))),t}const _e={title:`Product list | Dashboard - ${D.site.name}`};function is(){const t=X({queryKey:["products"],queryFn:async()=>{const{data:s}=await V.get($.products.list);return s}}),l=X({queryKey:["account-application"],queryFn:async()=>{const{data:s}=await V.get($.auth.application);return s}});return l.isLoading||t.isLoading?e.jsx(be,{}):l.isError||t.isError?e.jsx(Ce,{route:f.dashboard.products.root}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{children:e.jsxs("title",{children:[" ",_e.title]})}),e.jsx(Me,{products:t.data,taxPercentage:l.data.taxPercentage})]})}export{is as default};
