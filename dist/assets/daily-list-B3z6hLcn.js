import{j as t,dn as j,r as u,ab as S,S as D,de as w,e3 as $,dQ as B,p as h,cY as E,B as Y,ed as F,dU as A,H as k,C as H,dq as I,dm as L}from"./index-88qAwG8P.js";import{u as M,E as O}from"./error-block-BTff90qR.js";import{b as R}from"./format-number-B8FPsWIV.js";import{C as q}from"./custom-breadcrumbs-x7W5GMPl.js";import{g as N,e as V}from"./utils-MBUcMVfY.js";import{u as W}from"./use-table-BYPgfP9k.js";import{T as z}from"./table-no-data-wFoKraSE.js";import{T as Q}from"./table-empty-rows-6krMqYw2.js";import{T as _,a as G,b as K,c as U}from"./table-head-custom-g2OgtrHv.js";import{T as J}from"./table-selected-action-DnALz1xy.js";import{T as g}from"./TableCell-Cl8UZGxf.js";import{D as X}from"./DatePicker-C1aTSbY2.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./empty-content-vgDCQT8r.js";import"./Checkbox-Cpc8f1GH.js";import"./index-CySZofTa.js";import"./FormControl-BXGEHd-f.js";import"./utils-DoM3o7-Q.js";import"./InputLabel-B0kOUcWA.js";import"./formControlState-Dq1zat_P.js";import"./FormLabel-Ck5_RgM9.js";import"./FormHelperText-DA7jizKd.js";import"./visuallyHidden-Dan1xhjv.js";import"./TextField-CQpihH7F.js";import"./Select-DFC-Q2QB.js";import"./Menu-BDUaDfAf.js";import"./InputBase-DD8qHu7J.js";import"./InputAdornment-Bg-m_z4_.js";import"./DialogContent-F9o-_CVT.js";import"./ListItem-Bt-kWpW8.js";import"./Chip-yDeOg34u.js";const Z=({row:e,selected:a})=>{const s=t.jsxs(_,{hover:!0,selected:a,children:[t.jsx(g,{children:e==null?void 0:e.label}),t.jsx(g,{children:e==null?void 0:e.value})]});return t.jsx(t.Fragment,{children:s})};function ee({filters:e,onResetPage:a}){const{t:s}=j("reports"),c=u.useCallback(i=>{const d=S(i).add(1,"day").format("YYYY-MM-DD");a(),e.setState({startDate:i,endDate:d})},[e,a]);return t.jsx(D,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:t.jsx(X,{label:s("dailyReports.table.tableToolbar.date"),format:"DD/MM/YYYY",value:e.state.startDate,onChange:c})})}const te=({orders:e})=>{const a=W({defaultOrderBy:"orderNumber"}),{t:s}=j("reports"),c=[{label:`${s("dailyReports.table.rows.orders")}`,value:0},{label:`${s("dailyReports.table.rows.nbDelivered")}`,value:0},{label:`${s("dailyReports.table.rows.totalSales")}`,value:0},{label:`${s("dailyReports.table.rows.totalPayments")}`,value:0}],i=[{id:"reminderId",label:`${s("dailyReports.table.tableHeader.particular")}`},{id:"date",label:`${s("dailyReports.table.tableHeader.value")}`,width:280}],[d,b]=u.useState(e);u.useRef(c);const o=w({name:"",status:"all",startDate:null,endDate:null}),r=$(o.state.startDate,o.state.endDate),l=ae({inputData:d,comparator:N(a.order,a.orderBy),filters:o.state,dateError:r}),y=u.useCallback(n=>{const m=n.filter(p=>p.status==="Delivered").length,x=R(n.reduce((p,f)=>p+f.totalOrderAmount,0)),P=R(n.reduce((p,f)=>p+f.orderPaymentAmount,0));return{orders:n.length,nbDelivered:m,totalSales:x,totalPayments:P}},[]),T=n=>{const m=y(n);return[{label:`${s("dailyReports.table.rows.orders")}`,value:m.orders},{label:`${s("dailyReports.table.rows.nbDelivered")}`,value:m.nbDelivered},{label:`${s("dailyReports.table.rows.totalSales")}`,value:m.totalSales},{label:`${s("dailyReports.table.rows.totalPayments")}`,value:m.totalPayments}]};u.useEffect(()=>{e&&b(e)},[e]);const C=!!o.state.name||o.state.status!=="all"||!!o.state.startDate&&!!o.state.endDate,v=!l.length&&C||!l.length;return t.jsx(B,{maxWidth:"xl",children:t.jsxs(D,{spacing:3,children:[t.jsx(q,{links:[{name:`${s("dailyReports.breadCrumbsPageRootTitle")}`,href:h.dashboard.root},{name:`${s("dailyReports.breadCrumbsParentPageTitle")}`,href:h.dashboard.reports.root},{name:`${s("dailyReports.breadCrumbsPageTitle")}`,href:h.dashboard.reports.daily}]}),t.jsxs(E,{children:[t.jsx(ee,{filters:o,onResetPage:a.onResetPage,dateError:r}),t.jsxs(Y,{sx:{position:"relative"},children:[t.jsx(J,{dense:a.dense,numSelected:a.selected.length,rowCount:l.length}),t.jsxs(G,{size:a.dense?"small":"medium",sx:{minWidth:960},children:[t.jsx(K,{order:a.order,orderBy:a.orderBy,headLabel:i,rowCount:l.length}),t.jsxs(U,{children:[T(l).map(n=>t.jsx(Z,{row:n,selected:a.selected.includes(n.id)},n.id)),t.jsx(Q,{height:a.dense?56:76,emptyRows:V(a.page,a.rowsPerPage,l.length)}),t.jsx(z,{notFound:v})]})]})]})]})]})})};function ae({inputData:e,comparator:a,filters:s,dateError:c}){const{status:i,startDate:d,endDate:b}=s,o=e.map((r,l)=>[r,l]);return o.sort((r,l)=>{const y=a(r[0],l[0]);return y!==0?y:r[1]-l[1]}),e=o.map(r=>r[0]),i!=="all"&&(e=e.filter(r=>r.status===i)),c||d&&b&&(e=e.filter(r=>F(r.orderDate,d,b))),e}const se={title:`Reports list | Dashboard - ${H.site.name}`};function Le(){const e=M({queryKey:["orders"],queryFn:async()=>{const{data:a}=await I.get(L.order.list);return a}});return e.isPending||e.isLoading?t.jsx(A,{}):e.isError?t.jsx(O,{route:h.dashboard.reports.root}):t.jsxs(t.Fragment,{children:[t.jsx(k,{children:t.jsxs("title",{children:[" ",se.title]})}),t.jsx(te,{orders:e.data})]})}export{Le as default};
