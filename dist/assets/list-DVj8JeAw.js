import{r as x,o as L,bO as G,l as $,p as j,j as e,S as R,A as J,C as w,B as C,ds as X,w as F,I as p,dh as Y,az as Z,e as H,ew as ee,dw as te,bQ as se,bR as E,em as D,dz as re,eo as oe,dI as ae,e8 as ne,G as O,R as ie,aD as le,cM as de,dy as ce,ep as pe,dJ as N,dH as q,dK as ue,ec as me,H as he}from"./index-yGbCRgTb.js";import{u as Q,E as xe}from"./error-block-DTJA4qog.js";import"./product-review-new-form-yKmJdV0L.js";import"./index-CUvxe-2f.js";import"./image-DcD9e3NU.js";import"./color-preview-Dq8jRYKk.js";import{u as ge}from"./useMutation-By1q-eS7.js";import{C as je}from"./custom-breadcrumbs-BVoeLH7h.js";import{P as I}from"./permission-access-controller-Dm06QNPj.js";import{g as fe,r as be,T as Pe,a as Ce,e as ye}from"./table-selected-action-ouhBymae.js";import{u as Te}from"./use-table-CKTXv-Z5.js";import{T as Re}from"./table-no-data-CAqPvp_P.js";import{T as W,a as De,b as Ie,c as ve}from"./table-head-custom-Dmu61VxH.js";import{T as ke}from"./table-pagination-custom-D_SwmGih.js";import{b as B}from"./format-number-CldpmeB4.js";import{C as Se}from"./confirm-dialog-Ko2N1QmH.js";import{T as P}from"./TableCell-kQtrcvwO.js";import{T as Ae}from"./TextField-HI4be0gE.js";import{I as Ee}from"./InputAdornment-CcIxSkvC.js";import{P as Oe}from"./product-table-filters-result-BZhbRohY.js";import"./form-provider-DYU4Aza6.js";import"./editor-DVBR6pSL.js";import"./incrementer-button-DUj63JZv.js";import"./carousel-progress-bar-BB9o_2pj.js";import"./html-to-markdown-Ll6kMEOX.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./product-Item-button-C91vQ0ay.js";import"./upload-avatar-C2G_2g_c.js";import"./FormHelperText-Dnev79N5.js";import"./formControlState-Dq1zat_P.js";import"./index-R0SYIoas.js";import"./DialogContent-DMTZhSCC.js";import"./DialogTitle-Dtm0x3W5.js";import"./LoadingButton-DkWrtn4w.js";import"./CircularProgress-B5oTQZ22.js";import"./AccordionSummary-DfMSgH3u.js";import"./FormControlLabel-C9PyVvR2.js";import"./Checkbox-CLReM-9f.js";import"./empty-content-DuekPASb.js";import"./TablePagination--mxkDLnZ.js";import"./KeyboardArrowRight-gA8WWooR.js";import"./LastPage-Bpf9jdMv.js";import"./Select-q90WBvXR.js";import"./Menu-BP741PyP.js";import"./utils-DoM3o7-Q.js";import"./InputBase-DgymrakP.js";import"./FormControl-BZpoYGsF.js";import"./InputLabel-DnqBfGRt.js";import"./FormLabel-CZqAmIUK.js";import"./filters-result-IEq4pTDN.js";import"./Chip-Di1iaus5.js";import"./Rating-3onsWGCC.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-CzzVUG04.js";import"./RadioGroup-81h_beeC.js";import"./FormGroup-ClqLJ3mg.js";import"./countries-DSLisFCy.js";import"./Autocomplete-C25PC4l8.js";import"./country-select-CxHEhT0K.js";import"./DatePicker-5fPzc3RP.js";import"./ListItem-CzWKnPSR.js";import"./MobileDateTimePicker-BclKweyT.js";import"./Tabs-CyyRymLB.js";import"./index-CCt0SICN.js";const Be=({row:t,index:l,selected:s,onViewRow:f,onDeleteRow:u,onEditRow:m})=>{var y;const[b,i]=x.useState((t==null?void 0:t.productToOrder.length)>0),h=L(),r=L(),n=G(),d=$(),v=x.useCallback(o=>{d.push(j.dashboard.order.details(o))},[d]),k=x.useCallback(o=>{d.push(j.dashboard.product.details(o))},[d]),S=e.jsxs(W,{hover:!0,selected:s,children:[e.jsx(P,{children:l||(t==null?void 0:t.id)}),e.jsx(P,{children:e.jsxs(R,{spacing:2,direction:"row",alignItems:"center",children:[e.jsx(J,{alt:t==null?void 0:t.name,src:w.site.serverFileHost+((t==null?void 0:t.image)||w.site.defaultImgPlaceHolder)}),e.jsx(C,{component:"span",children:t==null?void 0:t.name})]})}),e.jsx(P,{children:B(t==null?void 0:t.price)}),e.jsxs(P,{align:"center",children:[" ",((y=t==null?void 0:t.stock)==null?void 0:y.quantity)||"0"," "]}),e.jsx(P,{children:e.jsx(X,{variant:"soft",color:t.isActive===!0&&"success"||t.isActive===!1&&"error"||"default",children:t!=null&&t.isActive?"ACTIVE":"INACTIVE"})}),e.jsxs(P,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[b&&e.jsx(F,{color:r.value?"inherit":"default",onClick:r.onToggle,sx:{...r.value&&{bgcolor:"action.hover"}},children:e.jsx(p,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(F,{color:n.open?"inherit":"default",onClick:n.onOpen,children:e.jsx(p,{icon:"eva:more-vertical-fill"})})]})]}),A=e.jsx(W,{children:e.jsx(P,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(Y,{in:r.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(Z,{sx:{m:1.5},children:t==null?void 0:t.productToOrder.map((o,a)=>{var g,T,V,z,M,U,_,K;return a===5?e.jsx(R,{alignItems:"flex-end",sx:{p:c=>c.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:c=>`solid 2px ${c.vars.palette.background.neutral}`}},children:e.jsx(H,{variant:"contained",size:"small",endIcon:e.jsx(p,{icon:"heroicons-outline:external-link"}),onClick:()=>{k(t.id)},children:"See More"})},o.id):e.jsxs(R,{direction:"row",alignItems:"center",sx:{p:c=>c.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:c=>`solid 2px ${c.vars.palette.background.neutral}`}},children:[e.jsxs(C,{onClick:()=>{var c;return v((c=o==null?void 0:o.order)==null?void 0:c.id)},sx:{width:240,display:"flex",gap:1,alignItems:"center",cursor:"pointer",marginRight:5},children:[e.jsx(p,{icon:"heroicons-outline:external-link"}),e.jsx("span",{children:(g=o==null?void 0:o.order)==null?void 0:g.ref})]}),e.jsx(C,{sx:{width:"100%",display:"flex",gap:1,alignItems:"center"},children:e.jsx("span",{children:(V=(T=o.order)==null?void 0:T.customer)==null?void 0:V.name})}),e.jsxs(C,{sx:{width:240,color:"error.main",fontWeight:"bold"},children:["x",o.quantity," ",e.jsx("span",{style:{color:"#000",fontWeight:"400"},children:`(${B(o==null?void 0:o.snapshotProductPrice)})`})]}),e.jsx(C,{sx:{width:200,textAlign:"right"},children:(z=o.order)==null?void 0:z.status}),e.jsx(C,{sx:{width:300,textAlign:"right"},children:B(ee(((M=o.order)==null?void 0:M.totalOrderAmount)-((U=o.order)==null?void 0:U.totalOrderAmount)*(((_=o.order)==null?void 0:_.discount)/100),(K=o.order)==null?void 0:K.snapshotTaxPercentage))||"-"})]},o.id)})})})})});return e.jsxs(e.Fragment,{children:[S,A,e.jsx(te,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(se,{children:[e.jsxs(E,{onClick:()=>{f(),n.onClose()},children:[e.jsx(p,{icon:"solar:eye-bold"}),"View"]}),e.jsx(I,{permission:D.EDIT_PRODUCT,children:e.jsxs(E,{onClick:()=>{m(t.id),n.onClose()},children:[e.jsx(p,{icon:"solar:pen-bold"}),"Edit"]})}),e.jsx(I,{permission:D.DELETE_PRODUCT,children:e.jsxs(E,{onClick:()=>{h.onTrue(),n.onClose()},sx:{color:"error.main"},children:[e.jsx(p,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})})]})}),e.jsx(Se,{open:h.value,onClose:h.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(H,{variant:"contained",color:"error",onClick:u,children:"Delete"})})]})};function Le({filters:t,onResetPage:l,options:s}){const f=x.useCallback(u=>{l(),t.setState({name:u.target.value})},[t,l]);return e.jsx(R,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(Ae,{sx:{width:420},value:t.state.name,onChange:f,placeholder:"Search by Product Name or Ref",InputProps:{startAdornment:e.jsx(Ee,{position:"start",children:e.jsx(p,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}const we=[{id:"productId",label:"No.",width:80},{id:"productName",label:"Product Name"},{id:"productPrice",label:"Product Price",width:200},{id:"stock",label:"Stock",align:"center"},{id:"status",label:"Status",width:100},{id:"",width:88}];function Fe({products:t,taxPercentage:l}){const s=Te({defaultOrderBy:"planId"}),f=L(),u=$(),[m,b]=x.useState(t),i=re({name:"",status:"all",startDate:null,endDate:null});x.useEffect(()=>{b(t)},[t]);const h=oe(i.state.startDate,i.state.endDate),r=He({inputData:m,comparator:fe(s.order,s.orderBy),filters:i.state,dateError:h}),n=be(r,s.page,s.rowsPerPage),d=!!i.state.name||i.state.status!=="all"||!!i.state.startDate&&!!i.state.endDate,v=!r.length&&d||!r.length,k=x.useCallback(a=>{o(a)},[n.length,s,m]),S=x.useCallback(a=>{u.push(j.dashboard.product.edit(a))},[u]),A=x.useCallback(a=>{u.push(j.dashboard.product.details(a))},[u]),y=ae(),{mutate:o}=ge({mutationFn:a=>N.delete(q.products.delete+a),onSuccess:async a=>{const g=m.filter(T=>T.id!==a);ue.success("Delete success!"),b(g),s.onUpdatePageDeleteRow(n.length)},onSettled:async()=>{await y.invalidateQueries({queryKey:["products"]})},onError:()=>{}});return e.jsx(ne,{maxWidth:"xl",children:e.jsxs(O,{container:!0,spacing:3,children:[e.jsx(O,{xs:12,md:12,children:e.jsx(je,{links:[{name:"Dashboard",href:j.dashboard.root},{name:"Product",href:j.dashboard.plan.root},{name:"List"}],action:e.jsx(I,{permission:D.ADD_PRODUCT,children:e.jsx(H,{component:ie,href:j.dashboard.product.new,variant:"contained",startIcon:e.jsx(p,{icon:"mingcute:add-line"}),children:"Add New Product"})})})}),e.jsx(I,{permission:D.LIST_PRODUCT,children:e.jsx(O,{xs:12,md:12,children:e.jsxs(le,{children:[e.jsx(Le,{filters:i,onResetPage:s.onResetPage,dateError:h}),d&&e.jsx(Oe,{filters:i,totalResults:r.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(C,{sx:{position:"relative"},children:[e.jsx(Pe,{dense:s.dense,numSelected:s.selected.length,rowCount:r.length,onSelectAllRows:a=>s.onSelectAllRows(a,r.map(g=>g.id)),action:e.jsx(de,{title:"Delete",children:e.jsx(F,{color:"primary",onClick:f.onTrue,children:e.jsx(p,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(ce,{sx:{minHeight:444},children:e.jsxs(De,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Ie,{order:s.order,orderBy:s.orderBy,headLabel:we,rowCount:r.length,numSelected:s.selected.length,onSort:s.onSort}),e.jsxs(ve,{children:[r.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map((a,g)=>e.jsx(Be,{row:a,index:s.page*s.rowsPerPage+g+1,selected:s.selected.includes(a.id),onEditRow:()=>S(a.id),onViewRow:()=>A(a.id),onDeleteRow:()=>k(a.id),taxPercentage:l},a.id)),e.jsx(Ce,{height:s.dense?56:76,emptyRows:ye(s.page,s.rowsPerPage,r.length)}),e.jsx(Re,{notFound:v})]})]})})]}),e.jsx(ke,{page:s.page,dense:s.dense,count:r.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})})})]})})}function He({inputData:t,comparator:l,filters:s,dateError:f}){const{status:u,name:m,startDate:b,endDate:i}=s,h=t.map((r,n)=>[r,n]);return h.sort((r,n)=>{const d=l(r[0],n[0]);return d!==0?d:r[1]-n[1]}),t=h.map(r=>r[0]),m&&(t=t.filter(r=>r.id.toString().toLowerCase().indexOf(m.toLowerCase())!==-1||r.name.toLowerCase().indexOf(m.toLowerCase())!==-1)),f||b&&i&&(t=t.filter(r=>pe(r.createdAt,b,i))),t}const Ne={title:`Product list | Dashboard - ${w.site.name}`};function Xt(){const t=Q({queryKey:["products"],queryFn:async()=>{const{data:s}=await N.get(q.products.list);return s}}),l=Q({queryKey:["account-application"],queryFn:async()=>{const{data:s}=await N.get(q.auth.application);return s}});return l.isLoading||t.isLoading?e.jsx(me,{}):l.isError||t.isError?e.jsx(xe,{route:j.dashboard.products.root}):e.jsxs(e.Fragment,{children:[e.jsx(he,{children:e.jsxs("title",{children:[" ",Ne.title]})}),e.jsx(Fe,{products:t.data,taxPercentage:l.data.taxPercentage})]})}export{Xt as default};
