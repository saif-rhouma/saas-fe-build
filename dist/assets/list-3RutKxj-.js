import{r as f,w as v,bG as H,j as e,S as I,A as q,C as B,B as S,du as U,y as E,I as g,dj as _,aB as G,aK as K,dz as M,bI as w,ep as y,bJ as A,e as L,o as z,dC as Q,er as V,p as P,dL as $,eb as J,G as R,R as W,aF as X,dw as Y,dB as Z,es as ee,dM as O,dK as F,dN as te,ef as se,H as re}from"./index-Bm3rBIkL.js";import{u as oe,E as ae}from"./error-block-BO5MDXKX.js";import"./product-review-new-form-CHH-nlTz.js";import"./index-QBzjHR1Z.js";import"./image-BvWqJKQA.js";import"./color-preview-CohxypnI.js";import{u as ne}from"./useMutation-BPy7H-1h.js";import{C as ie}from"./custom-breadcrumbs-DgyWxDBR.js";import{P as T}from"./permission-access-controller-Bd1g1bvY.js";import{u as le,g as de,r as ce,T as pe,a as me,e as ue}from"./table-selected-action-FGFYoCf9.js";import{T as he}from"./table-no-data-C5ESOE9S.js";import{T as k,a as xe,b as ge,c as je}from"./table-head-custom-fAI8azNC.js";import{T as fe}from"./table-pagination-custom-B5OCrP_3.js";import{b as be}from"./format-number-zZ3CkgDh.js";import{C as Pe}from"./confirm-dialog-CdiBdWQ6.js";import{T as x}from"./TableCell-DwZUj5h4.js";import{T as Ce}from"./TextField-Zaq0_UQI.js";import{I as ye}from"./InputAdornment-C5fdA_pt.js";import{P as Te}from"./product-table-filters-result-C8B5i4Dx.js";import"./form-provider-BVzxbRNt.js";import"./editor-B_eq4lpY.js";import"./incrementer-button-alnZ2NIc.js";import"./carousel-progress-bar-BtYfMUsZ.js";import"./html-to-markdown-B4HHgAIa.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./product-Item-button-DSQD9DFB.js";import"./upload-avatar-CklA5cX-.js";import"./FormHelperText-D4MtsGiu.js";import"./formControlState-Dq1zat_P.js";import"./index-I76JgJ8L.js";import"./DialogContent-adXfkuCx.js";import"./DialogTitle-3zwXmVtf.js";import"./LoadingButton-qKaJGA43.js";import"./CircularProgress-msI0ykgU.js";import"./AccordionSummary-DAGBVshR.js";import"./Checkbox-DZc8qiZw.js";import"./empty-content-Bj3fPw3b.js";import"./TablePagination-xS2VmU8P.js";import"./LastPage-Bo5KhWUM.js";import"./Select-BbFY65UU.js";import"./Menu-BCmDYN65.js";import"./utils-DoM3o7-Q.js";import"./InputBase-CLwZiNSB.js";import"./FormControlLabel-3udn0dpo.js";import"./FormControl-Dpp_E6i1.js";import"./InputLabel-XKr5fbZR.js";import"./FormLabel-CW4sUJth.js";import"./filters-result-VXglGh15.js";import"./Chip-wb6jkBj9.js";import"./Rating-DDX-0-qU.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-DEF2K-nH.js";import"./RadioGroup-CcFDuSjI.js";import"./FormGroup-C2nO5a7k.js";import"./countries-DSLisFCy.js";import"./Autocomplete-uJqWLfO9.js";import"./country-select-dI5VfxcM.js";import"./DatePicker-BFbM1AIt.js";import"./ListItem-B8LRzQux.js";import"./MobileDateTimePicker-BrtExEWs.js";import"./index-DJLOkwgj.js";const De=({row:t,selected:s,onDeleteRow:j,onEditRow:p})=>{var h;const[m,u]=f.useState((t==null?void 0:t.productToOrder.filter(o=>{var d;return((d=o==null?void 0:o.order)==null?void 0:d.status)==="Delivered"}).length)>0),a=v(),l=v(),r=H(),n=e.jsxs(k,{hover:!0,selected:s,children:[e.jsx(x,{children:t==null?void 0:t.id}),e.jsx(x,{children:e.jsxs(I,{spacing:2,direction:"row",alignItems:"center",children:[e.jsx(q,{alt:t==null?void 0:t.name,src:B.site.serverFileHost+(t==null?void 0:t.image)}),e.jsx(S,{component:"span",children:t==null?void 0:t.name})]})}),e.jsx(x,{children:be(t==null?void 0:t.price)}),e.jsxs(x,{align:"center",children:[" ",((h=t==null?void 0:t.stock)==null?void 0:h.quantity)||"0"," "]}),e.jsx(x,{children:e.jsx(U,{variant:"soft",color:t.isActive===!0&&"success"||t.isActive===!1&&"error"||"default",children:t!=null&&t.isActive?"ACTIVE":"INACTIVE"})}),e.jsxs(x,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[m&&e.jsx(E,{color:l.value?"inherit":"default",onClick:l.onToggle,sx:{...l.value&&{bgcolor:"action.hover"}},children:e.jsx(g,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(E,{color:r.open?"inherit":"default",onClick:r.onOpen,children:e.jsx(g,{icon:"eva:more-vertical-fill"})})]})]}),c=e.jsx(k,{children:e.jsx(x,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(_,{in:l.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(G,{sx:{m:1.5},children:t==null?void 0:t.productToOrder.filter(o=>{var d;return((d=o==null?void 0:o.order)==null?void 0:d.status)==="Delivered"}).map(o=>{var d,C;return e.jsxs(I,{direction:"row",alignItems:"center",sx:{p:b=>b.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:b=>`solid 2px ${b.vars.palette.background.neutral}`}},children:[e.jsx(K,{primary:`ORD-${(d=o==null?void 0:o.order)==null?void 0:d.id}`,secondary:o.sku,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs("div",{children:["x",o.quantity," "]}),e.jsx(S,{sx:{width:110,textAlign:"right"},children:(C=o.order)==null?void 0:C.status})]},o.id)})})})})});return e.jsxs(e.Fragment,{children:[n,c,e.jsx(M,{open:r.open,anchorEl:r.anchorEl,onClose:r.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(w,{children:[e.jsx(T,{permission:y.EDIT_PRODUCT,children:e.jsxs(A,{onClick:()=>{p(t.id),r.onClose()},children:[e.jsx(g,{icon:"solar:pen-bold"}),"Edit"]})}),e.jsx(T,{permission:y.DELETE_PRODUCT,children:e.jsxs(A,{onClick:()=>{a.onTrue(),r.onClose()},sx:{color:"error.main"},children:[e.jsx(g,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})})]})}),e.jsx(Pe,{open:a.value,onClose:a.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(L,{variant:"contained",color:"error",onClick:j,children:"Delete"})})]})};function Re({filters:t,onResetPage:s,options:j}){const p=f.useCallback(m=>{s(),t.setState({name:m.target.value})},[t,s]);return e.jsx(I,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(Ce,{sx:{width:420},value:t.state.name,onChange:p,placeholder:"Search by Product Name or Ref",InputProps:{startAdornment:e.jsx(ye,{position:"start",children:e.jsx(g,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}const ve=[{id:"productId",label:"No.",width:80},{id:"productName",label:"Product Name"},{id:"productPrice",label:"Product Price",width:200},{id:"stock",label:"Stock",align:"center"},{id:"status",label:"Status",width:100},{id:"",width:88}];function Ie({products:t}){const s=le({defaultOrderBy:"planId"}),j=v(),p=z(),[m,u]=f.useState(t),a=Q({name:"",status:"all",startDate:null,endDate:null});f.useEffect(()=>{u(t)},[t]);const l=V(a.state.startDate,a.state.endDate),r=Se({inputData:m,comparator:de(s.order,s.orderBy),filters:a.state,dateError:l}),n=ce(r,s.page,s.rowsPerPage),c=!!a.state.name||a.state.status!=="all"||!!a.state.startDate&&!!a.state.endDate,h=!r.length&&c||!r.length,o=f.useCallback(i=>{b(i)},[n.length,s,m]),d=f.useCallback(i=>{p.push(P.dashboard.product.edit(i))},[p]),C=$(),{mutate:b}=ne({mutationFn:i=>O.delete(F.products.delete+i),onSuccess:async i=>{const D=m.filter(N=>N.id!==i);te.success("Delete success!"),u(D),s.onUpdatePageDeleteRow(n.length)},onSettled:async()=>{await C.invalidateQueries({queryKey:["products"]})},onError:()=>{}});return e.jsx(J,{maxWidth:"xl",children:e.jsxs(R,{container:!0,spacing:3,children:[e.jsx(R,{xs:12,md:12,children:e.jsx(ie,{links:[{name:"Dashboard",href:P.dashboard.root},{name:"Product",href:P.dashboard.plan.root},{name:"List"}],action:e.jsx(T,{permission:y.ADD_PRODUCT,children:e.jsx(L,{component:W,href:P.dashboard.product.new,variant:"contained",startIcon:e.jsx(g,{icon:"mingcute:add-line"}),children:"Add New Product"})})})}),e.jsx(T,{permission:y.LIST_PRODUCT,children:e.jsx(R,{xs:12,md:12,children:e.jsxs(X,{children:[e.jsx(Re,{filters:a,onResetPage:s.onResetPage,dateError:l}),c&&e.jsx(Te,{filters:a,totalResults:r.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(S,{sx:{position:"relative"},children:[e.jsx(pe,{dense:s.dense,numSelected:s.selected.length,rowCount:r.length,onSelectAllRows:i=>s.onSelectAllRows(i,r.map(D=>D.id)),action:e.jsx(Y,{title:"Delete",children:e.jsx(E,{color:"primary",onClick:j.onTrue,children:e.jsx(g,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(Z,{sx:{minHeight:444},children:e.jsxs(xe,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(ge,{order:s.order,orderBy:s.orderBy,headLabel:ve,rowCount:r.length,numSelected:s.selected.length,onSort:s.onSort}),e.jsxs(je,{children:[r.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(i=>e.jsx(De,{row:i,selected:s.selected.includes(i.id),onEditRow:()=>d(i.id),onDeleteRow:()=>o(i.id)},i.id)),e.jsx(me,{height:s.dense?56:76,emptyRows:ue(s.page,s.rowsPerPage,r.length)}),e.jsx(he,{notFound:h})]})]})})]}),e.jsx(fe,{page:s.page,dense:s.dense,count:r.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})})})]})})}function Se({inputData:t,comparator:s,filters:j,dateError:p}){const{status:m,name:u,startDate:a,endDate:l}=j,r=t.map((n,c)=>[n,c]);return r.sort((n,c)=>{const h=s(n[0],c[0]);return h!==0?h:n[1]-c[1]}),t=r.map(n=>n[0]),u&&(t=t.filter(n=>n.id.toString().toLowerCase().indexOf(u.toLowerCase())!==-1||n.name.toLowerCase().indexOf(u.toLowerCase())!==-1)),p||a&&l&&(t=t.filter(n=>ee(n.createdAt,a,l))),t}const Ee={title:`Product list | Dashboard - ${B.site.name}`};function Ut(){const t=oe({queryKey:["products"],queryFn:async()=>{const{data:s}=await O.get(F.products.list);return s}});return t.isPending||t.isLoading?e.jsx(se,{}):t.isError?e.jsx(ae,{route:P.dashboard.products.root}):e.jsxs(e.Fragment,{children:[e.jsx(re,{children:e.jsxs("title",{children:[" ",Ee.title]})}),e.jsx(Ie,{products:t.data})]})}export{Ut as default};
