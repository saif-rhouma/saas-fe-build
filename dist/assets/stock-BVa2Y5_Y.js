import{a3 as X,j as e,S as p,A as D,C as f,B as P,dc as ee,a6 as te,a7 as k,I,r as x,dp as B,dq as T,dn as w,dr as H,a5 as C,e as A,br as L,Y as E,df as se,e3 as ae,dU as V,p as S,dQ as ne,cZ as re,bq as oe,$ as ie,de as le,H as ce}from"./index-BqQARj70.js";import{u as Q,E as $}from"./error-block-Cvsq6LVS.js";import{C as de}from"./custom-breadcrumbs-ryDpeVg5.js";import{g as me,r as ue,e as pe}from"./utils-MBUcMVfY.js";import{u as he}from"./use-table-CIIi1yXP.js";import{T as xe}from"./table-no-data-LwGQxgtX.js";import{T as ge}from"./table-empty-rows-BLwUQgoE.js";import{T as je,a as be,b as fe,c as Pe}from"./table-head-custom-BsfRnN01.js";import{T as ye}from"./table-selected-action-U-C6vBuE.js";import{T as Se}from"./table-pagination-custom-B8jkTEOc.js";import{T as F}from"./TableCell-BYUYO2qG.js";import{z as b,u as N,t as W,a as K,F as q}from"./form-provider-ccfU2XUN.js";import{u as M}from"./useMutation-D9b-SBJX.js";import"./image-D-bc4Fg4.js";import"./editor-QJd8noTi.js";import{a as O,b as z,D as G}from"./DialogContent-Bu9AzrBB.js";import{D as J}from"./DialogTitle-rK5KahkH.js";import{L as U}from"./LoadingButton-F-RhBSUA.js";import{T as Ce}from"./TextField-Ddc-2_B3.js";import{I as Te}from"./InputAdornment-BfS4czl_.js";import{P as we}from"./product-table-filters-result-BVBd977L.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./empty-content-BECezeOK.js";import"./Checkbox-Bhx6CUcB.js";import"./TablePagination-Dx3_2Y4O.js";import"./KeyboardArrowRight-CBFHahxG.js";import"./LastPage-B8ZhtlKX.js";import"./Select-BcNE4CY6.js";import"./Menu-CyG4g8V9.js";import"./utils-DoM3o7-Q.js";import"./formControlState-Dq1zat_P.js";import"./InputBase-ByUog9Qa.js";import"./FormControlLabel-DYa7_yhu.js";import"./FormHelperText-D7zaUcMu.js";import"./Rating-CRHSMtZR.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-CY1kJa8b.js";import"./FormControl-C8LIfacH.js";import"./FormLabel-Dza6C49E.js";import"./RadioGroup-ChlGooHA.js";import"./FormGroup-CXDpwB7j.js";import"./utils-BkGDLkaZ.js";import"./index-ALNGUIW9.js";import"./countries-DSLisFCy.js";import"./Autocomplete-mVzVA2ZY.js";import"./Chip-DPBTbqGw.js";import"./country-select-BdT_Z9O2.js";import"./InputLabel-Cypnw6Fi.js";import"./upload-avatar-rmFzksOv.js";import"./format-number-BvEweN_e.js";import"./DatePicker-Ce3HVs4j.js";import"./ListItem-D-3kOQEW.js";import"./MobileDateTimePicker-huLGYsGv.js";import"./Tabs-CmqXMWlF.js";import"./index-3on3wy4W.js";import"./CircularProgress-CnEecEq8.js";import"./filters-result-D7Jq5xfN.js";const ve=({row:t,index:s,selected:n,onEditRow:i})=>{const o=X(),r=e.jsxs(je,{hover:!0,selected:n,children:[e.jsx(F,{children:s||(t==null?void 0:t.id)}),e.jsx(F,{children:e.jsxs(p,{spacing:2,direction:"row",alignItems:"center",children:[e.jsx(D,{alt:t==null?void 0:t.name,src:f.site.serverFileHost+((t==null?void 0:t.image)||f.site.defaultImgPlaceHolder)}),e.jsx(P,{component:"span",children:t==null?void 0:t.name})]})}),e.jsx(F,{children:t.quantity})]});return e.jsxs(e.Fragment,{children:[r,e.jsx(ee,{open:o.open,anchorEl:o.anchorEl,onClose:o.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsx(te,{children:e.jsxs(k,{onClick:()=>{i(t.id),o.onClose()},children:[e.jsx(I,{icon:"solar:pen-bold"}),"Edit"]})})})]})},Ee=b.object({quantity:b.number().min(0,{message:"Quantity number is required!"})}),Fe=({stock:t,open:s,onClose:n})=>{const i={quantity:(t==null?void 0:t.quantity)||0},o=N({resolver:W(Ee),defaultValues:i}),{reset:r,handleSubmit:l,formState:{isSubmitting:m}}=o,g=l(async a=>{try{j({id:t==null?void 0:t.id,payload:a})}catch(u){console.log(u)}});x.useEffect(()=>{t&&r(i)},[t]);const h=B(),{mutate:j}=M({mutationFn:({id:a,payload:u})=>T.patch(w.stock.edit+a,u),onSuccess:async()=>{H.success("Stock Has Been Modified!"),n()},onSettled:async()=>{await h.invalidateQueries({queryKey:["products-stock"]})},onError:()=>{}});return e.jsxs(O,{fullWidth:!0,open:s,onClose:n,children:[e.jsx(J,{children:"Edit Stock"}),e.jsx(C,{}),e.jsxs(K,{methods:o,onSubmit:g,children:[e.jsx(z,{sx:{pt:2},children:e.jsxs(p,{direction:"row",gap:2,children:[e.jsxs(p,{fullWidth:!0,flex:1,spacing:2,direction:"row",alignItems:"center",children:[e.jsx(D,{sx:{width:24,height:24},alt:t==null?void 0:t.name,src:f.site.serverFileHost+(t==null?void 0:t.image)}),e.jsx(P,{component:"span",children:t==null?void 0:t.name})]}),e.jsx(P,{children:e.jsx(q.Text,{type:"number",label:"Enter Quantity",name:"quantity"})})]})}),e.jsx(C,{sx:{pt:1,mt:1}}),e.jsxs(G,{children:[e.jsx(U,{type:"submit",variant:"contained",children:"Save"}),e.jsx(A,{color:"inherit",variant:"outlined",onClick:n,children:"Cancel"})]})]})]})},qe=b.object({product:b.number().min(1,{message:"Product is required!"}),quantity:b.number().min(1,{message:"Quantity number is required!"})}),De=({productsList:t,open:s,onClose:n})=>{const i={product:null,quantity:1},o=N({resolver:W(qe),defaultValues:i}),{reset:r,handleSubmit:l,formState:{isSubmitting:m}}=o,g=l(async a=>{try{j(a)}catch(u){console.log(u)}}),h=B(),{mutate:j}=M({mutationFn:a=>T.post(w.stock.create,a),onSuccess:async a=>{H.success("New Stock Has Been Created!"),r(),n()},onSettled:async()=>{await h.invalidateQueries({queryKey:["products-stock"]})},onError:()=>{}});return e.jsxs(O,{fullWidth:!0,open:s,onClose:n,children:[e.jsx(J,{children:"Add Stock"}),e.jsx(C,{}),e.jsxs(K,{methods:o,onSubmit:g,children:[e.jsx(z,{sx:{pt:2},children:e.jsxs(p,{direction:"row",gap:2,children:[e.jsx(q.Select,{name:"product",label:"Product",children:t==null?void 0:t.filter(a=>(a==null?void 0:a.stock)===null).map(a=>e.jsx(k,{value:a==null?void 0:a.id,children:e.jsxs(p,{spacing:2,direction:"row",alignItems:"center",children:[e.jsx(D,{sx:{width:24,height:24},alt:a==null?void 0:a.name,src:f.site.serverFileHost+(a==null?void 0:a.image)}),e.jsx(P,{component:"span",children:a==null?void 0:a.name})]})},a==null?void 0:a.id))}),e.jsx(q.Text,{type:"number",label:"Enter Quantity",name:"quantity"})]})}),e.jsx(C,{sx:{pt:1,mt:1}}),e.jsxs(G,{children:[e.jsx(U,{type:"submit",variant:"contained",children:"Save"}),e.jsx(A,{color:"inherit",variant:"outlined",onClick:n,children:"Cancel"})]})]})]})};function Ie({filters:t,onResetPage:s,options:n}){const{t:i}=L("products"),o=x.useCallback(r=>{s(),t.setState({name:r.target.value})},[t,s]);return e.jsx(p,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(Ce,{sx:{width:420},value:t.state.name,onChange:o,placeholder:i("stockView.table.tableToolbar.searchPlaceholder"),InputProps:{startAdornment:e.jsx(Te,{position:"start",children:e.jsx(I,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}function Re({stocks:t}){const s=he({defaultOrderBy:"planId"}),{t:n}=L("products"),i=[{id:"stockId",label:`${n("stockView.table.tableHeader.no")}`,width:60},{id:"productName",label:`${n("stockView.table.tableHeader.productName")}`},{id:"stock",label:`${n("stockView.table.tableHeader.inStock")}`,width:200}],[o,r]=x.useState(),l=E(),m=E(),g=E(),[h,j]=x.useState(t),a=se({name:"",status:"all",startDate:null,endDate:null});x.useEffect(()=>{j(t)},[t]);const u=ae(a.state.startDate,a.state.endDate),c=ke({inputData:h,comparator:me(s.order,s.orderBy),filters:a.state,dateError:u}),Y=ue(c,s.page,s.rowsPerPage),Z=x.useCallback(d=>{r(d),m.onToggle()},[Y.length,s,h]),R=!!a.state.name||a.state.status!=="all"||!!a.state.startDate&&!!a.state.endDate,_=!c.length&&R||!c.length,y=Q({queryKey:["products"],queryFn:async()=>{const{data:d}=await T.get(w.products.list);return d}});return y.isPending||y.isLoading?e.jsx(V,{}):y.isError?e.jsx($,{route:S.dashboard.products.root}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{maxWidth:"xl",children:e.jsxs(p,{spacing:3,children:[e.jsx(de,{links:[{name:`${n("stockView.breadCrumbsPageRootTitle")}`,href:S.dashboard.root},{name:`${n("stockView.breadCrumbsParentPageTitle")}`,href:S.dashboard.product.root},{name:`${n("stockView.breadCrumbsPageTitle")}`}]}),e.jsxs(re,{children:[e.jsx(Ie,{filters:a,onResetPage:s.onResetPage,dateError:u}),R&&e.jsx(we,{filters:a,totalResults:c.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(P,{sx:{position:"relative"},children:[e.jsx(ye,{dense:s.dense,numSelected:s.selected.length,rowCount:c.length,onSelectAllRows:d=>s.onSelectAllRows(d,c.map(v=>v.id)),action:e.jsx(oe,{title:"Delete",children:e.jsx(ie,{color:"primary",onClick:g.onTrue,children:e.jsx(I,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(le,{sx:{minHeight:200},children:e.jsxs(be,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(fe,{order:s.order,orderBy:s.orderBy,headLabel:i,rowCount:c.length}),c.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map((d,v)=>e.jsx(ve,{index:s.page*s.rowsPerPage+v+1,row:d,onEditRow:()=>Z(d),selected:s.selected.includes(d.id)},d.id)),e.jsxs(Pe,{children:[e.jsx(ge,{height:s.dense?56:76,emptyRows:pe(s.page,s.rowsPerPage,c.length)}),e.jsx(xe,{notFound:_})]})]})})]}),e.jsx(Se,{page:s.page,dense:s.dense,count:c.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})]})}),l.value&&e.jsx(De,{productsList:y.data,open:l.value,onClose:l.onFalse}),e.jsx(Fe,{stock:o,open:m.value,onClose:m.onFalse})]})}function ke({inputData:t,comparator:s,filters:n}){const{name:i}=n,o=t.map((r,l)=>[r,l]);return o.sort((r,l)=>{const m=s(r[0],l[0]);return m!==0?m:r[1]-l[1]}),t=o.map(r=>r[0]),i&&(t=t.filter(r=>r.id.toString().toLowerCase().indexOf(i.toLowerCase())!==-1||r.name.toLowerCase().indexOf(i.toLowerCase())!==-1)),t}const Be={title:`Product Stock | Dashboard - ${f.site.name}`};function $t(){const t=Q({queryKey:["products-stock"],queryFn:async()=>{const{data:s}=await T.get(w.products.stock);return s}});return t.isPending||t.isLoading?e.jsx(V,{}):t.isError?e.jsx($,{route:S.dashboard.products.root}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{children:e.jsxs("title",{children:[" ",Be.title]})}),e.jsx(Re,{stocks:t.data})]})}export{$t as default};
