import{w as k,bG as I,j as e,L as F,aL as E,du as A,y as N,I as j,dz as q,bI as O,bJ as m,e as S,r as d,S as K,ep as z,o as H,dC as Q,eq as G,p as g,dL as M,eb as J,G as C,R as V,aF as W,B as U,dB as _,er as $,dM as D,dK as R,dN as X,ef as Y,H as Z,C as ee}from"./index-DLwkls4m.js";import{u as te,E as ae}from"./error-block-C30yYsJ6.js";import{C as se}from"./custom-breadcrumbs-RrbSlijf.js";import{u as ne,g as oe,r as re,T as le,a as ie,e as de}from"./table-selected-action-Cl0zAfF3.js";import{T as ce}from"./table-no-data-CB8dFdIo.js";import{T as ue,a as he,b as me,c as pe}from"./table-head-custom-CxYlI1wv.js";import{T as xe}from"./table-pagination-custom-I1sFEO4C.js";import{C as ge}from"./confirm-dialog-B-zGEUbG.js";import{T as x}from"./TableCell-BbkjnoOj.js";import{T as je}from"./TextField-B1Cg5HmH.js";import{I as be}from"./InputAdornment-MgApCcj1.js";import{S as Ce}from"./Select-CL6BPU1z.js";import{F as we,a as w,c as P}from"./filters-result-CVVYvX3A.js";import{C as f}from"./Chip-BuK2Jq4O.js";import{u as Pe}from"./useMutation-Xh_zmf_Z.js";import"./incrementer-button-BDjv6AEm.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./Checkbox-ByD5WW94.js";import"./empty-content-G2WqpuZZ.js";import"./TablePagination-3k_k7Jb5.js";import"./LastPage-CCIWXV8U.js";import"./InputBase-DNJV1MQo.js";import"./formControlState-Dq1zat_P.js";import"./utils-DoM3o7-Q.js";import"./FormControlLabel-7I2uQbxz.js";import"./DialogContent-C4fMf3p5.js";import"./DialogTitle-CwWzRiyw.js";import"./FormControl-SJOyIv6-.js";import"./InputLabel-fkQY0vwD.js";import"./FormLabel-DbiGIO3x.js";import"./FormHelperText-BVmW-5Ni.js";import"./Menu-D_Q_wpzJ.js";function fe({row:t,selected:a,onViewRow:r,onEditRow:c,onSelectRow:u,onDeleteRow:n}){var o,h;const i=k(),s=I(),p=e.jsxs(ue,{hover:!0,selected:a,children:[e.jsx(x,{children:e.jsxs(F,{color:"inherit",onClick:r,underline:"always",sx:{cursor:"pointer"},children:["PLN-",t.id]})}),e.jsx(x,{children:E(t.planDate)}),e.jsx(x,{children:t.product.name}),e.jsxs(x,{align:"center",children:[" ",t.quantity," "]}),e.jsx(x,{children:e.jsx(A,{variant:"soft",color:t.status==="Ready"&&"success"||t.status==="Pending"&&"info"||t.status==="ProcessingA"&&"warning"||t.status==="ProcessingB"&&"error"||"default",children:t.status})}),e.jsxs(x,{children:[(o=t.createdBy)==null?void 0:o.firstName," ",(h=t.createdBy)==null?void 0:h.lastName]}),e.jsx(x,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:e.jsx(N,{color:s.open?"inherit":"default",onClick:s.onOpen,children:e.jsx(j,{icon:"eva:more-vertical-fill"})})})]});return e.jsxs(e.Fragment,{children:[p,e.jsx(q,{open:s.open,anchorEl:s.anchorEl,onClose:s.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(O,{children:[e.jsxs(m,{onClick:()=>{r(),s.onClose()},children:[e.jsx(j,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(m,{onClick:()=>{c(),s.onClose()},children:[e.jsx(j,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(m,{onClick:()=>{i.onTrue(),s.onClose()},sx:{color:"error.main"},children:[e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(ge,{open:i.value,onClose:i.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(S,{variant:"contained",color:"error",onClick:n,children:"Delete"})})]})}function ye({filters:t,onResetPage:a}){const[r,c]=d.useState("all"),u=d.useCallback(i=>{a(),t.setState({name:i.target.value})},[t,a]),n=d.useCallback(i=>{a(),t.setState({status:i.target.value}),c(i.target.value)},[t,a]);return e.jsxs(K,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:[e.jsx(je,{sx:{width:420},value:t.state.name,onChange:u,placeholder:"Search by product or plan number...",InputProps:{startAdornment:e.jsx(be,{position:"start",children:e.jsx(j,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),e.jsxs(Ce,{sx:{width:420,textTransform:"capitalize"},value:r,onChange:n,children:[e.jsx(m,{value:"all",children:"All Plans"}),e.jsx(m,{value:"Pending",children:"Pending"}),e.jsx(m,{value:"ProcessingA",children:"Processing-A"}),e.jsx(m,{value:"ProcessingB",children:"Processing-B"}),e.jsx(m,{value:"Ready",children:"Ready"})]})]})}function Se({filters:t,totalResults:a,onResetPage:r,sx:c}){const u=d.useCallback(()=>{r(),t.setState({name:""})},[t,r]),n=d.useCallback(()=>{r(),t.setState({status:"all"})},[t,r]),i=d.useCallback(()=>{r(),t.setState({startDate:null,endDate:null})},[t,r]),s=d.useCallback(()=>{r(),t.onResetState()},[t,r]);return e.jsxs(we,{totalResults:a,onReset:s,sx:c,children:[e.jsx(w,{label:"Status:",isShow:t.state.status!=="all",children:e.jsx(f,{...P,label:t.state.status,onDelete:n,sx:{textTransform:"capitalize"}})}),e.jsx(w,{label:"Date:",isShow:!!(t.state.startDate&&t.state.endDate),children:e.jsx(f,{...P,label:z(t.state.startDate,t.state.endDate),onDelete:i})}),e.jsx(w,{label:"Keyword:",isShow:!!t.state.name,children:e.jsx(f,{...P,label:t.state.name,onDelete:u})})]})}const De=[{id:"planId",label:"Plan ID",width:60},{id:"planDate",label:"Plan Date",width:140},{id:"product",label:"Product",width:140},{id:"quantity",label:"Quantity",width:120,align:"center"},{id:"status",label:"Status",width:140},{id:"createdBy",label:"Created By",width:140},{id:"",width:88}];function Re({plans:t}){const a=ne({defaultOrderBy:"planId"}),r=H(),[c,u]=d.useState(t),n=Q({name:"",status:"all",startDate:null,endDate:null});d.useEffect(()=>{u(t)},[t]);const i=G(n.state.startDate,n.state.endDate),s=ve({inputData:c,comparator:oe(a.order,a.orderBy),filters:n.state,dateError:i}),p=re(s,a.page,a.rowsPerPage),o=!!n.state.name||n.state.status!=="all"||!!n.state.startDate&&!!n.state.endDate,h=!s.length&&o||!s.length,b=d.useCallback(l=>{r.push(g.dashboard.plan.details(l))},[r]),v=d.useCallback(l=>{r.push(g.dashboard.plan.edit(l))},[r]),y=M(),{mutate:T}=Pe({mutationFn:l=>D.delete(R.plan.delete+l),onSuccess:async()=>{const l=c.filter(L=>L.id!==id);X.success("Delete success!"),u(l),a.onUpdatePageDeleteRow(p.length)},onSettled:async()=>{await y.invalidateQueries({queryKey:["plans"]}),await y.invalidateQueries({queryKey:["plans-status"]})},onError:()=>{}}),B=d.useCallback(l=>{T(l)},[p.length,a,c]);return e.jsx(J,{maxWidth:"xl",children:e.jsxs(C,{container:!0,spacing:3,children:[e.jsx(C,{xs:12,md:12,children:e.jsx(se,{links:[{name:"Dashboard",href:g.dashboard.root},{name:"Plan",href:g.dashboard.plan.root},{name:"List"}],action:e.jsx(S,{component:V,href:g.dashboard.plan.new,variant:"contained",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),children:"Add New Plan"})})}),e.jsx(C,{xs:12,md:12,children:e.jsxs(W,{children:[e.jsx(ye,{filters:n,onResetPage:a.onResetPage,dateError:i}),o&&e.jsx(Se,{filters:n,totalResults:s.length,onResetPage:a.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(U,{sx:{position:"relative"},children:[e.jsx(le,{dense:a.dense,numSelected:a.selected.length,rowCount:s.length}),e.jsx(_,{sx:{minHeight:444},children:e.jsxs(he,{size:a.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(me,{order:a.order,orderBy:a.orderBy,headLabel:De,rowCount:s.length}),e.jsxs(pe,{children:[s.slice(a.page*a.rowsPerPage,a.page*a.rowsPerPage+a.rowsPerPage).map(l=>e.jsx(fe,{row:l,selected:a.selected.includes(l.id),onSelectRow:()=>a.onSelectRow(l.id),onDeleteRow:()=>B(l.id),onViewRow:()=>b(l.id),onEditRow:()=>v(l.id)},l.id)),e.jsx(ie,{height:a.dense?56:76,emptyRows:de(a.page,a.rowsPerPage,s.length)}),e.jsx(ce,{notFound:h})]})]})})]}),e.jsx(xe,{page:a.page,dense:a.dense,count:s.length,rowsPerPage:a.rowsPerPage,onPageChange:a.onChangePage,onChangeDense:a.onChangeDense,onRowsPerPageChange:a.onChangeRowsPerPage})]})})]})})}function ve({inputData:t,comparator:a,filters:r,dateError:c}){const{status:u,name:n,startDate:i,endDate:s}=r,p=t.map((o,h)=>[o,h]);return p.sort((o,h)=>{const b=a(o[0],h[0]);return b!==0?b:o[1]-h[1]}),t=p.map(o=>o[0]),n&&(t=t.filter(o=>o.id.toString().toLowerCase().indexOf(n.toLowerCase())!==-1||o.product.name.toLowerCase().indexOf(n.toLowerCase())!==-1||o.createdBy.firstName.toLowerCase().indexOf(n.toLowerCase())!==-1||o.createdBy.lastName.toLowerCase().indexOf(n.toLowerCase())!==-1)),u!=="all"&&(t=t.filter(o=>o.status===u)),c||i&&s&&(t=t.filter(o=>$(o.createdAt,i,s))),t}const Te={title:`Plan list | Dashboard - ${ee.site.name}`};function dt(){const t=te({queryKey:["plans"],queryFn:async()=>(await D.get(R.plan.list)).data});return t.isPending||t.isLoading?e.jsx(Y,{}):t.isError?e.jsx(ae,{route:g.dashboard.plan.root}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{children:e.jsxs("title",{children:[" ",Te.title]})}),e.jsx(Re,{plans:t.data})]})}export{dt as default};
