import{w as v,bI as N,j as e,L as H,S as b,A as K,B as C,aM as D,aN as Q,dw as W,y as I,I as j,dl as G,aD as V,dB as $,bK as J,bL as y,e as k,r as x,o as U,b as _,dE as X,er as Y,dN as Z,p as f,ed as z,G as g,R as ee,eg as P,aH as te,dD as re,es as se,dO as S,dM as T,dP as ae,eh as oe,H as ne,C as ie}from"./index-DxrsDIwY.js";import{u as L,E as le}from"./error-block-Cg6RpAZK.js";import{u as de}from"./useMutation-f5nVFG-s.js";import{C as ce}from"./custom-breadcrumbs-Dd3lNCwD.js";import{u as pe,g as me,r as he,T as ue,a as xe,e as ge}from"./table-selected-action-DOkqk6zb.js";import{T as je}from"./table-no-data-DzXXEfeL.js";import{T as O,a as ye,b as fe,c as be}from"./table-head-custom-w-4MLJlt.js";import{T as Ce}from"./table-pagination-custom-BDQuCrzU.js";import{A as w}from"./app-widget-summary-DVpEJdU4.js";import{b as A}from"./format-number-DtiborQ_.js";import{C as Pe}from"./confirm-dialog-tDH-oZWO.js";import{T as h}from"./TableCell-CJNt5t20.js";import{T as we}from"./TextField-C2VP4uls.js";import{I as ve}from"./InputAdornment-D2FMqto9.js";import{S as Se}from"./Select-eQVewVvt.js";import{O as Te}from"./order-table-filters-result-Gx0MTl9V.js";import"./incrementer-button-BtQ5_PmY.js";import"./order-payment-details-dialog-PxDq2EkD.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./Checkbox-ylG2wecL.js";import"./empty-content-Der9frKm.js";import"./TablePagination-Bol3AgoD.js";import"./LastPage-Ct_4tubK.js";import"./InputBase-B9Lf9cs-.js";import"./formControlState-Dq1zat_P.js";import"./utils-DoM3o7-Q.js";import"./FormControlLabel-DKxiCaQc.js";import"./use-chart-CgiPk8RW.js";import"./chart-legends-DUFKcd5Q.js";import"./index-wGJ5bMai.js";import"./DialogContent-262oYdAn.js";import"./DialogTitle-C_65wNCI.js";import"./FormControl-CC-u2HkW.js";import"./InputLabel-CQVMsmZY.js";import"./FormLabel-EgLeF9WB.js";import"./FormHelperText-DMsDqsw2.js";import"./Menu-C6l2dIf8.js";import"./filters-result-Br0EFulp.js";import"./Chip-Bq-6ExUD.js";import"./form-provider-DzAJAZLb.js";import"./countries-DSLisFCy.js";import"./upload-avatar-4NlzUb0f.js";import"./image-yj0A9F1D.js";import"./fields-Dsl2Pqgx.js";import"./Rating-FZfLYAhV.js";import"./visuallyHidden-Dan1xhjv.js";import"./editor-Dqkfe7Lc.js";import"./index-BNV8Ha3a.js";import"./Slider-R3UsSTxo.js";import"./RadioGroup-IW7zsT63.js";import"./FormGroup-69w0Ctto.js";import"./Autocomplete-DQd8H5I4.js";import"./country-select-6tMU1vH_.js";import"./DatePicker-CHBP34D3.js";import"./ListItem-Cbx-5wAg.js";import"./MobileDateTimePicker-UWVv-JJA.js";import"./schema-helper-Dd4Kd2WC.js";import"./LoadingButton-BPYHnDdd.js";import"./CircularProgress-CRSD6Bm4.js";function Re({row:t,selected:o,onViewRow:r,onSelectRow:u,onDeleteRow:p}){const l=v(),i=v(),n=N(),c=e.jsxs(O,{hover:!0,selected:o,children:[e.jsx(h,{children:e.jsx(H,{color:"inherit",onClick:r,underline:"always",sx:{cursor:"pointer"},children:t.id})}),e.jsx(h,{children:e.jsxs(b,{spacing:2,direction:"row",alignItems:"center",children:[e.jsx(K,{alt:t.customer.name,src:t.customer.avatar}),e.jsxs(b,{sx:{typography:"body2",flex:"1 1 auto",alignItems:"flex-start"},children:[e.jsx(C,{component:"span",children:t.customer.name}),e.jsx(C,{component:"span",sx:{color:"text.disabled"},children:t.customer.email})]})]})}),e.jsx(h,{children:e.jsx(D,{primary:Q(t.orderDate),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),e.jsxs(h,{align:"center",children:[" ",t.totalOrderAmount," "]}),e.jsxs(h,{children:[" ",A(t.totalOrderAmount)," "]}),e.jsx(h,{children:e.jsx(W,{variant:"soft",color:t.status==="Ready"&&"info"||t.status==="InProcess"&&"warning"||t.status==="Delivered"&&"success"||"default",children:t.status})}),e.jsxs(h,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[e.jsx(I,{color:i.value?"inherit":"default",onClick:i.onToggle,sx:{...i.value&&{bgcolor:"action.hover"}},children:e.jsx(j,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(I,{color:n.open?"inherit":"default",onClick:n.onOpen,children:e.jsx(j,{icon:"eva:more-vertical-fill"})})]})]}),a=e.jsx(O,{children:e.jsx(h,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(G,{in:i.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(V,{sx:{m:1.5},children:t.productToOrder.map(d=>e.jsxs(b,{direction:"row",alignItems:"center",sx:{p:m=>m.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:m=>`solid 2px ${m.vars.palette.background.neutral}`}},children:[e.jsx(D,{primary:d.product.name,secondary:d.sku,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs("div",{children:["x",d.quantity," "]}),e.jsx(C,{sx:{width:110,textAlign:"right"},children:A(d.product.price)})]},d.id))})})})});return e.jsxs(e.Fragment,{children:[c,a,e.jsx($,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(J,{children:[e.jsxs(y,{onClick:()=>{r(),n.onClose()},children:[e.jsx(j,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(y,{onClick:()=>{l.onTrue(),n.onClose()},sx:{color:"error.main"},children:[e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(Pe,{open:l.value,onClose:l.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(k,{variant:"contained",color:"error",onClick:p,children:"Delete"})})]})}function De({filters:t,onResetPage:o}){const[r,u]=x.useState("all"),p=x.useCallback(i=>{o(),t.setState({name:i.target.value})},[t,o]),l=x.useCallback(i=>{o(),t.setState({status:i.target.value}),u(i.target.value)},[t,o]);return e.jsxs(b,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:[e.jsx(we,{sx:{width:420},value:t.state.name,onChange:p,placeholder:"Search customer or order number...",InputProps:{startAdornment:e.jsx(ve,{position:"start",children:e.jsx(j,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),e.jsxs(Se,{sx:{width:420,textTransform:"capitalize"},value:r,onChange:l,children:[e.jsx(y,{value:"all",children:"All Orders"}),e.jsx(y,{value:"InProcess",children:"Processing"}),e.jsx(y,{value:"Ready",children:"Ready To Deliver"}),e.jsx(y,{value:"Delivered",children:"Delivered"})]})]})}const Ie=[{id:"orderNumber",label:"#",width:88},{id:"name",label:"Customer"},{id:"createdAt",label:"Date",width:140},{id:"totalQuantity",label:"Items",width:120,align:"center"},{id:"totalAmount",label:"Price",width:140},{id:"status",label:"Status",width:110},{id:"",width:88}];function Le({orders:t,analytics:o}){const r=pe({defaultOrderBy:"orderId"}),u=U(),p=_();v();const[l,i]=x.useState(()=>t),n=X({name:"",status:"all",startDate:null,endDate:null});x.useEffect(()=>{i(t)},[t]);const c=Y(n.state.startDate,n.state.endDate),a=Oe({inputData:l,comparator:me(r.order,r.orderBy),filters:n.state,dateError:c}),d=he(a,r.page,r.rowsPerPage),m=!!n.state.name||n.state.status!=="all"||!!n.state.startDate&&!!n.state.endDate,M=!a.length&&m||!a.length,R=Z(),{mutate:B}=de({mutationFn:s=>S.delete(T.order.delete+s),onSuccess:async()=>{const s=l.filter(q=>q.id!==id);ae.success("Delete success!"),i(s),r.onUpdatePageDeleteRow(d.length)},onSettled:async()=>{await R.invalidateQueries({queryKey:["orders"]}),await R.invalidateQueries({queryKey:["orders","analytics"]})},onError:()=>{}}),E=x.useCallback(s=>{B(s)},[d.length,r,l]),F=x.useCallback(s=>{u.push(f.dashboard.order.details(s))},[u]);return e.jsx(z,{maxWidth:"xl",children:e.jsxs(g,{container:!0,spacing:3,children:[e.jsx(g,{xs:12,md:12,children:e.jsx(ce,{links:[{name:"Dashboard",href:f.dashboard.root},{name:"Order",href:f.dashboard.order.root},{name:"List"}],action:e.jsx(k,{component:ee,href:f.dashboard.order.new,variant:"contained",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),children:"New Order"})})}),e.jsx(g,{xs:12,md:4,children:e.jsx(w,{title:"All Orders",total:t.length,chart:{categories:o.data.lastSixMonth.map(s=>P(s==null?void 0:s.inMonth)),series:o.data.lastSixMonth.map(s=>s==null?void 0:s.ClaimsPerMonth)}})}),e.jsx(g,{xs:12,md:4,children:e.jsx(w,{title:"Processing Order",total:o.data.analytics.InProcess,chart:{colors:[p.vars.palette.info.main],categories:o.data.inProcessLastSixMonth.map(s=>P(s==null?void 0:s.inMonth)),series:o.data.inProcessLastSixMonth.map(s=>s==null?void 0:s.ClaimsPerMonth)}})}),e.jsx(g,{xs:12,md:4,children:e.jsx(w,{title:"Delivered",total:o.data.analytics.Delivered,chart:{colors:[p.vars.palette.error.main],categories:o.data.deliveredLastSixMonth.map(s=>P(s==null?void 0:s.inMonth)),series:o.data.deliveredLastSixMonth.map(s=>s==null?void 0:s.ClaimsPerMonth)}})}),e.jsx(g,{xs:12,md:12,children:e.jsxs(te,{children:[e.jsx(De,{filters:n,onResetPage:r.onResetPage,dateError:c}),m&&e.jsx(Te,{filters:n,totalResults:a.length,onResetPage:r.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(C,{sx:{position:"relative"},children:[e.jsx(ue,{dense:r.dense,numSelected:r.selected.length,rowCount:a.length}),e.jsx(re,{sx:{minHeight:444},children:e.jsxs(ye,{size:r.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(fe,{order:r.order,orderBy:r.orderBy,headLabel:Ie,rowCount:a.length}),e.jsxs(be,{children:[a.slice(r.page*r.rowsPerPage,r.page*r.rowsPerPage+r.rowsPerPage).map(s=>e.jsx(Re,{row:s,selected:r.selected.includes(s.id),onSelectRow:()=>r.onSelectRow(s.id),onDeleteRow:()=>E(s.id),onViewRow:()=>F(s.id)},s.id)),e.jsx(xe,{height:r.dense?56:76,emptyRows:ge(r.page,r.rowsPerPage,a.length)}),e.jsx(je,{notFound:M})]})]})})]}),e.jsx(Ce,{page:r.page,dense:r.dense,count:a.length,rowsPerPage:r.rowsPerPage,onPageChange:r.onChangePage,onChangeDense:r.onChangeDense,onRowsPerPageChange:r.onChangeRowsPerPage})]})})]})})}function Oe({inputData:t,comparator:o,filters:r,dateError:u}){const{status:p,name:l,startDate:i,endDate:n}=r,c=t==null?void 0:t.map((a,d)=>[a,d]);return c==null||c.sort((a,d)=>{const m=o(a[0],d[0]);return m!==0?m:a[1]-d[1]}),t=c==null?void 0:c.map(a=>a[0]),l&&(t=t.filter(a=>a.id.toString().toLowerCase().indexOf(l.toLowerCase())!==-1||a.customer.name.toLowerCase().indexOf(l.toLowerCase())!==-1||a.customer.email.toLowerCase().indexOf(l.toLowerCase())!==-1)),p!=="all"&&(t=t.filter(a=>a.status===p)),u||i&&n&&(t=t.filter(a=>se(a.createTime,i,n))),t}const Ae={title:`Order list | Dashboard - ${ie.site.name}`};function Ht(){const t=L({queryKey:["orders"],queryFn:async()=>{const{data:r}=await S.get(T.order.list);return r}}),o=L({queryKey:["orders","analytics"],queryFn:async()=>{const{data:r}=await S.get(T.order.analytics);return r}});return o.isLoading||t.isLoading?e.jsx(oe,{}):t.isError||o.isError?e.jsx(le,{route:f.dashboard.order.root}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{children:e.jsxs("title",{children:[" ",Ae.title]})}),e.jsx(Le,{orders:t.data,analytics:o})]})}export{Ht as default};
