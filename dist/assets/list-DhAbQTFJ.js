import{r as h,o as O,bO as $,l as W,p as b,j as e,S as R,A as G,C as B,B as P,ds as J,w as L,I as u,dh as X,az as Y,e as F,ew as Z,dw as ee,bQ as te,em as D,bR as _,dz as se,eo as re,dI as oe,e8 as ae,G as k,R as ne,aD as ie,cM as le,dy as de,ep as ce,dJ as w,dH as H,dK as pe,ec as ue,H as me}from"./index-CwDFRBrV.js";import{u as K,E as he}from"./error-block-po56rbru.js";import"./product-review-new-form-uNzLXJP1.js";import"./index-D0bnvCpt.js";import"./image-D_atTa8y.js";import"./color-preview-BkPzEPnn.js";import{u as xe}from"./useMutation-CkTHNDXi.js";import{C as ge}from"./custom-breadcrumbs-tdSVNm9k.js";import{P as I}from"./permission-access-controller-7g9WRehD.js";import{g as je,r as fe,T as Pe,a as be,e as Ce}from"./table-selected-action-QvRRh6wE.js";import{u as Te}from"./use-table-keuem4Xf.js";import{T as ye}from"./table-no-data-C6vJju_i.js";import{T as Q,a as Re,b as De,c as Ie}from"./table-head-custom-0GEy35EZ.js";import{T as ve}from"./table-pagination-custom-B9zCiItL.js";import{b as E}from"./format-number-Ch538jHW.js";import{C as Se}from"./confirm-dialog-CzBLlYBs.js";import{T as f}from"./TableCell-D5WBIyLx.js";import{T as Ae}from"./TextField-CHPZUTqF.js";import{I as ke}from"./InputAdornment-DEbikF0Z.js";import{P as Ee}from"./product-table-filters-result-JvB5GNoX.js";import"./form-provider-C8IltM3z.js";import"./editor-eNq_8vRL.js";import"./incrementer-button-XoeqYN-8.js";import"./carousel-progress-bar-B0rLj09I.js";import"./html-to-markdown-Cp8eP2jA.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./product-Item-button-BlqLfIqn.js";import"./upload-avatar-Bqr4alq-.js";import"./FormHelperText-Bj0ulyme.js";import"./formControlState-Dq1zat_P.js";import"./index-DM_1Xs39.js";import"./DialogContent-DQegyPQl.js";import"./DialogTitle-B_p_zW0I.js";import"./LoadingButton-BM8YRB0z.js";import"./CircularProgress-f16JZADw.js";import"./AccordionSummary-DL212k_U.js";import"./Checkbox-Cm203eFc.js";import"./empty-content-LLazwqBz.js";import"./TablePagination-CxmbsKV-.js";import"./KeyboardArrowRight-DJc55wOs.js";import"./LastPage-DeJVGkdu.js";import"./Select-C_u8K-J_.js";import"./Menu-B_jyagBS.js";import"./utils-DoM3o7-Q.js";import"./InputBase-Bn2YUrmy.js";import"./FormControlLabel-HvXv_MVH.js";import"./FormControl-yMCQcYEm.js";import"./InputLabel-CKyW86qE.js";import"./FormLabel-BavGwz4i.js";import"./filters-result-DEYNNCA9.js";import"./Chip-BadVSybg.js";import"./Rating-C4JeVFy2.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-Brhk4K8C.js";import"./RadioGroup-c9F65hOo.js";import"./FormGroup-DOTqUq1f.js";import"./countries-DSLisFCy.js";import"./Autocomplete-CmyTYkoe.js";import"./country-select-DGH5tKc3.js";import"./DatePicker-DijfO7Ga.js";import"./ListItem-M-XT_teX.js";import"./MobileDateTimePicker-DjMxEeI_.js";import"./Tabs-BdVdVdbh.js";import"./index-BP8NwpZp.js";const Oe=({row:t,index:i,selected:s,onDeleteRow:x,onEditRow:g})=>{var T;const[p,C]=h.useState((t==null?void 0:t.productToOrder.length)>0),n=O(),d=O(),r=$(),l=W(),j=h.useCallback(o=>{l.push(b.dashboard.order.details(o))},[l]),v=h.useCallback(o=>{l.push(b.dashboard.product.details(o))},[l]),S=e.jsxs(Q,{hover:!0,selected:s,children:[e.jsx(f,{children:i||(t==null?void 0:t.id)}),e.jsx(f,{children:e.jsxs(R,{spacing:2,direction:"row",alignItems:"center",children:[e.jsx(G,{alt:t==null?void 0:t.name,src:B.site.serverFileHost+((t==null?void 0:t.image)||B.site.defaultImgPlaceHolder)}),e.jsx(P,{component:"span",children:t==null?void 0:t.name})]})}),e.jsx(f,{children:E(t==null?void 0:t.price)}),e.jsxs(f,{align:"center",children:[" ",((T=t==null?void 0:t.stock)==null?void 0:T.quantity)||"0"," "]}),e.jsx(f,{children:e.jsx(J,{variant:"soft",color:t.isActive===!0&&"success"||t.isActive===!1&&"error"||"default",children:t!=null&&t.isActive?"ACTIVE":"INACTIVE"})}),e.jsxs(f,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[p&&e.jsx(L,{color:d.value?"inherit":"default",onClick:d.onToggle,sx:{...d.value&&{bgcolor:"action.hover"}},children:e.jsx(u,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(L,{color:r.open?"inherit":"default",onClick:r.onOpen,children:e.jsx(u,{icon:"eva:more-vertical-fill"})})]})]}),A=e.jsx(Q,{children:e.jsx(f,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(X,{in:d.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(Y,{sx:{m:1.5},children:t==null?void 0:t.productToOrder.map((o,a)=>{var m,y,N,q,z,M,U,V;return a===5?e.jsx(R,{alignItems:"flex-end",sx:{p:c=>c.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:c=>`solid 2px ${c.vars.palette.background.neutral}`}},children:e.jsx(F,{variant:"contained",size:"small",endIcon:e.jsx(u,{icon:"heroicons-outline:external-link"}),onClick:()=>{v(t.id)},children:"See More"})},o.id):e.jsxs(R,{direction:"row",alignItems:"center",sx:{p:c=>c.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:c=>`solid 2px ${c.vars.palette.background.neutral}`}},children:[e.jsxs(P,{onClick:()=>{var c;return j((c=o==null?void 0:o.order)==null?void 0:c.id)},sx:{width:240,display:"flex",gap:1,alignItems:"center",cursor:"pointer",marginRight:5},children:[e.jsx(u,{icon:"heroicons-outline:external-link"}),e.jsx("span",{children:(m=o==null?void 0:o.order)==null?void 0:m.ref})]}),e.jsx(P,{sx:{width:"100%",display:"flex",gap:1,alignItems:"center"},children:e.jsx("span",{children:(N=(y=o.order)==null?void 0:y.customer)==null?void 0:N.name})}),e.jsxs(P,{sx:{width:240,color:"error.main",fontWeight:"bold"},children:["x",o.quantity," ",e.jsx("span",{style:{color:"#000",fontWeight:"400"},children:`(${E(o==null?void 0:o.snapshotProductPrice)})`})]}),e.jsx(P,{sx:{width:200,textAlign:"right"},children:(q=o.order)==null?void 0:q.status}),e.jsx(P,{sx:{width:300,textAlign:"right"},children:E(Z(((z=o.order)==null?void 0:z.totalOrderAmount)-((M=o.order)==null?void 0:M.totalOrderAmount)*(((U=o.order)==null?void 0:U.discount)/100),(V=o.order)==null?void 0:V.snapshotTaxPercentage))||"-"})]},o.id)})})})})});return e.jsxs(e.Fragment,{children:[S,A,e.jsx(ee,{open:r.open,anchorEl:r.anchorEl,onClose:r.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(te,{children:[e.jsx(I,{permission:D.EDIT_PRODUCT,children:e.jsxs(_,{onClick:()=>{g(t.id),r.onClose()},children:[e.jsx(u,{icon:"solar:pen-bold"}),"Edit"]})}),e.jsx(I,{permission:D.DELETE_PRODUCT,children:e.jsxs(_,{onClick:()=>{n.onTrue(),r.onClose()},sx:{color:"error.main"},children:[e.jsx(u,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})})]})}),e.jsx(Se,{open:n.value,onClose:n.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(F,{variant:"contained",color:"error",onClick:x,children:"Delete"})})]})};function Be({filters:t,onResetPage:i,options:s}){const x=h.useCallback(g=>{i(),t.setState({name:g.target.value})},[t,i]);return e.jsx(R,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(Ae,{sx:{width:420},value:t.state.name,onChange:x,placeholder:"Search by Product Name or Ref",InputProps:{startAdornment:e.jsx(ke,{position:"start",children:e.jsx(u,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}const Le=[{id:"productId",label:"No.",width:80},{id:"productName",label:"Product Name"},{id:"productPrice",label:"Product Price",width:200},{id:"stock",label:"Stock",align:"center"},{id:"status",label:"Status",width:100},{id:"",width:88}];function Fe({products:t,taxPercentage:i}){const s=Te({defaultOrderBy:"planId"}),x=O(),g=W(),[p,C]=h.useState(t),n=se({name:"",status:"all",startDate:null,endDate:null});h.useEffect(()=>{C(t)},[t]);const d=re(n.state.startDate,n.state.endDate),r=we({inputData:p,comparator:je(s.order,s.orderBy),filters:n.state,dateError:d}),l=fe(r,s.page,s.rowsPerPage),j=!!n.state.name||n.state.status!=="all"||!!n.state.startDate&&!!n.state.endDate,v=!r.length&&j||!r.length,S=h.useCallback(a=>{o(a)},[l.length,s,p]),A=h.useCallback(a=>{g.push(b.dashboard.product.edit(a))},[g]),T=oe(),{mutate:o}=xe({mutationFn:a=>w.delete(H.products.delete+a),onSuccess:async a=>{const m=p.filter(y=>y.id!==a);pe.success("Delete success!"),C(m),s.onUpdatePageDeleteRow(l.length)},onSettled:async()=>{await T.invalidateQueries({queryKey:["products"]})},onError:()=>{}});return e.jsx(ae,{maxWidth:"xl",children:e.jsxs(k,{container:!0,spacing:3,children:[e.jsx(k,{xs:12,md:12,children:e.jsx(ge,{links:[{name:"Dashboard",href:b.dashboard.root},{name:"Product",href:b.dashboard.plan.root},{name:"List"}],action:e.jsx(I,{permission:D.ADD_PRODUCT,children:e.jsx(F,{component:ne,href:b.dashboard.product.new,variant:"contained",startIcon:e.jsx(u,{icon:"mingcute:add-line"}),children:"Add New Product"})})})}),e.jsx(I,{permission:D.LIST_PRODUCT,children:e.jsx(k,{xs:12,md:12,children:e.jsxs(ie,{children:[e.jsx(Be,{filters:n,onResetPage:s.onResetPage,dateError:d}),j&&e.jsx(Ee,{filters:n,totalResults:r.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(P,{sx:{position:"relative"},children:[e.jsx(Pe,{dense:s.dense,numSelected:s.selected.length,rowCount:r.length,onSelectAllRows:a=>s.onSelectAllRows(a,r.map(m=>m.id)),action:e.jsx(le,{title:"Delete",children:e.jsx(L,{color:"primary",onClick:x.onTrue,children:e.jsx(u,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(de,{sx:{minHeight:444},children:e.jsxs(Re,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(De,{order:s.order,orderBy:s.orderBy,headLabel:Le,rowCount:r.length,numSelected:s.selected.length,onSort:s.onSort}),e.jsxs(Ie,{children:[r.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map((a,m)=>e.jsx(Oe,{row:a,index:s.page*s.rowsPerPage+m+1,selected:s.selected.includes(a.id),onEditRow:()=>A(a.id),onDeleteRow:()=>S(a.id),taxPercentage:i},a.id)),e.jsx(be,{height:s.dense?56:76,emptyRows:Ce(s.page,s.rowsPerPage,r.length)}),e.jsx(ye,{notFound:v})]})]})})]}),e.jsx(ve,{page:s.page,dense:s.dense,count:r.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})})})]})})}function we({inputData:t,comparator:i,filters:s,dateError:x}){const{status:g,name:p,startDate:C,endDate:n}=s,d=t.map((r,l)=>[r,l]);return d.sort((r,l)=>{const j=i(r[0],l[0]);return j!==0?j:r[1]-l[1]}),t=d.map(r=>r[0]),p&&(t=t.filter(r=>r.id.toString().toLowerCase().indexOf(p.toLowerCase())!==-1||r.name.toLowerCase().indexOf(p.toLowerCase())!==-1)),x||C&&n&&(t=t.filter(r=>ce(r.createdAt,C,n))),t}const He={title:`Product list | Dashboard - ${B.site.name}`};function Jt(){const t=K({queryKey:["products"],queryFn:async()=>{const{data:s}=await w.get(H.products.list);return s}}),i=K({queryKey:["account-application"],queryFn:async()=>{const{data:s}=await w.get(H.auth.application);return s}});return i.isLoading||t.isLoading?e.jsx(ue,{}):i.isError||t.isError?e.jsx(he,{route:b.dashboard.products.root}):e.jsxs(e.Fragment,{children:[e.jsx(me,{children:e.jsxs("title",{children:[" ",He.title]})}),e.jsx(Fe,{products:t.data,taxPercentage:i.data.taxPercentage})]})}export{Jt as default};
