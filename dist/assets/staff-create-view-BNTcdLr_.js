import{r as $,bU as Z,bT as Q,aS as J,aW as N,aY as Y,b as H,ez as X,aZ as ee,j as t,a_ as se,dn as k,dq as z,a$ as ie,dL as oe,o as re,dM as ne,dK as te,dN as F,p as P,aF as A,S as R,T as L,B as q,bL as ae,e as D,eb as le}from"./index-DLwkls4m.js";import{C as ce}from"./custom-breadcrumbs-RrbSlijf.js";import{z as h,u as me,t as ue,F as pe,C as de}from"./form-provider-BLqJfrAn.js";import{u as xe}from"./useMutation-Xh_zmf_Z.js";import"./editor-DRhW7keS.js";import"./image-DLBdKQMi.js";import{T as w}from"./TextField-B1Cg5HmH.js";import{F as K}from"./FormControlLabel-7I2uQbxz.js";import{C as ge}from"./Checkbox-ByD5WW94.js";const I=$.createContext();function he(e){return Z("MuiGrid",e)}const fe=[0,1,2,3,4,5,6,7,8,9,10],be=["column-reverse","column","row-reverse","row"],ve=["nowrap","wrap-reverse","wrap"],j=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],C=Q("MuiGrid",["root","container","item","zeroMinWidth",...fe.map(e=>`spacing-xs-${e}`),...be.map(e=>`direction-xs-${e}`),...ve.map(e=>`wrap-xs-${e}`),...j.map(e=>`grid-xs-${e}`),...j.map(e=>`grid-sm-${e}`),...j.map(e=>`grid-md-${e}`),...j.map(e=>`grid-lg-${e}`),...j.map(e=>`grid-xl-${e}`)]),we=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function b(e){const s=parseFloat(e);return`${s}${String(e).replace(String(s),"")||"px"}`}function je({theme:e,ownerState:s}){let r;return e.breakpoints.keys.reduce((o,i)=>{let n={};if(s[i]&&(r=s[i]),!r)return o;if(r===!0)n={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(r==="auto")n={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const c=k({values:s.columns,breakpoints:e.breakpoints.values}),a=typeof c=="object"?c[i]:c;if(a==null)return o;const m=`${Math.round(r/a*1e8)/1e6}%`;let u={};if(s.container&&s.item&&s.columnSpacing!==0){const l=e.spacing(s.columnSpacing);if(l!=="0px"){const d=`calc(${m} + ${b(l)})`;u={flexBasis:d,maxWidth:d}}}n=N({flexBasis:m,flexGrow:0,maxWidth:m},u)}return e.breakpoints.values[i]===0?Object.assign(o,n):o[e.breakpoints.up(i)]=n,o},{})}function Ne({theme:e,ownerState:s}){const r=k({values:s.direction,breakpoints:e.breakpoints.values});return z({theme:e},r,o=>{const i={flexDirection:o};return o.indexOf("column")===0&&(i[`& > .${C.item}`]={maxWidth:"none"}),i})}function _({breakpoints:e,values:s}){let r="";Object.keys(s).forEach(i=>{r===""&&s[i]!==0&&(r=i)});const o=Object.keys(e).sort((i,n)=>e[i]-e[n]);return o.slice(0,o.indexOf(r))}function $e({theme:e,ownerState:s}){const{container:r,rowSpacing:o}=s;let i={};if(r&&o!==0){const n=k({values:o,breakpoints:e.breakpoints.values});let c;typeof n=="object"&&(c=_({breakpoints:e.breakpoints.values,values:n})),i=z({theme:e},n,(a,m)=>{var u;const l=e.spacing(a);return l!=="0px"?{marginTop:`-${b(l)}`,[`& > .${C.item}`]:{paddingTop:b(l)}}:(u=c)!=null&&u.includes(m)?{}:{marginTop:0,[`& > .${C.item}`]:{paddingTop:0}}})}return i}function Ce({theme:e,ownerState:s}){const{container:r,columnSpacing:o}=s;let i={};if(r&&o!==0){const n=k({values:o,breakpoints:e.breakpoints.values});let c;typeof n=="object"&&(c=_({breakpoints:e.breakpoints.values,values:n})),i=z({theme:e},n,(a,m)=>{var u;const l=e.spacing(a);return l!=="0px"?{width:`calc(100% + ${b(l)})`,marginLeft:`-${b(l)}`,[`& > .${C.item}`]:{paddingLeft:b(l)}}:(u=c)!=null&&u.includes(m)?{}:{width:"100%",marginLeft:0,[`& > .${C.item}`]:{paddingLeft:0}}})}return i}function ye(e,s,r={}){if(!e||e<=0)return[];if(typeof e=="string"&&!Number.isNaN(Number(e))||typeof e=="number")return[r[`spacing-xs-${String(e)}`]];const o=[];return s.forEach(i=>{const n=e[i];Number(n)>0&&o.push(r[`spacing-${i}-${String(n)}`])}),o}const ke=J("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,s)=>{const{ownerState:r}=e,{container:o,direction:i,item:n,spacing:c,wrap:a,zeroMinWidth:m,breakpoints:u}=r;let l=[];o&&(l=ye(c,u,s));const d=[];return u.forEach(x=>{const g=r[x];g&&d.push(s[`grid-${x}-${String(g)}`])}),[s.root,o&&s.container,n&&s.item,m&&s.zeroMinWidth,...l,i!=="row"&&s[`direction-xs-${String(i)}`],a!=="wrap"&&s[`wrap-xs-${String(a)}`],...d]}})(({ownerState:e})=>N({boxSizing:"border-box"},e.container&&{display:"flex",flexWrap:"wrap",width:"100%"},e.item&&{margin:0},e.zeroMinWidth&&{minWidth:0},e.wrap!=="wrap"&&{flexWrap:e.wrap}),Ne,$e,Ce,je);function Se(e,s){if(!e||e<=0)return[];if(typeof e=="string"&&!Number.isNaN(Number(e))||typeof e=="number")return[`spacing-xs-${String(e)}`];const r=[];return s.forEach(o=>{const i=e[o];if(Number(i)>0){const n=`spacing-${o}-${String(i)}`;r.push(n)}}),r}const Be=e=>{const{classes:s,container:r,direction:o,item:i,spacing:n,wrap:c,zeroMinWidth:a,breakpoints:m}=e;let u=[];r&&(u=Se(n,m));const l=[];m.forEach(x=>{const g=e[x];g&&l.push(`grid-${x}-${String(g)}`)});const d={root:["root",r&&"container",i&&"item",a&&"zeroMinWidth",...u,o!=="row"&&`direction-xs-${String(o)}`,c!=="wrap"&&`wrap-xs-${String(c)}`,...l]};return ie(d,he,s)},O=$.forwardRef(function(s,r){const o=Y({props:s,name:"MuiGrid"}),{breakpoints:i}=H(),n=X(o),{className:c,columns:a,columnSpacing:m,component:u="div",container:l=!1,direction:d="row",item:x=!1,rowSpacing:g,spacing:v=0,wrap:S="wrap",zeroMinWidth:p=!1}=n,f=ee(n,we),B=g||v,W=m||v,G=$.useContext(I),M=l?a||12:G,V={},E=N({},f);i.keys.forEach(y=>{f[y]!=null&&(V[y]=f[y],delete E[y])});const T=N({},n,{columns:M,container:l,direction:d,item:x,rowSpacing:B,columnSpacing:W,wrap:S,zeroMinWidth:p,spacing:v},V,{breakpoints:i.keys}),U=Be(T);return t.jsx(I.Provider,{value:M,children:t.jsx(ke,N({ownerState:T,className:se(U.root,c),as:u,ref:r},E))})}),We=h.object({firstName:h.string().min(1,{message:"Staff firstName is required!"}),lastName:h.string().min(1,{message:"Staff lastName is required!"}),password:h.string().min(1,{message:"Password is required!"}),email:h.string().min(1,{message:"Email is required!"}),phoneNumber:h.string().min(1,{message:"Phone Number is required!"}),isActive:h.boolean(),permissions:h.array(h.string()).min(1,{message:"At least one permission is required!"})});function Ge({currentStaff:e,appPermissions:s}){const r=oe(),o=re(),[i,n]=$.useState(s),c=$.useMemo(()=>({firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",phoneNumber:(e==null?void 0:e.phoneNumber)||"",email:(e==null?void 0:e.email)||"",password:(e==null?void 0:e.password)||"",isActive:(e==null?void 0:e.isActive)||!0,permissions:(e==null?void 0:e.permissions)||[]}),[e]),a=me({resolver:ue(We),defaultValues:c}),{reset:m,watch:u,setValue:l,handleSubmit:d,control:x,formState:{isSubmitting:g}}=a,{mutate:v}=xe({mutationFn:p=>ne.post(te.staff.create,p),onSuccess:()=>{F.success(e?"Staff updated successfully!":"New Staff created successfully!"),r.invalidateQueries(["staff"]),m(),o.push(P.dashboard.staff.root)},onError:p=>{console.error(p),F.error("Failed to save staff. Please try again.")}}),S=d(p=>{console.info("DATA Staff",p),v(p)});return t.jsxs(pe,{methods:a,onSubmit:S,children:[t.jsx(A,{sx:{mb:4},children:t.jsxs(R,{spacing:4,sx:{p:3},children:[t.jsx(L,{variant:"h6",gutterBottom:!0,children:"Staff Details"}),t.jsxs(q,{columnGap:2,rowGap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(3, 1fr)"},children:[t.jsx(w,{label:"First Name",...a.register("firstName")}),t.jsx(w,{label:"Last Name",...a.register("lastName")}),t.jsx(w,{label:"Phone Number",...a.register("phoneNumber")}),t.jsx(w,{label:"Email",...a.register("email")}),t.jsx(w,{label:"Password",type:"password",...a.register("password")})]})]})}),t.jsx(A,{children:t.jsxs(R,{spacing:4,sx:{p:3},children:[t.jsx(L,{variant:"h6",gutterBottom:!0,children:"Permissions"}),t.jsx(O,{container:!0,spacing:2,children:i.map(p=>t.jsx(O,{item:!0,xs:12,md:4,children:t.jsx(de,{name:"permissions",control:x,render:({field:f})=>t.jsx(K,{control:t.jsx(ge,{checked:f.value.includes(p),onChange:B=>{const W=B.target.checked?[...f.value,p]:f.value.filter(G=>G!==p);f.onChange(W)}}),label:p.name})})},p.id))}),t.jsx(K,{control:t.jsx(ae,{...a.register("isActive")}),label:"Is Active?"}),t.jsxs(q,{display:"flex",justifyContent:"flex-end",mt:2,children:[t.jsx(D,{type:"submit",variant:"contained",disabled:g,children:"Submit"}),t.jsx(D,{variant:"outlined",onClick:()=>m(),sx:{ml:2},children:"Cancel"})]})]})})]})}function Le({staff:e,appPermissions:s}){return t.jsxs(le,{children:[t.jsx(ce,{links:[{name:"Dashboard",href:P.dashboard.root},{name:"Staff",href:P.dashboard.staff.root},{name:"New Staff"}],sx:{mb:{xs:3,md:5}}}),t.jsx(Ge,{currentStaff:e,appPermissions:s})]})}export{Le as S};
