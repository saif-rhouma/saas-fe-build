import{r as b,w as v,bG as O,j as e,S as R,A as N,C as A,B as S,du as q,y as D,I as g,dj as H,aB as G,aK as K,dz as M,bI as w,bJ as I,e as E,o as z,dC as Q,eq as V,p as P,dL as $,eb as J,G as T,R as W,aF as U,dw as _,dB as X,er as Y,dM as B,dK as L,dN as Z,ef as ee,H as te}from"./index-lMp9zap6.js";import{u as se,E as re}from"./error-block-DXWblvjp.js";import"./product-review-new-form-CVPyow4k.js";import"./index-B6dvdy-Z.js";import"./image-7Gw8g56m.js";import"./color-preview-CJO_juDV.js";import{u as oe}from"./useMutation-B2tKEkiI.js";import{C as ae}from"./custom-breadcrumbs-CnRCretL.js";import{u as ne,g as ie,r as le,T as de,a as ce,e as pe}from"./table-selected-action-Cgn9qQis.js";import{T as me}from"./table-no-data-D5fgAy-Q.js";import{T as k,a as ue,b as he,c as xe}from"./table-head-custom-BwAPFtwe.js";import{T as ge}from"./table-pagination-custom-sK7wTfre.js";import{b as je}from"./format-number-BW6JEF9q.js";import{C as be}from"./confirm-dialog-CfE53hWp.js";import{T as x}from"./TableCell-ljoaX5oi.js";import{T as fe}from"./TextField-BEm0Gfgz.js";import{I as Pe}from"./InputAdornment-CznJJWQj.js";import{P as Ce}from"./product-table-filters-result-ONSMrQLn.js";import"./form-provider-Cj0Z9UsE.js";import"./editor-56m6PEpo.js";import"./incrementer-button-iExNop-d.js";import"./carousel-progress-bar-DSPZDLfG.js";import"./html-to-markdown-6kshxNLu.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./product-Item-button-D_tV4M52.js";import"./upload-avatar-jEC4OtmL.js";import"./FormHelperText-CiWaMPMf.js";import"./formControlState-Dq1zat_P.js";import"./index-KeOEaw8h.js";import"./DialogContent-B0tqVN_s.js";import"./DialogTitle-BCkrw5VA.js";import"./LoadingButton-BI3VwLzw.js";import"./CircularProgress-CX5vuYgb.js";import"./AccordionSummary-CQn1YVkj.js";import"./Checkbox-BfbryewD.js";import"./empty-content-v04S0NJf.js";import"./TablePagination-Dir7BHGy.js";import"./LastPage-B3GbPSnl.js";import"./Select-DE7_tqxX.js";import"./Menu-Di83eYAm.js";import"./utils-DoM3o7-Q.js";import"./InputBase-D6UR9yYG.js";import"./FormControlLabel-CSqTNcaw.js";import"./FormControl-BFlCQpvi.js";import"./InputLabel-D2FT-Pcv.js";import"./FormLabel-CKyhTT_V.js";import"./filters-result-BnQFy5UF.js";import"./Chip-lc0vODcu.js";import"./Rating-D1epoFLf.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider--FnFNgPJ.js";import"./RadioGroup-C-GnO1ca.js";import"./FormGroup-BE8TyzSB.js";import"./countries-DSLisFCy.js";import"./Autocomplete-DnVwYLlc.js";import"./country-select-DkXlsKd6.js";import"./DatePicker-CRaT7_Tx.js";import"./ListItem-Eefms6HN.js";import"./MobileDateTimePicker-CghIhRUp.js";import"./index-DTyO1f1S.js";const ye=({row:t,selected:s,onDeleteRow:j,onEditRow:p})=>{var h;const[m,u]=b.useState((t==null?void 0:t.productToOrder.filter(o=>{var d;return((d=o==null?void 0:o.order)==null?void 0:d.status)==="Delivered"}).length)>0),a=v(),l=v(),r=O(),n=e.jsxs(k,{hover:!0,selected:s,children:[e.jsx(x,{children:t==null?void 0:t.id}),e.jsx(x,{children:e.jsxs(R,{spacing:2,direction:"row",alignItems:"center",children:[e.jsx(N,{alt:t==null?void 0:t.name,src:A.site.serverFileHost+(t==null?void 0:t.image)}),e.jsx(S,{component:"span",children:t==null?void 0:t.name})]})}),e.jsx(x,{children:je(t==null?void 0:t.price)}),e.jsxs(x,{align:"center",children:[" ",((h=t==null?void 0:t.stock)==null?void 0:h.quantity)||"0"," "]}),e.jsx(x,{children:e.jsx(q,{variant:"soft",color:t.isActive===!0&&"success"||t.isActive===!1&&"error"||"default",children:t!=null&&t.isActive?"ACTIVE":"INACTIVE"})}),e.jsxs(x,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[m&&e.jsx(D,{color:l.value?"inherit":"default",onClick:l.onToggle,sx:{...l.value&&{bgcolor:"action.hover"}},children:e.jsx(g,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(D,{color:r.open?"inherit":"default",onClick:r.onOpen,children:e.jsx(g,{icon:"eva:more-vertical-fill"})})]})]}),c=e.jsx(k,{children:e.jsx(x,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(H,{in:l.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(G,{sx:{m:1.5},children:t==null?void 0:t.productToOrder.filter(o=>{var d;return((d=o==null?void 0:o.order)==null?void 0:d.status)==="Delivered"}).map(o=>{var d,C;return e.jsxs(R,{direction:"row",alignItems:"center",sx:{p:f=>f.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:f=>`solid 2px ${f.vars.palette.background.neutral}`}},children:[e.jsx(K,{primary:`ORD-${(d=o==null?void 0:o.order)==null?void 0:d.id}`,secondary:o.sku,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs("div",{children:["x",o.quantity," "]}),e.jsx(S,{sx:{width:110,textAlign:"right"},children:(C=o.order)==null?void 0:C.status})]},o.id)})})})})});return e.jsxs(e.Fragment,{children:[n,c,e.jsx(M,{open:r.open,anchorEl:r.anchorEl,onClose:r.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(w,{children:[e.jsxs(I,{onClick:()=>{p(t.id),r.onClose()},children:[e.jsx(g,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(I,{onClick:()=>{a.onTrue(),r.onClose()},sx:{color:"error.main"},children:[e.jsx(g,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(be,{open:a.value,onClose:a.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(E,{variant:"contained",color:"error",onClick:j,children:"Delete"})})]})};function Te({filters:t,onResetPage:s,options:j}){const p=b.useCallback(m=>{s(),t.setState({name:m.target.value})},[t,s]);return e.jsx(R,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(fe,{sx:{width:420},value:t.state.name,onChange:p,placeholder:"Search by Product Name or Ref",InputProps:{startAdornment:e.jsx(Pe,{position:"start",children:e.jsx(g,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}const ve=[{id:"productId",label:"No.",width:80},{id:"productName",label:"Product Name"},{id:"productPrice",label:"Product Price",width:200},{id:"stock",label:"Stock",align:"center"},{id:"status",label:"Status",width:100},{id:"",width:88}];function Re({products:t}){const s=ne({defaultOrderBy:"planId"}),j=v(),p=z(),[m,u]=b.useState(t),a=Q({name:"",status:"all",startDate:null,endDate:null});b.useEffect(()=>{u(t)},[t]);const l=V(a.state.startDate,a.state.endDate),r=Se({inputData:m,comparator:ie(s.order,s.orderBy),filters:a.state,dateError:l}),n=le(r,s.page,s.rowsPerPage),c=!!a.state.name||a.state.status!=="all"||!!a.state.startDate&&!!a.state.endDate,h=!r.length&&c||!r.length,o=b.useCallback(i=>{f(i)},[n.length,s,m]),d=b.useCallback(i=>{p.push(P.dashboard.product.edit(i))},[p]),C=$(),{mutate:f}=oe({mutationFn:i=>B.delete(L.products.delete+i),onSuccess:async i=>{const y=m.filter(F=>F.id!==i);Z.success("Delete success!"),u(y),s.onUpdatePageDeleteRow(n.length)},onSettled:async()=>{await C.invalidateQueries({queryKey:["products"]})},onError:()=>{}});return e.jsx(J,{maxWidth:"xl",children:e.jsxs(T,{container:!0,spacing:3,children:[e.jsx(T,{xs:12,md:12,children:e.jsx(ae,{links:[{name:"Dashboard",href:P.dashboard.root},{name:"Product",href:P.dashboard.plan.root},{name:"List"}],action:e.jsx(E,{component:W,href:P.dashboard.product.new,variant:"contained",startIcon:e.jsx(g,{icon:"mingcute:add-line"}),children:"Add New Product"})})}),e.jsx(T,{xs:12,md:12,children:e.jsxs(U,{children:[e.jsx(Te,{filters:a,onResetPage:s.onResetPage,dateError:l}),c&&e.jsx(Ce,{filters:a,totalResults:r.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(S,{sx:{position:"relative"},children:[e.jsx(de,{dense:s.dense,numSelected:s.selected.length,rowCount:r.length,onSelectAllRows:i=>s.onSelectAllRows(i,r.map(y=>y.id)),action:e.jsx(_,{title:"Delete",children:e.jsx(D,{color:"primary",onClick:j.onTrue,children:e.jsx(g,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(X,{sx:{minHeight:444},children:e.jsxs(ue,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(he,{order:s.order,orderBy:s.orderBy,headLabel:ve,rowCount:r.length,numSelected:s.selected.length,onSort:s.onSort}),e.jsxs(xe,{children:[r.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(i=>e.jsx(ye,{row:i,selected:s.selected.includes(i.id),onEditRow:()=>d(i.id),onDeleteRow:()=>o(i.id)},i.id)),e.jsx(ce,{height:s.dense?56:76,emptyRows:pe(s.page,s.rowsPerPage,r.length)}),e.jsx(me,{notFound:h})]})]})})]}),e.jsx(ge,{page:s.page,dense:s.dense,count:r.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})})]})})}function Se({inputData:t,comparator:s,filters:j,dateError:p}){const{status:m,name:u,startDate:a,endDate:l}=j,r=t.map((n,c)=>[n,c]);return r.sort((n,c)=>{const h=s(n[0],c[0]);return h!==0?h:n[1]-c[1]}),t=r.map(n=>n[0]),u&&(t=t.filter(n=>n.id.toString().toLowerCase().indexOf(u.toLowerCase())!==-1||n.name.toLowerCase().indexOf(u.toLowerCase())!==-1)),p||a&&l&&(t=t.filter(n=>Y(n.createdAt,a,l))),t}const De={title:`Product list | Dashboard - ${A.site.name}`};function Nt(){const t=se({queryKey:["products"],queryFn:async()=>{const{data:s}=await B.get(L.products.list);return s}});return t.isPending||t.isLoading?e.jsx(ee,{}):t.isError?e.jsx(re,{route:P.dashboard.products.root}):e.jsxs(e.Fragment,{children:[e.jsx(te,{children:e.jsxs("title",{children:[" ",De.title]})}),e.jsx(Re,{products:t.data})]})}export{Nt as default};
