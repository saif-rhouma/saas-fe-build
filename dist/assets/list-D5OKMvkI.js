import{i as ee,aP as Te,j as e,L as we,S as f,A as te,I as C,B as c,aT as se,d0 as U,aL as Se,c9 as G,C as ae,e8 as ne,d7 as X,l as L,cQ as De,bR as Re,db as Ae,aR as Ie,e3 as O,aS as v,e as F,r as h,de as re,e2 as ie,eh as le,ef as Le,ee as Oe,am as E,dp as M,dm as q,cY as oe,v as V,dT as ce,eg as ke,e7 as Ee,g as Be,b as $e,dn as Fe,p as I,dP as Me,cV as S,R as qe,dS as B,dd as Ne,dq as He,H as Ve}from"./index-DBAnnifB.js";import{u as Y,E as de}from"./error-block-I6x1Hy75.js";import{u as Qe}from"./useMutation-DLdc3eWl.js";import{C as We}from"./custom-breadcrumbs-DBItHaBE.js";import{P as k}from"./permission-access-controller-Dti4v_dk.js";import{g as xe,r as he,e as Ke}from"./utils-MBUcMVfY.js";import{u as ue}from"./use-table-_0b8U19R.js";import{T as ze}from"./table-no-data-Dx0Wqqms.js";import{T as _e}from"./table-empty-rows-6TIBM6gU.js";import{T as J,a as me,b as pe,c as je}from"./table-head-custom-oTVXNsWX.js";import{T as Ge}from"./table-selected-action-CX9zyaxE.js";import{T as ge}from"./table-pagination-custom-CSBoVDUr.js";import{A as $}from"./app-widget-summary-CdbiQS7l.js";import{b as A}from"./format-number-DHkj0q5I.js";import{C as Ye}from"./confirm-dialog-Bix3pn1a.js";import{T as P}from"./TableCell-D0tRcJwU.js";import{A as Je}from"./AvatarGroup-KOO4AQi4.js";import{u as Ue}from"./use-tabs-VslulDr8.js";import{S as fe}from"./Select-Cs1GmroI.js";import{Q as Xe}from"./quotation-product-table-bgPa4QVx.js";import{P as Ze}from"./order-payment-details-dialog-d5deobuu.js";import{T as et,a as tt}from"./Tabs-D1nVhLuN.js";import{C as st}from"./CardHeader-Vz8vospd.js";import{T as at}from"./TextField-Cnf5s-_6.js";import{I as nt}from"./InputAdornment-kj6j4mRM.js";import{F as rt,a as Q,c as W}from"./filters-result-aA5K4jjQ.js";import{C as K}from"./Chip-DfL_ynnF.js";import"./index-JU6SrAG_.js";import"./incrementer-button-Dvx1B3F1.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./empty-content-x40r8P7g.js";import"./Checkbox-C9zyd1yT.js";import"./TablePagination-CtzltUxB.js";import"./KeyboardArrowRight-tacz4Y6j.js";import"./LastPage-BC27tdqq.js";import"./InputBase-Dk2d0D5e.js";import"./formControlState-Dq1zat_P.js";import"./utils-DoM3o7-Q.js";import"./FormControlLabel-BLHOqcns.js";import"./use-chart-y5WYcrmk.js";import"./chart-legends-CbMMWM0D.js";import"./index-BHbW1OCY.js";import"./DialogContent-BOG7TMWB.js";import"./DialogTitle-m6FUYnnv.js";import"./Menu-CWYUzvJj.js";import"./form-provider-C9WrYleO.js";import"./FormHelperText-DbwQqqnD.js";import"./Rating-DsIJUcaL.js";import"./visuallyHidden-Dan1xhjv.js";import"./editor-CpxSiSi_.js";import"./index-B9zhif9o.js";import"./Slider-BALWrmvq.js";import"./FormControl-BL4Ls0ff.js";import"./FormLabel-qH7g1y9y.js";import"./RadioGroup-C_0xPGj6.js";import"./FormGroup-ZuySfzWi.js";import"./utils-C3i7epmT.js";import"./countries-DSLisFCy.js";import"./Autocomplete-Bk7RHyx1.js";import"./country-select-SNPz2g0K.js";import"./InputLabel-B6YlaWfN.js";import"./upload-avatar-CgBNTr-y.js";import"./image-V4smZB5P.js";import"./DatePicker-WvioqOmJ.js";import"./ListItem-CRRiYsyQ.js";import"./MobileDateTimePicker-kmTIkQgP.js";import"./schema-helper-CvPOGW5C.js";import"./LoadingButton-CunA2jBP.js";import"./CircularProgress-DeUuXNKO.js";function it({row:s,index:r,selected:a,onViewRow:u,onDeleteRow:t,onClickRow:o,isFullDisplay:d}){var T,D,b;const j=ee(),m=ee(),i=Te(),l=e.jsxs(J,{hover:!0,selected:a,children:[e.jsx(P,{onClick:o,children:e.jsx(we,{color:"inherit",onClick:u,underline:"always",sx:{cursor:"pointer"},children:(s==null?void 0:s.ref)||r||(s==null?void 0:s.id)})}),e.jsx(P,{onClick:o,children:e.jsxs(f,{spacing:2,direction:"row",alignItems:"center",children:[e.jsx(te,{sx:{bgcolor:"#00AB55"},alt:s.name,src:s.customer.avatar,children:e.jsx(C,{color:"white",icon:"fluent:person-20-filled",width:24})}),e.jsxs(f,{sx:{typography:"body2",flex:"1 1 auto",alignItems:"flex-start"},children:[e.jsx(c,{component:"span",sx:{textTransform:"capitalize"},children:s.customer.name}),e.jsx(c,{component:"span",sx:{color:"text.disabled"},children:s.customer.email})]})]})}),!d&&e.jsx(P,{onClick:o,children:e.jsx(se,{primary:U(s.orderDate),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),e.jsx(P,{align:"center",onClick:o,children:e.jsx(Je,{sx:{[`& .${Se.avatar}`]:{width:24,height:24}},children:(T=s==null?void 0:s.productToOrder)==null?void 0:T.map(x=>{var g,w,p,R;return e.jsx(G,{title:`${(g=x==null?void 0:x.product)==null?void 0:g.name} | Quantity : ${x.quantity}`,children:e.jsx(te,{alt:(w=x==null?void 0:x.product)==null?void 0:w.name,src:`${ae.site.serverFileHost}${(p=x==null?void 0:x.product)==null?void 0:p.image}`},x==null?void 0:x.id)},(R=x==null?void 0:x.product)==null?void 0:R.id)})})}),e.jsx(P,{onClick:o,children:A(ne(s.totalOrderAmount-s.totalOrderAmount*(s.discount/100),s.snapshotTaxPercentage))||"-"}),!d&&e.jsxs(P,{onClick:o,children:[(D=s.createdBy)==null?void 0:D.firstName," ",(b=s.createdBy)==null?void 0:b.lastName]}),!d&&e.jsx(P,{onClick:o,children:e.jsx(X,{variant:"soft",color:s.status==="Ready"&&"info"||s.status==="InProcess"&&"warning"||s.status==="Delivered"&&"success"||s.status==="Canceled"&&"error"||"default",children:s.status})}),!d&&e.jsxs(P,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[e.jsx(L,{color:m.value?"inherit":"default",onClick:m.onToggle,sx:{...m.value&&{bgcolor:"action.hover"}},children:e.jsx(C,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(L,{color:i.open?"inherit":"default",onClick:i.onOpen,children:e.jsx(C,{icon:"eva:more-vertical-fill"})})]})]}),y=e.jsx(J,{children:e.jsx(P,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(De,{in:m.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(Re,{sx:{m:1.5},children:s.productToOrder.map(x=>e.jsxs(f,{direction:"row",alignItems:"center",sx:{p:g=>g.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:g=>`solid 2px ${g.vars.palette.background.neutral}`}},children:[e.jsx(se,{primary:x.product.name,secondary:x.sku,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsxs("div",{children:["x",x.quantity," "]}),e.jsx(c,{sx:{width:110,textAlign:"right"},children:A(x.snapshotProductPrice)})]},x.id))})})})});return e.jsxs(e.Fragment,{children:[l,y,e.jsx(Ae,{open:i.open,anchorEl:i.anchorEl,onClose:i.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(Ie,{children:[e.jsx(k,{permission:O.VIEW_ORDER,children:e.jsxs(v,{onClick:()=>{u(),i.onClose()},children:[e.jsx(C,{icon:"solar:eye-bold"}),"View"]})}),s.status!=="Canceled"&&e.jsx(k,{permission:O.DELETE_ORDER,children:e.jsxs(v,{onClick:()=>{j.onTrue(),i.onClose()},sx:{color:"warning.main"},children:[e.jsx(C,{icon:"solar:trash-bin-trash-bold"}),"Cancel"]})})]})}),e.jsx(Ye,{open:j.value,onClose:j.onFalse,title:"Cancel Order",content:"Are you sure want to cancel this order?",action:e.jsx(F,{variant:"contained",color:"warning",onClick:()=>{t(),j.onFalse()},children:"Confirm Canceling"})})]})}const lt=[{id:"orderNumber",label:"#",width:40,align:"center"},{id:"date",label:"Date"},{id:"status",label:"Payment Type",width:200,align:"center"},{id:"totalAmount",label:"	Paid Amount",width:200,align:"center"}],ot=({payments:s})=>{const r=ue({defaultOrderBy:"orderId",defaultRowsPerPage:5}),[a,u]=h.useState(s),t=re({name:"",status:"all",startDate:null,endDate:null});h.useEffect(()=>{u(s)},[s]);const o=ie(t.state.startDate,t.state.endDate),d=ct({inputData:a,comparator:xe(r.order,r.orderBy),filters:t.state,dateError:o});he(d,r.page,r.rowsPerPage),t.state.name||t.state.status!=="all"||t.state.startDate&&t.state.endDate;const[j,m]=h.useState("all");h.useCallback(l=>{r.onResetPage(),t.setState({name:l.target.value})},[t,r]);const i=h.useCallback(l=>{r.onResetPage(),t.setState({status:l.target.value}),m(l.target.value)},[t,r]);return e.jsxs(c,{display:"flex",flexDirection:"column",alignItems:"center",sx:{borderRadius:1,height:1,width:1,overflow:"hidden",border:l=>`solid 1px ${l.vars.palette.divider}`},children:[e.jsx(f,{spacing:2,justifyContent:{xs:"flex-end"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:1,width:1},children:e.jsxs(fe,{size:"small",sx:{width:200,textTransform:"capitalize"},value:j,onChange:i,children:[e.jsx(v,{value:"all",children:"All Payments"}),e.jsx(v,{value:"Cash",children:"Cash"}),e.jsx(v,{value:"Card",children:"Card"}),e.jsx(v,{value:"Transfer",children:"Transfer"})]})}),e.jsx(c,{sx:{flex:1,width:1},children:e.jsxs(me,{size:"medium",children:[e.jsx(pe,{headLabel:lt}),e.jsx(je,{children:d.slice(r.page*r.rowsPerPage,r.page*r.rowsPerPage+r.rowsPerPage).map((l,y)=>e.jsxs(J,{children:[e.jsxs(P,{align:"center",children:[" ",y+1||l.id," "]}),e.jsx(P,{children:U(l.paymentDate)}),e.jsx(P,{align:"center",children:e.jsx(X,{variant:"soft",color:l.paymentType==="Cash"&&"info"||l.paymentType==="Card"&&"success"||l.paymentType==="Transfer"&&"default"||"default",children:l.paymentType})}),e.jsx(P,{align:"center",children:A(l==null?void 0:l.amount)})]},`${l.id}`))})]})}),e.jsx(ge,{sx:{width:1},page:r.page,dense:!0,count:d.length,rowsPerPage:r.rowsPerPage,onPageChange:r.onChangePage,onRowsPerPageChange:r.onChangeRowsPerPage})]})};function ct({inputData:s,comparator:r,filters:a,dateError:u}){const{status:t,name:o,startDate:d,endDate:j}=a,m=s.map((i,l)=>[i,l]);return m.sort((i,l)=>{const y=r(i[0],l[0]);return y!==0?y:i[1]-l[1]}),s=m.map(i=>i[0]),t!=="all"&&(s=s.filter(i=>i.paymentType===t)),u||d&&j&&(s=s.filter(i=>le(i.createdAt,d,j))),s}const z=[{value:"details",icon:e.jsx(C,{icon:"solar:eye-bold",width:24}),label:"Details"},{value:"payments",icon:e.jsx(C,{icon:"solar:case-minimalistic-bold",width:24}),label:"Payments"}],dt=({selectedOrder:s,handleResize:r,handleClose:a,onViewOrder:u})=>{var b,x,g,w;const[t,o]=h.useState(s),d=Ue("details"),[j,m]=h.useState(z),i=Le();h.useEffect(()=>{s.id!==t.id&&o(s)},[t.id,s]),h.useEffect(()=>{const p=(s==null?void 0:s.status)!=="Draft"&&(s==null?void 0:s.status)!=="Canceled"?z:z.filter(R=>!["payments"].includes(R.value));m(p)},[s]);const l=e.jsxs(f,{alignItems:"flex-end",sx:{p:1,textAlign:"right",typography:"body2"},children:[e.jsxs(f,{direction:"row",children:[e.jsx(c,{sx:{color:"text.secondary"},children:"Subtotal"}),e.jsx(c,{sx:{width:160,typography:"subtitle2"},children:A(t==null?void 0:t.totalOrderAmount)||"-"})]}),e.jsxs(f,{direction:"row",children:[e.jsx(c,{sx:{color:"text.secondary"},children:"Discount"}),e.jsx(c,{sx:{width:160,...(t==null?void 0:t.discount)&&{color:"error.main"}},children:t!=null&&t.discount?`- ${t==null?void 0:t.discount}%`:"-"})]}),e.jsxs(f,{direction:"row",children:[e.jsxs(c,{sx:{color:"text.secondary"},children:["Tax (",(t==null?void 0:t.snapshotTaxPercentage)||"0","%)"]}),e.jsx(c,{sx:{width:160},children:t!=null&&t.snapshotTaxPercentage?A(Oe((t==null?void 0:t.totalOrderAmount)-(t==null?void 0:t.totalOrderAmount)*((t==null?void 0:t.discount)/100),t==null?void 0:t.snapshotTaxPercentage)):"-"})]}),e.jsxs(f,{direction:"row",sx:{typography:"subtitle1"},children:[e.jsx("div",{children:"Total"}),e.jsx(c,{sx:{width:160},children:A(ne((t==null?void 0:t.totalOrderAmount)-(t==null?void 0:t.totalOrderAmount)*((t==null?void 0:t.discount)/100),t==null?void 0:t.snapshotTaxPercentage))||"-"})]})]}),y=e.jsxs(f,{sx:{display:"flex",flex:1,pb:3,pr:3,pl:3,typography:"body2"},children:[e.jsxs(c,{sx:{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center",m:1},children:[e.jsxs(c,{flexDirection:"column",sx:{display:"flex"},children:[e.jsxs(c,{sx:{color:"text.secondary"},children:["Order Ref: #",t==null?void 0:t.ref]}),e.jsxs(c,{sx:{color:"text.secondary"},children:["Order Date: ",U(t==null?void 0:t.orderDate)]})]}),e.jsx(c,{sx:{mr:2},children:e.jsxs(c,{sx:{color:"text.secondary"},children:["Status:"," ",e.jsx(X,{variant:"soft",color:(t==null?void 0:t.status)==="InProcess"&&"warning"||(t==null?void 0:t.status)==="Confirmed"&&"success"||(t==null?void 0:t.status)==="Canceled"&&"error"||"default",children:t==null?void 0:t.status})]})}),((b=t==null?void 0:t.order)==null?void 0:b.id)&&e.jsx(c,{sx:{color:"text.secondary"},className:"print-hide",children:e.jsxs(F,{variant:"contained",size:"small",startIcon:e.jsx(C,{icon:"heroicons-outline:external-link"}),onClick:()=>{t==null||t.quotation},children:["Related to Quotation: #",(x=t==null?void 0:t.quotation)==null?void 0:x.ref]})})]}),e.jsxs(c,{sx:{flex:1,mt:1,display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[e.jsx(Xe,{products:t==null?void 0:t.productToOrder,defaultRowsPerPage:t!=null&&t.notes?5:10}),e.jsx(E,{sx:{mt:1}})]}),l,(t==null?void 0:t.notes)&&e.jsxs(c,{children:[e.jsx(E,{}),e.jsx(f,{sx:{typography:"body2"},children:e.jsx(c,{sx:{p:1},children:e.jsxs(f,{sx:{typography:"subtitle2"},children:[e.jsx("div",{children:"Notes:"}),e.jsx(c,{sx:{color:"text.secondary"},children:t==null?void 0:t.notes})]})})})]})]}),T=Y({queryKey:["quotation",t.id],queryFn:async()=>{const{data:p}=await M.get(q.order.details+t.id);return o(p),p}}),D=p=>p.isPending||p.isLoading?e.jsx(ce,{}):p.isError?e.jsx(de,{}):e.jsxs(f,{sx:{display:"flex",flex:1,pb:3,pr:3,pl:3,typography:"body2"},children:[e.jsx(c,{sx:{display:"flex",width:"100%",alignItems:"center",m:2},children:e.jsx(c,{children:e.jsx(k,{permission:O.ADD_PAYMENT,children:e.jsx(F,{variant:"outlined",startIcon:e.jsx(C,{icon:"mingcute:add-line"}),children:"New Payment"})})})}),e.jsx(E,{}),e.jsx(c,{sx:{flex:1,mt:1,display:"flex",flexDirection:"column",justifyContent:"space-between"},children:e.jsx(ot,{payments:T.data.payments})})]});return e.jsxs(oe,{sx:{height:1,display:"flex",flexDirection:"column",width:1,transition:"all 2s ease-in-out"},children:[e.jsxs(et,{className:"print-hide ",value:d.value,onChange:d.onChange,sx:{px:3,boxShadow:p=>`inset 0 -2px 0 0 ${V(p.vars.palette.grey["500Channel"],.08)}`},children:[j.map(p=>e.jsx(tt,{icon:p.icon,value:p.value,label:p.label},p.value)),e.jsx(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",borderLeft:`solid 1px ${V(i.vars.palette.grey["500Channel"],.16)}`},children:e.jsx(L,{sx:{ml:1},onClick:r,children:e.jsx(C,{icon:"solar:full-screen-bold",width:24})})}),e.jsx(c,{marginLeft:"auto",sx:{display:"flex",justifyContent:"center",alignItems:"center",borderLeft:`solid 1px ${V(i.vars.palette.grey["500Channel"],.16)}`},children:e.jsx(L,{sx:{ml:1},onClick:a,children:e.jsx(C,{icon:"solar:close-square-outline",width:24})})})]}),e.jsxs(c,{className:"print-top-margin print-padding",sx:{display:"flex",flexDirection:"column",position:"relative",flex:1},children:[e.jsx(st,{sx:{pt:1},title:`Order Reference: ${t==null?void 0:t.ref}`,subheader:`Created By : ${(g=t.createdBy)==null?void 0:g.firstName} ${(w=t.createdBy)==null?void 0:w.lastName}`,action:e.jsx(f,{spacing:3,direction:{xs:"column",sm:"row"},alignItems:{xs:"flex-end",sm:"center"},sx:{mb:{xs:3,md:5}},children:e.jsxs(f,{direction:"row",spacing:1,alignItems:"center",flexGrow:1,sx:{width:1},children:[e.jsx(G,{title:"View",children:e.jsx(L,{onClick:()=>{u(t.id)},children:e.jsx(C,{icon:"solar:eye-bold"})})}),e.jsx(G,{title:"Print",children:e.jsx(Ze,{order:t})})]})})}),e.jsx(E,{}),d.value==="details"&&y,d.value==="payments"&&D(T)]})]})};function xt({filters:s,onResetPage:r}){const[a,u]=h.useState("all"),t=h.useCallback(d=>{r(),s.setState({name:d.target.value})},[s,r]),o=h.useCallback(d=>{r(),s.setState({status:d.target.value}),u(d.target.value)},[s,r]);return e.jsxs(f,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:[e.jsx(at,{sx:{width:420},value:s.state.name,onChange:t,placeholder:"Search customer or order number...",InputProps:{startAdornment:e.jsx(nt,{position:"start",children:e.jsx(C,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),e.jsxs(fe,{sx:{width:420,textTransform:"capitalize"},value:a,onChange:o,children:[e.jsx(v,{value:"all",children:"All Orders"}),e.jsx(v,{value:"Draft",children:"Draft"}),e.jsx(v,{value:"Canceled",children:"Canceled"}),e.jsx(v,{value:"InProcess",children:"Processing"}),e.jsx(v,{value:"Ready",children:"Ready To Deliver"}),e.jsx(v,{value:"Delivered",children:"Delivered"})]})]})}function ht({filters:s,totalResults:r,onResetPage:a,sx:u}){const t=h.useCallback(()=>{a(),s.setState({name:""})},[s,a]),o=h.useCallback(()=>{a(),s.setState({status:"all"})},[s,a]),d=h.useCallback(()=>{a(),s.setState({startDate:null,endDate:null})},[s,a]),j=h.useCallback(()=>{a(),s.onResetState()},[s,a]);return e.jsxs(rt,{totalResults:r,onReset:j,sx:u,children:[e.jsx(Q,{label:"Status:",isShow:s.state.status!=="all",children:e.jsx(K,{...W,label:s.state.status,onDelete:o,sx:{textTransform:"capitalize"}})}),e.jsx(Q,{label:"Date:",isShow:!!(s.state.startDate&&s.state.endDate),children:e.jsx(K,{...W,label:ke(s.state.startDate,s.state.endDate),onDelete:d})}),e.jsx(Q,{label:"Keyword:",isShow:!!s.state.name,children:e.jsx(K,{...W,label:s.state.name,onDelete:t})})]})}const _=[{id:"orderNumber",label:"#",width:88},{id:"name",label:"Customer"},{id:"createdAt",label:"Date",width:140},{id:"totalQuantity",label:"Items",width:120,align:"center"},{id:"totalAmount",label:"Price",width:140},{id:"createdBy",label:"Created By",width:200},{id:"status",label:"Status",width:110},{id:"",width:88}];function ut({orders:s,analytics:r}){const a=ue({defaultOrderBy:"orderId"}),{t:u}=Ee("orders"),t=Be(),[o,d]=h.useState(),[j,m]=h.useState(!1),[i,l]=h.useState(_),y=$e(),[T,D]=h.useState(()=>s),b=re({name:"",status:"all",startDate:null,endDate:null});h.useEffect(()=>{if(m(!1),D(s),o){const n=s.find(H=>H.id===o.id);d(n)}},[s]),h.useEffect(()=>{const n=o?_.filter(H=>!["createdAt","createdBy","status",""].includes(H.id)):_;l(n)},[o]);const x=ie(b.state.startDate,b.state.endDate),g=mt({inputData:T,comparator:xe(a.order,a.orderBy),filters:b.state,dateError:x}),w=he(g,a.page,a.rowsPerPage),p=!!b.state.name||b.state.status!=="all"||!!b.state.startDate&&!!b.state.endDate,R=!g.length&&p||!g.length,N=Fe(),{mutate:ye}=Qe({mutationFn:n=>M.delete(q.order.delete+n),onSuccess:async()=>{He.success("Order Has Been Canceled!")},onSettled:async()=>{await N.invalidateQueries({queryKey:["orders"]}),await N.invalidateQueries({queryKey:["orders-status"]}),await N.invalidateQueries({queryKey:["orders","analytics"]})},onError:()=>{}}),be=h.useCallback(n=>{ye(n)},[w.length,a,T]),Z=h.useCallback(n=>{t.replace(I.dashboard.order.details(n))},[t]),Ce=()=>{m(!j)},Pe=()=>{d(null),m(!1)},ve=n=>{d(n)};return e.jsx(Me,{maxWidth:"xl",children:e.jsxs(S,{container:!0,spacing:3,children:[e.jsx(S,{xs:12,md:12,children:e.jsx(We,{links:[{name:`${u("listView.breadCrumbsPageRootTitle")}`,href:I.dashboard.root},{name:`${u("listView.breadCrumbsParentPageTitle")}`,href:I.dashboard.order.root},{name:`${u("listView.breadCrumbsPageTitle")}`}],action:e.jsx(k,{permission:O.ADD_ORDER,children:e.jsx(F,{component:qe,href:I.dashboard.order.new,variant:"contained",startIcon:e.jsx(C,{icon:"mingcute:add-line"}),children:`${u("listView.addNewOrder")}`})})})}),e.jsxs(k,{permission:O.LIST_ORDER,children:[e.jsx(S,{xs:12,md:3,children:e.jsx($,{title:`${u("listView.statisticsWidgets.allOrders")}`,total:s.length,chart:{categories:r.data.lastSixMonth.map(n=>B(n==null?void 0:n.inMonth)),series:r.data.lastSixMonth.map(n=>n==null?void 0:n.ClaimsPerMonth)}})}),e.jsx(S,{xs:12,md:3,children:e.jsx($,{title:`${u("listView.statisticsWidgets.processingOrder")}`,total:r.data.analytics.InProcess,chart:{colors:[y.vars.palette.warning.light],categories:r.data.inProcessLastSixMonth.map(n=>B(n==null?void 0:n.inMonth)),series:r.data.inProcessLastSixMonth.map(n=>n==null?void 0:n.ClaimsPerMonth)}})}),e.jsx(S,{xs:12,md:3,children:e.jsx($,{title:`${u("listView.statisticsWidgets.readyToDeliver")}`,total:r.data.analytics.Ready,chart:{colors:[y.vars.palette.info.main],categories:r.data.readyLastSixMonth.map(n=>B(n==null?void 0:n.inMonth)),series:r.data.readyLastSixMonth.map(n=>n==null?void 0:n.ClaimsPerMonth)}})}),e.jsx(S,{xs:12,md:3,children:e.jsx($,{title:`${u("listView.statisticsWidgets.delivered")}`,total:r.data.analytics.Delivered,chart:{colors:[y.vars.palette.success.main],categories:r.data.deliveredLastSixMonth.map(n=>B(n==null?void 0:n.inMonth)),series:r.data.deliveredLastSixMonth.map(n=>n==null?void 0:n.ClaimsPerMonth)}})}),!j&&e.jsx(S,{xs:12,md:o?5:12,children:e.jsxs(oe,{children:[e.jsx(xt,{filters:b,onResetPage:a.onResetPage,dateError:x}),p&&e.jsx(ht,{filters:b,totalResults:g.length,onResetPage:a.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(c,{sx:{position:"relative"},children:[e.jsx(Ge,{dense:a.dense,numSelected:a.selected.length,rowCount:g.length}),e.jsx(Ne,{sx:{minHeight:444},children:e.jsxs(me,{size:a.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(pe,{order:a.order,orderBy:a.orderBy,headLabel:i,rowCount:g.length}),e.jsxs(je,{children:[g.slice(a.page*a.rowsPerPage,a.page*a.rowsPerPage+a.rowsPerPage).map(n=>e.jsx(it,{row:n,selected:a.selected.includes(n.id),onSelectRow:()=>a.onSelectRow(n.id),onDeleteRow:()=>be(n.id),onViewRow:()=>Z(n.id),onClickRow:()=>ve(n),isFullDisplay:o},n.id)),e.jsx(_e,{height:a.dense?56:76,emptyRows:Ke(a.page,a.rowsPerPage,g.length)}),e.jsx(ze,{notFound:R})]})]})})]}),e.jsx(ge,{page:a.page,dense:a.dense,count:g.length,rowsPerPage:a.rowsPerPage,onPageChange:a.onChangePage,onChangeDense:a.onChangeDense,onRowsPerPageChange:a.onChangeRowsPerPage})]})}),o&&e.jsx(c,{sx:{display:"flex",flex:1,p:1.5,transition:"all 2s ease-in-out"},children:e.jsx(dt,{selectedOrder:o,handleResize:Ce,handleClose:Pe,onViewOrder:Z})})]})]})})}function mt({inputData:s,comparator:r,filters:a,dateError:u}){const{status:t,name:o,startDate:d,endDate:j}=a,m=s==null?void 0:s.map((i,l)=>[i,l]);return m==null||m.sort((i,l)=>{const y=r(i[0],l[0]);return y!==0?y:i[1]-l[1]}),s=m==null?void 0:m.map(i=>i[0]),o&&(s=s.filter(i=>i.id.toString().toLowerCase().indexOf(o.toLowerCase())!==-1||i.customer.name.toLowerCase().indexOf(o.toLowerCase())!==-1||i.status.toLowerCase().indexOf(o.toLowerCase())!==-1||i.customer.email.toLowerCase().indexOf(o.toLowerCase())!==-1)),t!=="all"&&(s=s.filter(i=>i.status===t)),u||d&&j&&(s=s.filter(i=>le(i.createTime,d,j))),s}const pt={title:`Order list | Dashboard - ${ae.site.name}`};function ks(){const s=Y({queryKey:["orders"],queryFn:async()=>{const{data:a}=await M.get(q.order.list);return a}}),r=Y({queryKey:["orders","analytics"],queryFn:async()=>{const{data:a}=await M.get(q.order.analytics);return a}});return r.isLoading||s.isLoading?e.jsx(ce,{}):s.isError||r.isError?e.jsx(de,{route:I.dashboard.order.root}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{children:e.jsxs("title",{children:[" ",pt.title]})}),e.jsx(ut,{orders:s.data,analytics:r})]})}export{ks as default};
