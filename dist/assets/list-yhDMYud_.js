import{w as g,bG as H,j as e,y as K,I as C,dz as q,bI as Q,ep as f,bJ as R,e as v,r as d,S as I,dC as U,er as _,dL as z,eb as $,p as D,aF as G,B as J,dB as W,es as V,dM as j,dK as b,dN as S,ef as X,H as Y,C as Z}from"./index-Bm3rBIkL.js";import{u as ee,E as te}from"./error-block-BO5MDXKX.js";import{u as w}from"./useMutation-BPy7H-1h.js";import{C as se}from"./custom-breadcrumbs-DgyWxDBR.js";import{P as y}from"./permission-access-controller-Bd1g1bvY.js";import{u as oe,g as re,r as ne,T as ae,a as ie,e as le}from"./table-selected-action-FGFYoCf9.js";import{T as ce}from"./table-no-data-C5ESOE9S.js";import{T as me,a as de,b as ue,c as pe}from"./table-head-custom-fAI8azNC.js";import{T as he}from"./table-pagination-custom-B5OCrP_3.js";import{C as xe}from"./confirm-dialog-CdiBdWQ6.js";import{T as x}from"./TableCell-DwZUj5h4.js";import{O as B}from"./order-customer-create-dialog-D0N60WKZ.js";import{T as Ce}from"./TextField-Zaq0_UQI.js";import{I as ge}from"./InputAdornment-C5fdA_pt.js";import{F as je,a as be,c as fe}from"./filters-result-VXglGh15.js";import{C as ye}from"./Chip-wb6jkBj9.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./Checkbox-DZc8qiZw.js";import"./empty-content-Bj3fPw3b.js";import"./TablePagination-xS2VmU8P.js";import"./LastPage-Bo5KhWUM.js";import"./Select-BbFY65UU.js";import"./Menu-BCmDYN65.js";import"./utils-DoM3o7-Q.js";import"./formControlState-Dq1zat_P.js";import"./InputBase-CLwZiNSB.js";import"./FormControlLabel-3udn0dpo.js";import"./DialogContent-adXfkuCx.js";import"./DialogTitle-3zwXmVtf.js";import"./form-provider-BVzxbRNt.js";import"./FormHelperText-D4MtsGiu.js";import"./Rating-DDX-0-qU.js";import"./visuallyHidden-Dan1xhjv.js";import"./editor-B_eq4lpY.js";import"./index-DJLOkwgj.js";import"./Slider-DEF2K-nH.js";import"./FormControl-Dpp_E6i1.js";import"./FormLabel-CW4sUJth.js";import"./RadioGroup-CcFDuSjI.js";import"./FormGroup-C2nO5a7k.js";import"./index-I76JgJ8L.js";import"./countries-DSLisFCy.js";import"./Autocomplete-uJqWLfO9.js";import"./country-select-dI5VfxcM.js";import"./InputLabel-XKr5fbZR.js";import"./upload-avatar-CklA5cX-.js";import"./format-number-zZ3CkgDh.js";import"./image-BvWqJKQA.js";import"./DatePicker-BFbM1AIt.js";import"./ListItem-B8LRzQux.js";import"./MobileDateTimePicker-BrtExEWs.js";import"./schema-helper-A2yd0njb.js";import"./LoadingButton-qKaJGA43.js";import"./CircularProgress-msI0ykgU.js";const Pe=({row:t,selected:s,onDeleteRow:a,onEditRow:i})=>{const m=g(),n=H(),u=l=>l?`${l==null?void 0:l.street} ${l==null?void 0:l.country}.`:" - ",h=e.jsxs(me,{hover:!0,selected:s,children:[e.jsx(x,{children:t==null?void 0:t.id}),e.jsx(x,{children:t==null?void 0:t.name}),e.jsx(x,{children:t==null?void 0:t.email}),e.jsx(x,{children:t==null?void 0:t.phoneNumber}),e.jsx(x,{children:u(t==null?void 0:t.address)}),e.jsx(x,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:e.jsx(K,{color:n.open?"inherit":"default",onClick:n.onOpen,children:e.jsx(C,{icon:"eva:more-vertical-fill"})})})]});return e.jsxs(e.Fragment,{children:[h,e.jsx(q,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(Q,{children:[e.jsx(y,{permission:f.EDIT_CUSTOMER,children:e.jsxs(R,{onClick:()=>{i(),n.onClose()},children:[e.jsx(C,{icon:"solar:pen-bold"}),"Edit"]})}),e.jsx(y,{permission:f.DELETE_CUSTOMER,children:e.jsxs(R,{onClick:()=>{m.onTrue(),n.onClose()},sx:{color:"error.main"},children:[e.jsx(C,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})})]})}),e.jsx(xe,{open:m.value,onClose:m.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(v,{variant:"contained",color:"error",onClick:a,children:"Delete"})})]})};function Te({customer:t,open:s,onClose:a,handler:i}){return e.jsx(B,{customer:t,open:s,onClose:a,handler:i})}function Ee({customer:t,open:s,onClose:a,handler:i}){return e.jsx(B,{customer:t,open:s,onClose:a,handler:i})}function Se({filters:t,onResetPage:s,options:a}){const i=d.useCallback(m=>{s(),t.setState({name:m.target.value})},[t,s]);return e.jsx(I,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(Ce,{sx:{width:420},value:t.state.name,onChange:i,placeholder:"Search customer or order number...",InputProps:{startAdornment:e.jsx(ge,{position:"start",children:e.jsx(C,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}function we({filters:t,totalResults:s,onResetPage:a,sx:i}){const m=d.useCallback(()=>{a(),t.setState({name:""})},[t,a]),n=d.useCallback(()=>{a(),t.onResetState()},[t,a]);return e.jsx(je,{totalResults:s,onReset:n,sx:i,children:e.jsx(be,{label:"Keyword:",isShow:!!t.state.name,children:e.jsx(ye,{...fe,label:t.state.name,onDelete:m})})})}const De=[{id:"customerId",label:"#",width:88},{id:"name",label:"Customer Name",width:220},{id:"email",label:"Email",width:220},{id:"phoneNumber",label:"Phone Number",width:120},{id:"address",label:"Address",width:120},{id:"",width:88}],Fe=({customers:t})=>{const s=oe({defaultOrderBy:"id"}),a=g(),i=g(),m=g(),[n,u]=d.useState(t),[h,l]=d.useState(),o=U({name:"",status:"all",startDate:null,endDate:null}),p=_(o.state.startDate,o.state.endDate),c=Re({inputData:n,comparator:re(s.order,s.orderBy),filters:o.state,dateError:p});d.useEffect(()=>{u(t)},[t]);const P=ne(c,s.page,s.rowsPerPage),F=!!o.state.name||o.state.status!=="all"||!!o.state.startDate&&!!o.state.endDate,L=!c.length&&F||!c.length,k=d.useCallback(r=>{M(r)},[P.length,s,n]),A=d.useCallback(r=>{l(r),i.onToggle()},[P.length,s,n]),T=z(),{mutate:O}=w({mutationFn:r=>j.post(b.customers.create,r),onSuccess:async()=>{S.success("New Customer Has Been Created!")},onSettled:async()=>{await T.invalidateQueries({queryKey:["customers"]}),a.onFalse()},onError:r=>{console.log(r)}}),{mutate:N}=w({mutationFn:({id:r,payload:E})=>j.patch(b.customers.edit+r,E),onSuccess:async()=>{S.success("New Customer Has Been Modified!")},onSettled:async()=>{await T.invalidateQueries({queryKey:["customers"]}),i.onFalse()},onError:r=>{console.log(r)}}),{mutate:M}=w({mutationFn:r=>j.delete(b.customers.delete+r),onSuccess:async()=>{const r=n.filter(E=>E.id!==id);S.success("Delete success!"),u(r),s.onUpdatePageDeleteRow(P.length),m.onFalse()},onSettled:async()=>{await T.invalidateQueries({queryKey:["customers"]}),m.onFalse()},onError:()=>{}});return e.jsxs(e.Fragment,{children:[e.jsx($,{maxWidth:"xl",children:e.jsxs(I,{spacing:3,children:[e.jsx(se,{links:[{name:"Dashboard",href:D.dashboard.root},{name:"Customers",href:D.dashboard.customers.root}],action:e.jsx(y,{permission:f.ADD_CUSTOMER,children:e.jsx(v,{onClick:()=>a.onToggle(),variant:"contained",startIcon:e.jsx(C,{icon:"mingcute:add-line"}),children:"Add New Customer"})})}),e.jsx(y,{permission:f.LIST_CUSTOMER,children:e.jsxs(G,{children:[e.jsx(Se,{filters:o,onResetPage:s.onResetPage,dateError:p}),F&&e.jsx(we,{filters:o,totalResults:c.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(J,{sx:{position:"relative"},children:[e.jsx(ae,{dense:s.dense,numSelected:s.selected.length,rowCount:c.length}),e.jsx(W,{sx:{minHeight:444},children:e.jsxs(de,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(ue,{order:s.order,orderBy:s.orderBy,headLabel:De,rowCount:c.length}),e.jsxs(pe,{children:[c.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(r=>e.jsx(Pe,{row:r,selected:s.selected.includes(r.id),onEditRow:()=>A(r),onDeleteRow:()=>k(r.id)},r.id)),e.jsx(ie,{height:s.dense?56:76,emptyRows:le(s.page,s.rowsPerPage,c.length)}),e.jsx(ce,{notFound:L})]})]})})]}),e.jsx(he,{page:s.page,dense:s.dense,count:c.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})})]})}),e.jsx(Ee,{open:a.value,onClose:a.onFalse,handler:O}),e.jsx(Te,{open:i.value,onClose:i.onFalse,handler:N,customer:h})]})};function Re({inputData:t,comparator:s,filters:a,dateError:i}){const{status:m,name:n,startDate:u,endDate:h}=a,l=t.map((o,p)=>[o,p]);return l.sort((o,p)=>{const c=s(o[0],p[0]);return c!==0?c:o[1]-p[1]}),t=l.map(o=>o[0]),n&&(t=t.filter(o=>o.id.toString().toLowerCase().indexOf(n.toLowerCase())!==-1||o.name.toLowerCase().indexOf(n.toLowerCase())!==-1||o.email.toLowerCase().indexOf(n.toLowerCase())!==-1||o.phoneNumber.toString().toLowerCase().indexOf(n.toLowerCase())!==-1)),i||u&&h&&(t=t.filter(o=>V(o.createdAt,u,h))),t}const ve={title:`Customers list | Dashboard - ${Z.site.name}`};function Lt(){const t=ee({queryKey:["customers"],queryFn:async()=>(await j.get(b.customers.list)).data});return t.isPending||t.isLoading?e.jsx(X,{}):t.isError?e.jsx(te,{route:D.dashboard.customers.root}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{children:e.jsxs("title",{children:[" ",ve.title]})}),e.jsx(Fe,{customers:t.data})]})}export{Lt as default};
