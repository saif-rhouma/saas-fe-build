import{r as g,Y as L,a3 as ae,W as ee,dn as te,p as b,j as e,S as O,A as J,C as A,B as C,Q as oe,bq as se,$ as F,I as h,cQ as ne,b6 as ie,e as q,e8 as le,db as de,a6 as ce,a7 as $,e4 as I,de as pe,e3 as me,dp as ue,dQ as he,cV as B,R as xe,cY as ge,dd as be,ed as je,dq as Q,dm as U,dr as fe,dU as Pe,H as Ce}from"./index-88qAwG8P.js";import{u as X,E as ye}from"./error-block-BTff90qR.js";import"./product-review-new-form-Dgvm0KNx.js";import"./index-CUUWJbjL.js";import"./image-CkDsegDa.js";import"./color-preview-CD-F9zwy.js";import{u as Te}from"./useMutation-Bjm4Nnvr.js";import{C as Re}from"./custom-breadcrumbs-x7W5GMPl.js";import{P as S}from"./permission-access-controller-BVvbpBzt.js";import{g as De,r as ke,e as ve}from"./utils-MBUcMVfY.js";import{u as Ae}from"./use-table-BYPgfP9k.js";import{T as Ie}from"./table-no-data-wFoKraSE.js";import{T as Se}from"./table-empty-rows-6krMqYw2.js";import{T as Z,a as Ve,b as Ee,c as we}from"./table-head-custom-g2OgtrHv.js";import{T as Oe}from"./table-selected-action-DnALz1xy.js";import{T as $e}from"./table-pagination-custom-Ds9-Dw8y.js";import{b as H}from"./format-number-B8FPsWIV.js";import{C as Be}from"./confirm-dialog-BdxUyq-O.js";import{T as P}from"./TableCell-Cl8UZGxf.js";import{A as He}from"./AvatarGroup-CWqMds2i.js";import{P as Le}from"./product-table-toolbar-CDTSykFk.js";import{P as Fe}from"./product-table-filters-result-CDBaIUe7.js";import"./form-provider-DSldc_Gv.js";import"./editor-DKQnkQYm.js";import"./incrementer-button-BYzmwBWa.js";import"./carousel-progress-bar-BfTZ-3BC.js";import"./html-to-markdown-DPZJdA-w.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./product-Item-button-Ci8ZBUz0.js";import"./upload-avatar-CSIBlxGF.js";import"./FormHelperText-DA7jizKd.js";import"./formControlState-Dq1zat_P.js";import"./index-CySZofTa.js";import"./DialogContent-F9o-_CVT.js";import"./DialogTitle-CvyYkdF0.js";import"./LoadingButton-CM47tPre.js";import"./CircularProgress-DIm-Ts9z.js";import"./AccordionSummary-BHm1ZZBP.js";import"./FormControlLabel-ts_MkIWE.js";import"./empty-content-vgDCQT8r.js";import"./Checkbox-Cpc8f1GH.js";import"./TablePagination-CrnuwEMO.js";import"./KeyboardArrowRight-fE7_2VJ7.js";import"./LastPage-B6xWbdc0.js";import"./Select-DFC-Q2QB.js";import"./Menu-BDUaDfAf.js";import"./utils-DoM3o7-Q.js";import"./InputBase-DD8qHu7J.js";import"./TextField-CQpihH7F.js";import"./FormControl-BXGEHd-f.js";import"./InputLabel-B0kOUcWA.js";import"./FormLabel-Ck5_RgM9.js";import"./InputAdornment-Bg-m_z4_.js";import"./filters-result-B0DfRGbW.js";import"./Chip-yDeOg34u.js";import"./Rating-4WKJ8FeG.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-Cdch2KEI.js";import"./RadioGroup-DZvtDFL6.js";import"./FormGroup-B0QesIKW.js";import"./utils-BDEKF9xP.js";import"./countries-DSLisFCy.js";import"./Autocomplete-Du1dNHWZ.js";import"./country-select-B-6neUw6.js";import"./DatePicker-C1aTSbY2.js";import"./ListItem-Bt-kWpW8.js";import"./MobileDateTimePicker-pEp8pQrB.js";import"./Tabs-gBKEx7yr.js";import"./index-DZ-uLlaR.js";const qe=({row:t,index:p,selected:s,onViewRow:l,onDeleteRow:y,onEditRow:j})=>{var R,D,k,o,x,v;const[m,f]=g.useState(((R=t==null?void 0:t.productToOrder)==null?void 0:R.length)>0),u=L(),r=L(),i=ae(),n=ee(),{t:d}=te("products"),T=g.useCallback(a=>{n.push(b.dashboard.order.details(a))},[n]),V=g.useCallback(a=>{n.push(b.dashboard.product.details(a))},[n]),E=e.jsxs(Z,{hover:!0,selected:s,children:[e.jsx(P,{children:p||(t==null?void 0:t.id)}),e.jsx(P,{children:e.jsxs(O,{spacing:2,direction:"row",alignItems:"center",children:[e.jsx(J,{alt:t==null?void 0:t.name,src:A.site.serverFileHost+((t==null?void 0:t.image)||A.site.defaultImgPlaceHolder)}),e.jsx(C,{component:"span",children:t==null?void 0:t.name})]})}),e.jsx(P,{children:e.jsx(He,{sx:{[`& .${oe.avatar}`]:{width:24,height:24}},children:e.jsx(se,{title:`${(D=t==null?void 0:t.category)==null?void 0:D.name}`,children:e.jsx(J,{alt:(k=t==null?void 0:t.category)==null?void 0:k.name,src:`${A.site.serverFileHost}${(o=t==null?void 0:t.category)==null?void 0:o.image}`})})})}),e.jsx(P,{children:H(t==null?void 0:t.price)}),e.jsxs(P,{align:"center",children:[" ",((x=t==null?void 0:t.stock)==null?void 0:x.quantity)||"0"," "]}),e.jsxs(P,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:[m&&e.jsx(F,{color:r.value?"inherit":"default",onClick:r.onToggle,sx:{...r.value&&{bgcolor:"action.hover"}},children:e.jsx(h,{icon:"eva:arrow-ios-downward-fill"})}),e.jsx(F,{color:i.open?"inherit":"default",onClick:i.onOpen,children:e.jsx(h,{icon:"eva:more-vertical-fill"})})]})]}),w=e.jsx(Z,{children:e.jsx(P,{sx:{p:0,border:"none"},colSpan:8,children:e.jsx(ne,{in:r.value,timeout:"auto",unmountOnExit:!0,sx:{bgcolor:"background.neutral"},children:e.jsx(ie,{sx:{m:1.5},children:(v=t==null?void 0:t.productToOrder)==null?void 0:v.map((a,re)=>{var W,_,G,M,N,z,K,Y;return re===5?e.jsx(O,{alignItems:"flex-end",sx:{p:c=>c.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:c=>`solid 2px ${c.vars.palette.background.neutral}`}},children:e.jsx(q,{variant:"contained",size:"small",endIcon:e.jsx(h,{icon:"heroicons-outline:external-link"}),onClick:()=>{V(t.id)},children:d("listView.table.tableActions.seeMore")})},a.id):e.jsxs(O,{direction:"row",alignItems:"center",sx:{p:c=>c.spacing(1.5,2,1.5,1.5),"&:not(:last-of-type)":{borderBottom:c=>`solid 2px ${c.vars.palette.background.neutral}`}},children:[e.jsxs(C,{onClick:()=>{var c;return T((c=a==null?void 0:a.order)==null?void 0:c.id)},sx:{width:240,display:"flex",gap:1,alignItems:"center",cursor:"pointer",marginRight:5},children:[e.jsx(h,{icon:"heroicons-outline:external-link"}),e.jsx("span",{children:(W=a==null?void 0:a.order)==null?void 0:W.ref})]}),e.jsx(C,{sx:{width:"100%",display:"flex",gap:1,alignItems:"center"},children:e.jsx("span",{children:(G=(_=a.order)==null?void 0:_.customer)==null?void 0:G.name})}),e.jsxs(C,{sx:{width:240,color:"error.main",fontWeight:"bold"},children:[a.quantity," ",e.jsx("span",{style:{color:"#000",fontWeight:"400"},children:` (${H(a==null?void 0:a.snapshotProductPrice)})`})]}),e.jsx(C,{sx:{width:200,textAlign:"right"},children:(M=a.order)==null?void 0:M.status}),e.jsx(C,{sx:{width:300,textAlign:"right"},children:H(le(((N=a.order)==null?void 0:N.totalOrderAmount)-((z=a.order)==null?void 0:z.totalOrderAmount)*(((K=a.order)==null?void 0:K.discount)/100),(Y=a.order)==null?void 0:Y.snapshotTaxPercentage))||"-"})]},a.id)})})})})});return e.jsxs(e.Fragment,{children:[E,w,e.jsx(de,{open:i.open,anchorEl:i.anchorEl,onClose:i.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(ce,{children:[e.jsxs($,{onClick:()=>{l(),i.onClose()},children:[e.jsx(h,{icon:"solar:eye-bold"}),d("listView.table.tableActions.view")]}),e.jsx(S,{permission:I.EDIT_PRODUCT,children:e.jsxs($,{onClick:()=>{j(t.id),i.onClose()},children:[e.jsx(h,{icon:"solar:pen-bold"}),d("listView.table.tableActions.edit")]})}),e.jsx(S,{permission:I.DELETE_PRODUCT,children:e.jsxs($,{onClick:()=>{u.onTrue(),i.onClose()},sx:{color:"error.main"},children:[e.jsx(h,{icon:"solar:trash-bin-trash-bold"}),d("listView.table.tableActions.delete")]})})]})}),e.jsx(Be,{open:u.value,onClose:u.onFalse,title:d("listView.messages.dialogDelete.title"),content:d("listView.messages.dialogDelete.text"),action:e.jsx(q,{variant:"contained",color:"error",onClick:y,children:d("listView.table.tableActions.delete")})})]})};function Qe({products:t,taxPercentage:p}){const s=Ae({defaultOrderBy:"planId"}),{t:l}=te("products"),y=[{id:"productId",label:`${l("listView.table.tableHeader.no")}`,width:80},{id:"productName",label:`${l("listView.table.tableHeader.name")}`},{id:"productCategory",label:`${l("listView.table.tableHeader.category")}`,width:200},{id:"productPrice",label:`${l("listView.table.tableHeader.price")}`,width:200},{id:"stock",label:`${l("listView.table.tableHeader.stock")}`,align:"center"},{id:"",width:88}],j=L(),m=ee(),[f,u]=g.useState(t),r=pe({name:"",status:"all",startDate:null,endDate:null});g.useEffect(()=>{u(t)},[t]);const i=me(r.state.startDate,r.state.endDate),n=Ue({inputData:f,comparator:De(s.order,s.orderBy),filters:r.state,dateError:i}),d=ke(n,s.page,s.rowsPerPage),T=!!r.state.name||r.state.status!=="all"||!!r.state.startDate&&!!r.state.endDate,V=!n.length&&T||!n.length,E=g.useCallback(o=>{k(o)},[d.length,s,f]),w=g.useCallback(o=>{m.push(b.dashboard.product.edit(o))},[m]),R=g.useCallback(o=>{m.push(b.dashboard.product.details(o))},[m]),D=ue(),{mutate:k}=Te({mutationFn:o=>Q.delete(U.products.delete+o),onSuccess:async o=>{const x=f.filter(v=>v.id!==o);fe.success("Delete success!"),u(x),s.onUpdatePageDeleteRow(d.length)},onSettled:async()=>{await D.invalidateQueries({queryKey:["products"]})},onError:()=>{}});return e.jsx(he,{maxWidth:"xl",children:e.jsxs(B,{container:!0,spacing:3,children:[e.jsx(B,{xs:12,md:12,children:e.jsx(Re,{links:[{name:`${l("listView.breadCrumbsPageRootTitle")}`,href:b.dashboard.root},{name:`${l("listView.breadCrumbsParentPageTitle")}`,href:b.dashboard.product.root},{name:`${l("listView.breadCrumbsPageTitle")}`}],action:e.jsx(S,{permission:I.ADD_PRODUCT,children:e.jsx(q,{component:xe,href:b.dashboard.product.new,variant:"contained",startIcon:e.jsx(h,{icon:"mingcute:add-line"}),children:l("listView.addNewProduct")})})})}),e.jsx(S,{permission:I.LIST_PRODUCT,children:e.jsx(B,{xs:12,md:12,children:e.jsxs(ge,{children:[e.jsx(Le,{filters:r,onResetPage:s.onResetPage,dateError:i}),T&&e.jsx(Fe,{filters:r,totalResults:n.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(C,{sx:{position:"relative"},children:[e.jsx(Oe,{dense:s.dense,numSelected:s.selected.length,rowCount:n.length,onSelectAllRows:o=>s.onSelectAllRows(o,n.map(x=>x.id)),action:e.jsx(se,{title:"Delete",children:e.jsx(F,{color:"primary",onClick:j.onTrue,children:e.jsx(h,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(be,{sx:{minHeight:444},children:e.jsxs(Ve,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Ee,{order:s.order,orderBy:s.orderBy,headLabel:y,rowCount:n.length,numSelected:s.selected.length,onSort:s.onSort}),e.jsxs(we,{children:[n.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map((o,x)=>e.jsx(qe,{row:o,index:s.page*s.rowsPerPage+x+1,selected:s.selected.includes(o.id),onEditRow:()=>w(o.id),onViewRow:()=>R(o.id),onDeleteRow:()=>E(o.id),taxPercentage:p},o.id)),e.jsx(Se,{height:s.dense?56:76,emptyRows:ve(s.page,s.rowsPerPage,n.length)}),e.jsx(Ie,{notFound:V})]})]})})]}),e.jsx($e,{page:s.page,dense:s.dense,count:n.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})})})]})})}function Ue({inputData:t,comparator:p,filters:s,dateError:l}){const{status:y,name:j,startDate:m,endDate:f}=s,u=t.map((r,i)=>[r,i]);return u.sort((r,i)=>{const n=p(r[0],i[0]);return n!==0?n:r[1]-i[1]}),t=u.map(r=>r[0]),j&&(t=t.filter(r=>r.id.toString().toLowerCase().indexOf(j.toLowerCase())!==-1||r.name.toLowerCase().indexOf(j.toLowerCase())!==-1)),l||m&&f&&(t=t.filter(r=>je(r.createdAt,m,f))),t}const We={title:`Product list | Dashboard - ${A.site.name}`};function is(){const t=X({queryKey:["products"],queryFn:async()=>{const{data:s}=await Q.get(U.products.list);return s}}),p=X({queryKey:["account-application"],queryFn:async()=>{const{data:s}=await Q.get(U.auth.application);return s}});return p.isLoading||t.isLoading?e.jsx(Pe,{}):p.isError||t.isError?e.jsx(ye,{route:b.dashboard.products.root}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{children:e.jsxs("title",{children:[" ",We.title]})}),e.jsx(Qe,{products:t.data,taxPercentage:p.data.taxPercentage})]})}export{is as default};
