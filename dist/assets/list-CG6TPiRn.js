import{w as b,bI as q,j as e,y as K,I as j,dB as M,bK as Q,bL as E,e as T,r as p,S,dE as $,er as z,dP as f,dN as U,ed as V,p as F,aH as W,B as G,dD as J,es as _,dO as P,dM as y,eh as X,H as Y,C as Z}from"./index-BPQkDe0s.js";import{u as ee,E as te}from"./error-block-Db9supFO.js";import{u as D}from"./useMutation-BoBY0b1e.js";import{C as R}from"./confirm-dialog-B6QB7W1X.js";import{C as se}from"./custom-breadcrumbs-BIW9VTmo.js";import{u as oe,g as ne,r as re,T as ae,a as ie,e as le}from"./table-selected-action-CQYhxLWr.js";import{T as ce}from"./table-no-data-BP6XCqFh.js";import{T as de,a as me,b as ue,c as pe}from"./table-head-custom-BKFgPtmt.js";import{T as he}from"./table-pagination-custom-mx9CENAz.js";import{T as g}from"./TableCell-CX5ECdrE.js";import{O as v}from"./order-customer-create-dialog-Dw9b55ih.js";import{T as ge}from"./TextField-Bi7NVwCq.js";import{I as xe}from"./InputAdornment-Ck59aR0s.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./DialogContent-p3i0msBI.js";import"./DialogTitle-DTSEDZ4J.js";import"./Checkbox-DYdkvSfk.js";import"./empty-content-mVT_rcbJ.js";import"./TablePagination-Brlt2UW_.js";import"./LastPage-nNWQQMs1.js";import"./Select-9Xhy8-ut.js";import"./Menu-DGoJy9BJ.js";import"./utils-DoM3o7-Q.js";import"./formControlState-Dq1zat_P.js";import"./InputBase-CPrPQ_RD.js";import"./FormControlLabel-CkOEQNeq.js";import"./form-provider-Csxs3POq.js";import"./index-DGJW8Nhg.js";import"./countries-DSLisFCy.js";import"./fields-uLHuWF6F.js";import"./FormHelperText-CPxcDFA-.js";import"./Rating-CpW9817X.js";import"./visuallyHidden-Dan1xhjv.js";import"./editor-JwZorNGg.js";import"./index-DhCxhDCC.js";import"./Slider-Cn-68b2h.js";import"./FormControl-bKQXC1dH.js";import"./FormLabel-8bz6Jicd.js";import"./RadioGroup-DbSLazbi.js";import"./FormGroup-CC5xoKev.js";import"./Autocomplete-lg4xc3Dx.js";import"./Chip-ALPNHt2t.js";import"./country-select-Bo5KTiYN.js";import"./InputLabel-AqbAhnGZ.js";import"./upload-avatar-CesV9ZGt.js";import"./format-number-9dwzKsgZ.js";import"./image-C7AA7Kgf.js";import"./DatePicker-BGXln9IR.js";import"./ListItem-BApUg4RM.js";import"./MobileDateTimePicker-dEpBlYqw.js";import"./schema-helper-CODNJXI3.js";import"./LoadingButton-ByZAe6Vn.js";import"./CircularProgress-BW2J7VJ8.js";const Ce=({row:s,selected:t,onDeleteRow:i,onEditRow:a})=>{const c=b(),r=q(),m=d=>d?`${d==null?void 0:d.street} ${d==null?void 0:d.country}.`:" - ",h=e.jsxs(de,{hover:!0,selected:t,children:[e.jsx(g,{children:s==null?void 0:s.id}),e.jsx(g,{children:s==null?void 0:s.name}),e.jsx(g,{children:s==null?void 0:s.email}),e.jsx(g,{children:s==null?void 0:s.phoneNumber}),e.jsx(g,{children:m(s==null?void 0:s.address)}),e.jsx(g,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:e.jsx(K,{color:r.open?"inherit":"default",onClick:r.onOpen,children:e.jsx(j,{icon:"eva:more-vertical-fill"})})})]});return e.jsxs(e.Fragment,{children:[h,e.jsx(M,{open:r.open,anchorEl:r.anchorEl,onClose:r.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(Q,{children:[e.jsxs(E,{onClick:()=>{a(),r.onClose()},children:[e.jsx(j,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(E,{onClick:()=>{c.onTrue(),r.onClose()},sx:{color:"error.main"},children:[e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(R,{open:c.value,onClose:c.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(T,{variant:"contained",color:"error",onClick:i,children:"Delete"})})]})};function je({customer:s,open:t,onClose:i,handler:a}){return e.jsx(v,{customer:s,open:t,onClose:i,handler:a})}function fe({customer:s,open:t,onClose:i,handler:a}){return e.jsx(v,{customer:s,open:t,onClose:i,handler:a})}function be({filters:s,onResetPage:t,options:i}){const a=p.useCallback(c=>{t(),s.setState({name:c.target.value})},[s,t]);return e.jsx(S,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(ge,{sx:{width:420},value:s.state.name,onChange:a,placeholder:"Search customer or order number...",InputProps:{startAdornment:e.jsx(xe,{position:"start",children:e.jsx(j,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}const Pe=[{id:"customerId",label:"#",width:88},{id:"name",label:"Customer Name",width:220},{id:"email",label:"Email",width:220},{id:"phoneNumber",label:"Phone Number",width:120},{id:"address",label:"Address",width:120},{id:"",width:88}],ye=({customers:s})=>{const t=oe({defaultOrderBy:"id"}),i=b(),a=b(),c=b(),[r,m]=p.useState(s),[h,d]=p.useState(),n=$({name:"",status:"all",startDate:null,endDate:null}),u=z(n.state.startDate,n.state.endDate),l=De({inputData:r,comparator:ne(t.order,t.orderBy),filters:n.state,dateError:u});p.useEffect(()=>{m(s)},[s]);const x=re(l,t.page,t.rowsPerPage),I=!!n.state.name||n.state.status!=="all"||!!n.state.startDate&&!!n.state.endDate,B=!l.length&&I||!l.length,L=p.useCallback(o=>{H(o)},[x.length,t,r]),k=p.useCallback(o=>{d(o),a.onToggle()},[x.length,t,r]),A=p.useCallback(()=>{const o=r.filter(C=>!t.selected.includes(C.id));f.success("Delete success!"),m(o),t.onUpdatePageDeleteRows({totalRowsInPage:x.length,totalRowsFiltered:l.length})},[l.length,x.length,t,r]),w=U(),{mutate:N}=D({mutationFn:o=>P.post(y.customers.create,o),onSuccess:async()=>{f.success("New Customer Has Been Created!")},onSettled:async()=>{await w.invalidateQueries({queryKey:["customers"]}),i.onFalse()},onError:o=>{console.log(o)}}),{mutate:O}=D({mutationFn:({id:o,payload:C})=>P.patch(y.customers.edit+o,C),onSuccess:async()=>{f.success("New Customer Has Been Modified!")},onSettled:async()=>{await w.invalidateQueries({queryKey:["customers"]}),a.onFalse()},onError:o=>{console.log(o)}}),{mutate:H}=D({mutationFn:o=>P.delete(y.customers.delete+o),onSuccess:async()=>{const o=r.filter(C=>C.id!==id);f.success("Delete success!"),m(o),t.onUpdatePageDeleteRow(x.length),c.onFalse()},onSettled:async()=>{await w.invalidateQueries({queryKey:["customers"]}),c.onFalse()},onError:()=>{}});return e.jsxs(e.Fragment,{children:[e.jsx(V,{maxWidth:"xl",children:e.jsxs(S,{spacing:3,children:[e.jsx(se,{links:[{name:"Dashboard",href:F.dashboard.root},{name:"Customers",href:F.dashboard.customers.root}],action:e.jsx(T,{onClick:()=>i.onToggle(),variant:"contained",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),children:"Add New Customer"})}),e.jsxs(W,{children:[e.jsx(be,{filters:n,onResetPage:t.onResetPage,dateError:u}),e.jsxs(G,{sx:{position:"relative"},children:[e.jsx(ae,{dense:t.dense,numSelected:t.selected.length,rowCount:l.length}),e.jsx(J,{sx:{minHeight:444},children:e.jsxs(me,{size:t.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(ue,{order:t.order,orderBy:t.orderBy,headLabel:Pe,rowCount:l.length}),e.jsxs(pe,{children:[l.slice(t.page*t.rowsPerPage,t.page*t.rowsPerPage+t.rowsPerPage).map(o=>e.jsx(Ce,{row:o,selected:t.selected.includes(o.id),onEditRow:()=>k(o),onDeleteRow:()=>L(o.id)},o.id)),e.jsx(ie,{height:t.dense?56:76,emptyRows:le(t.page,t.rowsPerPage,l.length)}),e.jsx(ce,{notFound:B})]})]})})]}),e.jsx(he,{page:t.page,dense:t.dense,count:l.length,rowsPerPage:t.rowsPerPage,onPageChange:t.onChangePage,onChangeDense:t.onChangeDense,onRowsPerPageChange:t.onChangeRowsPerPage})]})]})}),e.jsx(fe,{open:i.value,onClose:i.onFalse,handler:N}),e.jsx(je,{open:a.value,onClose:a.onFalse,handler:O,customer:h}),e.jsx(R,{open:c.value,onClose:c.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",t.selected.length," "]})," items?"]}),action:e.jsx(T,{variant:"contained",color:"error",onClick:()=>{A(),c.onFalse()},children:"Delete"})})]})},we=ye;function De({inputData:s,comparator:t,filters:i,dateError:a}){const{status:c,name:r,startDate:m,endDate:h}=i,d=s.map((n,u)=>[n,u]);return d.sort((n,u)=>{const l=t(n[0],u[0]);return l!==0?l:n[1]-u[1]}),s=d.map(n=>n[0]),r&&(s=s.filter(n=>n.id.toString().toLowerCase().indexOf(r.toLowerCase())!==-1||n.name.toLowerCase().indexOf(r.toLowerCase())!==-1||n.email.toLowerCase().indexOf(r.toLowerCase())!==-1||n.phoneNumber.toString().toLowerCase().indexOf(r.toLowerCase())!==-1)),a||m&&h&&(s=s.filter(n=>_(n.createdAt,m,h))),s}const Te={title:`Customers list | Dashboard - ${Z.site.name}`};function Et(){const s=ee({queryKey:["customers"],queryFn:async()=>(await P.get(y.customers.list)).data});return s.isPending||s.isLoading?e.jsx(X,{}):s.isError?e.jsx(te,{route:F.dashboard.customers.root}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{children:e.jsxs("title",{children:[" ",Te.title]})}),e.jsx(we,{customers:s.data})]})}export{Et as default};
