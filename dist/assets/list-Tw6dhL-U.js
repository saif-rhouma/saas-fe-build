import{w as g,bG as O,j as e,y as q,I as C,dz as H,bI as K,bJ as D,e as E,r as d,S as R,dC as M,eq as Q,dL as z,eb as $,p as F,aF as G,B as J,dB as W,er as U,dM as j,dK as b,dN as w,ef as V,H as _,C as X}from"./index-C-IhHuTJ.js";import{u as Y,E as Z}from"./error-block-BR6CrtTz.js";import{u as T}from"./useMutation-CsQJW4rY.js";import{C as ee}from"./custom-breadcrumbs-uFAKtVA_.js";import{u as te,g as se,r as oe,T as ae,a as ne,e as re}from"./table-selected-action-BOiNrM4L.js";import{T as ie}from"./table-no-data-CPZHThY_.js";import{T as le,a as ce,b as me,c as de}from"./table-head-custom-c1vpDJbN.js";import{T as ue}from"./table-pagination-custom-RNRyjqlB.js";import{C as pe}from"./confirm-dialog-CKBnhmtr.js";import{T as x}from"./TableCell-YKx_Gzup.js";import{O as v}from"./order-customer-create-dialog-eAJyAC_g.js";import{T as he}from"./TextField-9UQBwjuM.js";import{I as xe}from"./InputAdornment-epef3vq8.js";import{F as Ce,a as ge,c as je}from"./filters-result-CL5afXpK.js";import{C as be}from"./Chip-DE7nSvgd.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./Checkbox-OM-b9iKh.js";import"./empty-content-CHLoRVuk.js";import"./TablePagination-CKbxZQl-.js";import"./LastPage-C_sr1jh1.js";import"./Select-aS6O7ajU.js";import"./Menu-CrioubDI.js";import"./utils-DoM3o7-Q.js";import"./formControlState-Dq1zat_P.js";import"./InputBase-T30htlau.js";import"./FormControlLabel-BpukUZ1g.js";import"./DialogContent-7B2ADHjp.js";import"./DialogTitle-DncFMmYB.js";import"./form-provider-CBudI90v.js";import"./FormHelperText-Bk0TYkV4.js";import"./Rating-aPX_sh3H.js";import"./visuallyHidden-Dan1xhjv.js";import"./editor-D_zyis-v.js";import"./index-BbzwuQnk.js";import"./Slider-DLXe-CaB.js";import"./FormControl-Cqn5KMTu.js";import"./FormLabel-Cjr_5zdF.js";import"./RadioGroup-CONsuzNK.js";import"./FormGroup-DsmEYSPW.js";import"./index-DW-YGTnX.js";import"./countries-DSLisFCy.js";import"./Autocomplete-NiW7S513.js";import"./country-select-CMj3wYaW.js";import"./InputLabel-Di_kJ4FW.js";import"./upload-avatar-BSr4Zgme.js";import"./format-number-DBz3y1Zx.js";import"./image-Bf3dx3WP.js";import"./DatePicker-DCzcHVvE.js";import"./ListItem-DoDVqw_C.js";import"./MobileDateTimePicker-BipeM__l.js";import"./schema-helper-BFbJmRWY.js";import"./LoadingButton-Ecj7QQSO.js";import"./CircularProgress-x3I-4L2K.js";const fe=({row:t,selected:s,onDeleteRow:r,onEditRow:i})=>{const m=g(),n=O(),u=l=>l?`${l==null?void 0:l.street} ${l==null?void 0:l.country}.`:" - ",h=e.jsxs(le,{hover:!0,selected:s,children:[e.jsx(x,{children:t==null?void 0:t.id}),e.jsx(x,{children:t==null?void 0:t.name}),e.jsx(x,{children:t==null?void 0:t.email}),e.jsx(x,{children:t==null?void 0:t.phoneNumber}),e.jsx(x,{children:u(t==null?void 0:t.address)}),e.jsx(x,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:e.jsx(q,{color:n.open?"inherit":"default",onClick:n.onOpen,children:e.jsx(C,{icon:"eva:more-vertical-fill"})})})]});return e.jsxs(e.Fragment,{children:[h,e.jsx(H,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(K,{children:[e.jsxs(D,{onClick:()=>{i(),n.onClose()},children:[e.jsx(C,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(D,{onClick:()=>{m.onTrue(),n.onClose()},sx:{color:"error.main"},children:[e.jsx(C,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(pe,{open:m.value,onClose:m.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(E,{variant:"contained",color:"error",onClick:r,children:"Delete"})})]})};function ye({customer:t,open:s,onClose:r,handler:i}){return e.jsx(v,{customer:t,open:s,onClose:r,handler:i})}function Pe({customer:t,open:s,onClose:r,handler:i}){return e.jsx(v,{customer:t,open:s,onClose:r,handler:i})}function we({filters:t,onResetPage:s,options:r}){const i=d.useCallback(m=>{s(),t.setState({name:m.target.value})},[t,s]);return e.jsx(R,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(he,{sx:{width:420},value:t.state.name,onChange:i,placeholder:"Search customer or order number...",InputProps:{startAdornment:e.jsx(xe,{position:"start",children:e.jsx(C,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}function Te({filters:t,totalResults:s,onResetPage:r,sx:i}){const m=d.useCallback(()=>{r(),t.setState({name:""})},[t,r]),n=d.useCallback(()=>{r(),t.onResetState()},[t,r]);return e.jsx(Ce,{totalResults:s,onReset:n,sx:i,children:e.jsx(ge,{label:"Keyword:",isShow:!!t.state.name,children:e.jsx(be,{...je,label:t.state.name,onDelete:m})})})}const Fe=[{id:"customerId",label:"#",width:88},{id:"name",label:"Customer Name",width:220},{id:"email",label:"Email",width:220},{id:"phoneNumber",label:"Phone Number",width:120},{id:"address",label:"Address",width:120},{id:"",width:88}],Se=({customers:t})=>{const s=te({defaultOrderBy:"id"}),r=g(),i=g(),m=g(),[n,u]=d.useState(t),[h,l]=d.useState(),o=M({name:"",status:"all",startDate:null,endDate:null}),p=Q(o.state.startDate,o.state.endDate),c=De({inputData:n,comparator:se(s.order,s.orderBy),filters:o.state,dateError:p});d.useEffect(()=>{u(t)},[t]);const f=oe(c,s.page,s.rowsPerPage),S=!!o.state.name||o.state.status!=="all"||!!o.state.startDate&&!!o.state.endDate,B=!c.length&&S||!c.length,I=d.useCallback(a=>{A(a)},[f.length,s,n]),L=d.useCallback(a=>{l(a),i.onToggle()},[f.length,s,n]),y=z(),{mutate:k}=T({mutationFn:a=>j.post(b.customers.create,a),onSuccess:async()=>{w.success("New Customer Has Been Created!")},onSettled:async()=>{await y.invalidateQueries({queryKey:["customers"]}),r.onFalse()},onError:a=>{console.log(a)}}),{mutate:N}=T({mutationFn:({id:a,payload:P})=>j.patch(b.customers.edit+a,P),onSuccess:async()=>{w.success("New Customer Has Been Modified!")},onSettled:async()=>{await y.invalidateQueries({queryKey:["customers"]}),i.onFalse()},onError:a=>{console.log(a)}}),{mutate:A}=T({mutationFn:a=>j.delete(b.customers.delete+a),onSuccess:async()=>{const a=n.filter(P=>P.id!==id);w.success("Delete success!"),u(a),s.onUpdatePageDeleteRow(f.length),m.onFalse()},onSettled:async()=>{await y.invalidateQueries({queryKey:["customers"]}),m.onFalse()},onError:()=>{}});return e.jsxs(e.Fragment,{children:[e.jsx($,{maxWidth:"xl",children:e.jsxs(R,{spacing:3,children:[e.jsx(ee,{links:[{name:"Dashboard",href:F.dashboard.root},{name:"Customers",href:F.dashboard.customers.root}],action:e.jsx(E,{onClick:()=>r.onToggle(),variant:"contained",startIcon:e.jsx(C,{icon:"mingcute:add-line"}),children:"Add New Customer"})}),e.jsxs(G,{children:[e.jsx(we,{filters:o,onResetPage:s.onResetPage,dateError:p}),S&&e.jsx(Te,{filters:o,totalResults:c.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(J,{sx:{position:"relative"},children:[e.jsx(ae,{dense:s.dense,numSelected:s.selected.length,rowCount:c.length}),e.jsx(W,{sx:{minHeight:444},children:e.jsxs(ce,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(me,{order:s.order,orderBy:s.orderBy,headLabel:Fe,rowCount:c.length}),e.jsxs(de,{children:[c.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(a=>e.jsx(fe,{row:a,selected:s.selected.includes(a.id),onEditRow:()=>L(a),onDeleteRow:()=>I(a.id)},a.id)),e.jsx(ne,{height:s.dense?56:76,emptyRows:re(s.page,s.rowsPerPage,c.length)}),e.jsx(ie,{notFound:B})]})]})})]}),e.jsx(ue,{page:s.page,dense:s.dense,count:c.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})]})}),e.jsx(Pe,{open:r.value,onClose:r.onFalse,handler:k}),e.jsx(ye,{open:i.value,onClose:i.onFalse,handler:N,customer:h})]})};function De({inputData:t,comparator:s,filters:r,dateError:i}){const{status:m,name:n,startDate:u,endDate:h}=r,l=t.map((o,p)=>[o,p]);return l.sort((o,p)=>{const c=s(o[0],p[0]);return c!==0?c:o[1]-p[1]}),t=l.map(o=>o[0]),n&&(t=t.filter(o=>o.id.toString().toLowerCase().indexOf(n.toLowerCase())!==-1||o.name.toLowerCase().indexOf(n.toLowerCase())!==-1||o.email.toLowerCase().indexOf(n.toLowerCase())!==-1||o.phoneNumber.toString().toLowerCase().indexOf(n.toLowerCase())!==-1)),i||u&&h&&(t=t.filter(o=>U(o.createdAt,u,h))),t}const Ee={title:`Customers list | Dashboard - ${X.site.name}`};function vt(){const t=Y({queryKey:["customers"],queryFn:async()=>(await j.get(b.customers.list)).data});return t.isPending||t.isLoading?e.jsx(V,{}):t.isError?e.jsx(Z,{route:F.dashboard.customers.root}):e.jsxs(e.Fragment,{children:[e.jsx(_,{children:e.jsxs("title",{children:[" ",Ee.title]})}),e.jsx(Se,{customers:t.data})]})}export{vt as default};
