import{w as y,bG as v,j as e,aL as I,r as l,bM as C,S as u,I as g,bJ as b,dC as A,er as E,eb as B,p as f,aF as L,B as h,ep as D,e as T,es as F,ef as N,H as w,C as k,dM as Y,dK as M}from"./index-Bm3rBIkL.js";import{u as G,E as H}from"./error-block-BO5MDXKX.js";import{l as z}from"./index-BxF87Dkb.js";import{b as O}from"./format-number-zZ3CkgDh.js";import{C as _}from"./custom-breadcrumbs-DgyWxDBR.js";import{P as S}from"./permission-access-controller-Bd1g1bvY.js";import{u as q,g as K,T as W,a as J,e as Q}from"./table-selected-action-FGFYoCf9.js";import{T as V}from"./table-no-data-C5ESOE9S.js";import{T as $,a as U,b as X,c as Z}from"./table-head-custom-fAI8azNC.js";import{T as j}from"./TableCell-DwZUj5h4.js";import{T as ee}from"./TextField-Zaq0_UQI.js";import{I as te}from"./InputAdornment-C5fdA_pt.js";import{D as R}from"./DatePicker-BFbM1AIt.js";import{S as se}from"./Select-BbFY65UU.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./Checkbox-DZc8qiZw.js";import"./empty-content-Bj3fPw3b.js";import"./FormControl-Dpp_E6i1.js";import"./utils-DoM3o7-Q.js";import"./InputLabel-XKr5fbZR.js";import"./formControlState-Dq1zat_P.js";import"./FormLabel-CW4sUJth.js";import"./FormHelperText-D4MtsGiu.js";import"./index-I76JgJ8L.js";import"./visuallyHidden-Dan1xhjv.js";import"./DialogContent-adXfkuCx.js";import"./ListItem-B8LRzQux.js";import"./Chip-wb6jkBj9.js";import"./Menu-BCmDYN65.js";import"./InputBase-CLwZiNSB.js";const re=({row:t,selected:s,onViewRow:c,onSelectRow:m,onDeleteRow:p})=>{var i;y(),y(),v();const r=e.jsxs($,{hover:!0,selected:s,children:[e.jsx(j,{children:I(t==null?void 0:t.orderDate)}),e.jsxs(j,{children:["ORD-",t==null?void 0:t.id]}),e.jsx(j,{children:(i=t==null?void 0:t.customer)==null?void 0:i.name}),e.jsx(j,{children:O(t==null?void 0:t.totalOrderAmount)||"-"}),e.jsx(j,{children:t==null?void 0:t.status})]});return e.jsx(e.Fragment,{children:r})};function ae({filters:t,onResetPage:s}){const[c,m]=l.useState("all");l.useState(C()),l.useState(C());const p=l.useCallback(o=>{s(),t.setState({name:o.target.value})},[t,s]),r=l.useCallback(o=>{s(),t.setState({status:o.target.value}),m(o.target.value)},[t,s]),i=l.useCallback(o=>{s(),t.setState({startDate:o})},[t,s]),n=l.useCallback(o=>{s(),t.setState({endDate:o})},[t,s]);return e.jsxs(u,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},className:"print-hide",children:[e.jsx(ee,{sx:{flexGrow:1},value:t.state.name,onChange:p,placeholder:"Search customer or order number...",InputProps:{startAdornment:e.jsx(te,{position:"start",children:e.jsx(g,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),e.jsx(R,{label:"Start Date",sx:{flexGrow:1},format:"DD/MM/YYYY",value:t.state.startDate,onChange:i}),e.jsx(R,{label:"End Date",sx:{flexGrow:1},value:t.state.endDate,onChange:n,format:"DD/MM/YYYY"}),e.jsxs(se,{sx:{flexGrow:1,textTransform:"capitalize"},value:c,onChange:r,children:[e.jsx(b,{value:"all",children:"All Orders"}),e.jsx(b,{value:"InProcess",children:"Processing"}),e.jsx(b,{value:"Ready",children:"Ready To Deliver"}),e.jsx(b,{value:"Delivered",children:"Delivered"})]})]})}const ne=[{id:"date",label:"Date",width:140},{id:"orderId",label:"Order Id"},{id:"customer",label:"Customer"},{id:"orderAmount",label:"Order Amount"},{id:"status",label:"Status"}],oe=({orders:t})=>{const s=q({defaultOrderBy:"orderNumber"}),c=l.useRef(),[m,p]=l.useState(t),r=A({name:"",status:"all",startDate:null,endDate:null}),i=E(r.state.startDate,r.state.endDate),n=ie({inputData:m,comparator:K(s.order,s.orderBy),filters:r.state,dateError:i}),o=!!r.state.name||r.state.status!=="all"||!!r.state.startDate&&!!r.state.endDate,a=!n.length&&o||!n.length,x=z.useReactToPrint({content:()=>c.current});return e.jsx(B,{maxWidth:"xl",children:e.jsxs(u,{spacing:3,children:[e.jsx(_,{links:[{name:"Dashboard",href:f.dashboard.root},{name:"Reports",href:f.dashboard.reports.root},{name:"Order Report",href:f.dashboard.reports.order}]}),e.jsxs(L,{ref:c,className:"print-padding",children:[e.jsx(u,{justifyContent:"center",alignItems:"center",children:e.jsx("h1",{className:"print-title",children:"Order Reports"})}),e.jsx("style",{jsx:!0,children:`
            .print-title {
              display: none; /* Hide on screen */
            }

            @media print {
              .print-title {
                display: block; /* Show only when printing */
              }
              .print-hide {
                display: none; /* Hide on screen */
              }
              .print-padding {
                padding: 60px;
              }
            }
          `}),e.jsx(ae,{filters:r,onResetPage:s.onResetPage,dateError:i}),e.jsxs(h,{sx:{position:"relative"},children:[e.jsx(W,{dense:s.dense,numSelected:s.selected.length,rowCount:n.length,className:"print-hide"}),e.jsxs(U,{size:s.dense?"small":"medium",children:[e.jsx(X,{order:s.order,orderBy:s.orderBy,headLabel:ne,rowCount:n.length}),e.jsxs(Z,{children:[n.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(d=>e.jsx(re,{row:d,selected:s.selected.includes(d.id)},d.id)),e.jsx(J,{height:s.dense?56:76,emptyRows:Q(s.page,s.rowsPerPage,n.length)}),e.jsx(V,{notFound:a})]})]})]}),e.jsx(h,{children:e.jsxs(u,{direction:"row",justifyContent:"space-between",sx:{p:3,typography:"body2"},children:[e.jsxs(u,{spacing:1,children:[e.jsxs(h,{sx:{color:"text.secondary"},children:["Total Orders: ",n.length]}),e.jsxs(h,{sx:{color:"text.secondary"},children:["Total Order Amount:"," ",O(n.reduce((d,P)=>d+P.totalOrderAmount,0))]})]}),e.jsx(h,{children:e.jsxs(u,{direction:"row",spacing:1,className:"print-hide",children:[e.jsx(S,{permission:D.DOWNLOAD_REPORT,children:e.jsx(T,{variant:"contained",startIcon:e.jsx(g,{icon:"mdi:microsoft-excel"}),children:"Download Report"})}),e.jsx(S,{permission:D.PRINT_REPORT,children:e.jsx(T,{variant:"outlined",onClick:()=>x(),startIcon:e.jsx(g,{icon:"solar:printer-minimalistic-bold"}),children:"Print Report"})})]})})]})})]})]})})};function ie({inputData:t,comparator:s,filters:c,dateError:m}){const{status:p,name:r,startDate:i,endDate:n}=c,o=t.map((a,x)=>[a,x]);return o.sort((a,x)=>{const d=s(a[0],x[0]);return d!==0?d:a[1]-x[1]}),t=o.map(a=>a[0]),r&&(t=t.filter(a=>a.orderNumber.toLowerCase().indexOf(r.toLowerCase())!==-1||a.customer.name.toLowerCase().indexOf(r.toLowerCase())!==-1||a.customer.email.toLowerCase().indexOf(r.toLowerCase())!==-1)),p!=="all"&&(t=t.filter(a=>a.status===p)),m||i&&n&&(t=t.filter(a=>F(a.orderDate,i,n))),t}const le={title:`Reports list | Dashboard - ${k.site.name}`};function He(){const t=G({queryKey:["orders"],queryFn:async()=>{const{data:s}=await Y.get(M.order.list);return s}});return t.isPending||t.isLoading?e.jsx(N,{}):t.isError?e.jsx(H,{route:f.dashboard.reports.root}):e.jsxs(e.Fragment,{children:[e.jsx(w,{children:e.jsxs("title",{children:[" ",le.title]})}),e.jsx(oe,{orders:t.data})]})}export{He as default};
