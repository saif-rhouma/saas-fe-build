import{w as P,bG as W,j as e,du as _,y as L,I as g,dz as V,bI as G,ep as T,bJ as B,e as F,r as p,D as N,z as J,S as R,dC as U,er as $,dL as X,eb as Y,p as I,aF as Z,B as ee,dw as te,dB as se,es as oe,dM as y,dK as D,dN as S,ef as ae,H as re,C as ne}from"./index-Bm3rBIkL.js";import{u as ie,E as le}from"./error-block-BO5MDXKX.js";import{u as E}from"./useMutation-BPy7H-1h.js";import{C as de}from"./custom-breadcrumbs-DgyWxDBR.js";import{P as A}from"./permission-access-controller-Bd1g1bvY.js";import{u as ce,g as me,r as ue,T as pe,a as he,e as xe}from"./table-selected-action-FGFYoCf9.js";import{T as ge}from"./table-no-data-C5ESOE9S.js";import{T as je,a as fe,b as be,c as Ce}from"./table-head-custom-fAI8azNC.js";import{T as Pe}from"./table-pagination-custom-B5OCrP_3.js";import{b as ye}from"./format-number-zZ3CkgDh.js";import{C as De}from"./confirm-dialog-CdiBdWQ6.js";import{T as b}from"./TableCell-DwZUj5h4.js";import{z as C,u as Te,t as Ae,a as ve,F as w}from"./form-provider-BVzxbRNt.js";import"./image-BvWqJKQA.js";import"./editor-B_eq4lpY.js";import{a as Se,b as Ee,D as we}from"./DialogContent-adXfkuCx.js";import{D as Ie}from"./DialogTitle-3zwXmVtf.js";import{L as Fe}from"./LoadingButton-qKaJGA43.js";import{T as Re}from"./TextField-Zaq0_UQI.js";import{I as Be}from"./InputAdornment-C5fdA_pt.js";import{P as Ne}from"./product-table-filters-result-C8B5i4Dx.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./Checkbox-DZc8qiZw.js";import"./empty-content-Bj3fPw3b.js";import"./TablePagination-xS2VmU8P.js";import"./LastPage-Bo5KhWUM.js";import"./Select-BbFY65UU.js";import"./Menu-BCmDYN65.js";import"./utils-DoM3o7-Q.js";import"./formControlState-Dq1zat_P.js";import"./InputBase-CLwZiNSB.js";import"./FormControlLabel-3udn0dpo.js";import"./FormHelperText-D4MtsGiu.js";import"./Rating-DDX-0-qU.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-DEF2K-nH.js";import"./FormControl-Dpp_E6i1.js";import"./FormLabel-CW4sUJth.js";import"./RadioGroup-CcFDuSjI.js";import"./FormGroup-C2nO5a7k.js";import"./index-I76JgJ8L.js";import"./countries-DSLisFCy.js";import"./Autocomplete-uJqWLfO9.js";import"./Chip-wb6jkBj9.js";import"./country-select-dI5VfxcM.js";import"./InputLabel-XKr5fbZR.js";import"./upload-avatar-CklA5cX-.js";import"./DatePicker-BFbM1AIt.js";import"./ListItem-B8LRzQux.js";import"./MobileDateTimePicker-BrtExEWs.js";import"./index-DJLOkwgj.js";import"./CircularProgress-msI0ykgU.js";import"./filters-result-VXglGh15.js";const Le=({row:t,selected:s,onEditRow:l,onDeleteRow:n})=>{const d=P(),r=W(),m=e.jsxs(je,{hover:!0,selected:s,children:[e.jsx(b,{children:t==null?void 0:t.id}),e.jsx(b,{children:t==null?void 0:t.name}),e.jsx(b,{children:ye(t==null?void 0:t.price)}),e.jsx(b,{children:e.jsx(_,{variant:"soft",color:t.isActive===!0&&"success"||t.isActive===!1&&"error"||"default",children:t!=null&&t.isActive?"ACTIVE":"INACTIVE"})}),e.jsx(b,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:e.jsx(L,{color:r.open?"inherit":"default",onClick:r.onOpen,children:e.jsx(g,{icon:"eva:more-vertical-fill"})})})]});return e.jsxs(e.Fragment,{children:[m,e.jsx(V,{open:r.open,anchorEl:r.anchorEl,onClose:r.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(G,{children:[e.jsx(A,{permission:T.EDIT_ADDON,children:e.jsxs(B,{onClick:()=>{l(),r.onClose()},children:[e.jsx(g,{icon:"solar:pen-bold"}),"Edit"]})}),e.jsx(A,{permission:T.DELETE_ADDON,children:e.jsxs(B,{onClick:()=>{d.onTrue(),r.onClose()},sx:{color:"error.main"},children:[e.jsx(g,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})})]})}),e.jsx(De,{open:d.value,onClose:d.onFalse,title:"Delete",content:"Are you sure want to delete?",action:e.jsx(F,{variant:"contained",color:"error",onClick:n,children:"Delete"})})]})},ke=C.object({name:C.string().min(1,{message:"Name is required!"}),price:C.number().min(1,{message:"Tax number is required!"}),isActive:C.boolean()}),k=({productAddon:t,open:s,onClose:l,handler:n})=>{const d={name:(t==null?void 0:t.name)||"",price:parseInt(t==null?void 0:t.price)||"",isActive:t==null?void 0:t.isActive};p.useEffect(()=>{t&&x(d)},[t]);const[r,m]=p.useState(""),h=Te({resolver:Ae(ke),defaultValues:d}),{reset:x,handleSubmit:o,formState:{isSubmitting:u}}=h,i=o(async j=>{try{const c={...j};t?await n({id:t.id,payload:c}):await n(c),x()}catch(c){console.log(c),m(c instanceof Error?c.message:c)}});return e.jsxs(Se,{fullWidth:!0,open:s,onClose:l,children:[e.jsx(Ie,{children:"Add Addon"}),e.jsx(N,{}),!!r&&e.jsx(J,{severity:"error",sx:{mb:3},children:r}),e.jsxs(ve,{methods:h,onSubmit:i,children:[e.jsx(Ee,{children:e.jsxs(R,{spacing:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(1, 1fr)",md:"repeat(2, 1fr)",lg:"repeat(2, 1fr)"},children:[e.jsx(w.Text,{fullWidth:!0,label:"Enter Addon Name",name:"name",sx:{mt:2}}),e.jsx(w.Text,{fullWidth:!0,type:"number",label:"Enter Addon Price",name:"price",sx:{mt:2}}),e.jsx(w.Switch,{name:"isActive",label:"Is Active?"})]})}),e.jsx(N,{sx:{pt:1,mt:1}}),e.jsxs(we,{children:[e.jsx(Fe,{type:"submit",variant:"contained",children:t?"Save Changes":"Save"}),e.jsx(F,{color:"inherit",variant:"outlined",onClick:l,children:"Cancel"})]})]})]})},Oe=({productAddon:t,open:s,onClose:l,handler:n})=>e.jsx(k,{productAddon:t,open:s,onClose:l,handler:n});function qe({filters:t,onResetPage:s,options:l}){const n=p.useCallback(d=>{s(),t.setState({name:d.target.value})},[t,s]);return e.jsx(R,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:e.jsx(Re,{sx:{width:420},value:t.state.name,onChange:n,placeholder:"Search by Product Addon Name or Id Number...",InputProps:{startAdornment:e.jsx(Be,{position:"start",children:e.jsx(g,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})}const He=[{id:"addonId",label:"No.",width:60},{id:"addon",label:"Addon",width:240},{id:"price",label:"Price",width:140},{id:"status",label:"Status",width:140},{id:"",width:88}];function Me({productAddons:t}){const s=ce({defaultOrderBy:"planId"}),l=P(),n=P(),d=P(),[r,m]=p.useState(t),[h,x]=p.useState(),o=U({name:"",status:"all",startDate:null,endDate:null});p.useEffect(()=>{m(t)},[t]);const u=$(o.state.startDate,o.state.endDate),i=ze({inputData:r,comparator:me(s.order,s.orderBy),filters:o.state,dateError:u}),j=ue(i,s.page,s.rowsPerPage),c=!!o.state.name||o.state.status!=="all"||!!o.state.startDate&&!!o.state.endDate,O=!i.length&&c||!i.length,q=p.useCallback(a=>{K(a)},[j.length,s,r]),H=p.useCallback(a=>{x(a),n.onToggle()},[j.length,s,r]),v=X(),{mutate:M}=E({mutationFn:a=>y.post(D.productAddons.create,a),onSuccess:async()=>{S.success("New Product Addon Has Been Created!")},onSettled:async()=>{await v.invalidateQueries({queryKey:["product-addons"]}),l.onFalse()},onError:a=>{console.log(a)}}),{mutate:z}=E({mutationFn:({id:a,payload:f})=>y.patch(D.productAddons.edit+a,f),onSuccess:async()=>{S.success("New Product Addon Has Been Modified!")},onSettled:async()=>{await v.invalidateQueries({queryKey:["product-addons"]}),n.onFalse()},onError:a=>{console.log(a)}}),{mutate:K}=E({mutationFn:a=>y.delete(D.productAddons.delete+a),onSuccess:async a=>{const f=r.filter(Q=>Q.id!==a);S.success("Delete success!"),m(f),s.onUpdatePageDeleteRow(j.length)},onSettled:async()=>{await v.invalidateQueries({queryKey:["product-addons"]})},onError:a=>{console.log(a)}});return e.jsxs(e.Fragment,{children:[e.jsx(Y,{maxWidth:"xl",children:e.jsxs(R,{spacing:3,children:[e.jsx(de,{links:[{name:"Dashboard",href:I.dashboard.root},{name:"Products",href:I.dashboard.product.root},{name:"Product Addons"}],action:e.jsx(A,{permission:T.ADD_ADDON,children:e.jsx(F,{onClick:()=>l.onToggle(),variant:"contained",startIcon:e.jsx(g,{icon:"mingcute:add-line"}),children:"Add New Addon"})})}),e.jsx(A,{permission:T.LIST_ADDON,children:e.jsxs(Z,{children:[e.jsx(qe,{filters:o,onResetPage:s.onResetPage,dateError:u}),c&&e.jsx(Ne,{filters:o,totalResults:i.length,onResetPage:s.onResetPage,sx:{p:2.5,pt:0}}),e.jsxs(ee,{sx:{position:"relative"},children:[e.jsx(pe,{dense:s.dense,numSelected:s.selected.length,rowCount:i.length,onSelectAllRows:a=>s.onSelectAllRows(a,i.map(f=>f.id)),action:e.jsx(te,{title:"Delete",children:e.jsx(L,{color:"primary",onClick:d.onTrue,children:e.jsx(g,{icon:"solar:trash-bin-trash-bold"})})})}),e.jsx(se,{sx:{minHeight:200},children:e.jsxs(fe,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(be,{order:s.order,orderBy:s.orderBy,headLabel:He,rowCount:i.length}),i.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(a=>e.jsx(Le,{row:a,selected:s.selected.includes(a.id),onEditRow:()=>H(a),onDeleteRow:()=>q(a.id)},a.id)),e.jsxs(Ce,{children:[e.jsx(he,{height:s.dense?56:76,emptyRows:xe(s.page,s.rowsPerPage,i.length)}),e.jsx(ge,{notFound:O})]})]})})]}),e.jsx(Pe,{page:s.page,dense:s.dense,count:i.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onChangeDense:s.onChangeDense,onRowsPerPageChange:s.onChangeRowsPerPage})]})})]})}),e.jsx(k,{open:l.value,onClose:l.onFalse,handler:M}),e.jsx(Oe,{open:n.value,onClose:n.onFalse,handler:z,productAddon:h})]})}function ze({inputData:t,comparator:s,filters:l,dateError:n}){const{status:d,name:r,startDate:m,endDate:h}=l,x=t.map((o,u)=>[o,u]);return x.sort((o,u)=>{const i=s(o[0],u[0]);return i!==0?i:o[1]-u[1]}),t=x.map(o=>o[0]),r&&(t=t.filter(o=>o.id.toString().toLowerCase().indexOf(r.toLowerCase())!==-1||o.name.toLowerCase().indexOf(r.toLowerCase())!==-1)),d!=="all"&&(t=t.filter(o=>o.status===d)),n||m&&h&&(t=t.filter(o=>oe(o.createdAt,m,h))),t}const Ke={title:`Product Addons | Dashboard - ${ne.site.name}`};function Wt(){const t=ie({queryKey:["product-addons"],queryFn:async()=>{const{data:s}=await y.get(D.productAddons.list);return s}});return t.isPending||t.isLoading?e.jsx(ae,{}):t.isError?e.jsx(le,{route:I.dashboard.product.root}):e.jsxs(e.Fragment,{children:[e.jsx(re,{children:e.jsxs("title",{children:[" ",Ke.title]})}),e.jsx(Me,{productAddons:t.data})]})}export{Wt as default};
