import{j as e,d1 as I,r as d,br as v,ab as y,S as g,I as T,a7 as b,df as N,e3 as k,dQ as B,p as j,cZ as E,B as f,e4 as C,e as R,ep as L,ed as A,dU as F,H as M,C as H,dq as O,dn as Y}from"./index-3kUlxXkm.js";import{u as $,E as w}from"./error-block-BTCpMwIj.js";import{C as q}from"./custom-breadcrumbs-CQM3hT8w.js";import{P as D}from"./permission-access-controller-6Z2YefAG.js";import{g as G,e as Q}from"./utils-MBUcMVfY.js";import{u as z}from"./use-table-9MzCtmNE.js";import{T as W}from"./table-no-data-DRMtffow.js";import{T as _}from"./table-empty-rows-R6XLgnwX.js";import{T as K,a as U,b as Z,c as J}from"./table-head-custom-Bzh_BuNQ.js";import{T as V}from"./table-selected-action-77MIBAPT.js";import{T as X}from"./table-pagination-custom-HAHTP3sF.js";import{T as x}from"./TableCell-YgDy_fKI.js";import{T as ee}from"./TextField-Ff9PgcBD.js";import{I as te}from"./InputAdornment-Ug97Thua.js";import{D as S}from"./DatePicker-vbOob6Xb.js";import{S as ae}from"./Select-DOB8r047.js";import"./utils-km2FGkQ4.js";import"./bounce-BSK3KHpz.js";import"./transition-BJzcwH5q.js";import"./empty-content-DygIpP7Y.js";import"./Checkbox-BPHZ30Zu.js";import"./TablePagination-CVcJMlXd.js";import"./KeyboardArrowRight-o7aJmcRm.js";import"./LastPage-FHI8cfYQ.js";import"./InputBase-Df4WeLlJ.js";import"./formControlState-Dq1zat_P.js";import"./utils-DoM3o7-Q.js";import"./FormControlLabel-DWtRb9VA.js";import"./FormControl-BaWzc8Dl.js";import"./InputLabel-Df2ESQnA.js";import"./FormLabel-CX5M124t.js";import"./FormHelperText-47ensrNn.js";import"./index-BySBJlbP.js";import"./visuallyHidden-Dan1xhjv.js";import"./DialogContent-BZuUPSmG.js";import"./ListItem-CBu29PKK.js";import"./Chip-yUQfyewU.js";import"./Menu-CsXXwNKW.js";const se=({row:t,selected:a})=>{var c;const p=e.jsxs(K,{hover:!0,selected:a,children:[e.jsx(x,{children:I(t==null?void 0:t.planDate)}),e.jsx(x,{children:t==null?void 0:t.ref}),e.jsx(x,{children:(c=t==null?void 0:t.product)==null?void 0:c.name}),e.jsx(x,{children:t==null?void 0:t.quantity}),e.jsx(x,{children:t==null?void 0:t.status})]});return e.jsx(e.Fragment,{children:p})};function re({filters:t,onResetPage:a}){const[p,c]=d.useState("all"),{t:r}=v("reports");d.useState(y()),d.useState(y());const l=d.useCallback(s=>{a(),t.setState({name:s.target.value})},[t,a]),o=d.useCallback(s=>{a(),t.setState({status:s.target.value}),c(s.target.value)},[t,a]),m=d.useCallback(s=>{a(),t.setState({startDate:s})},[t,a]),n=d.useCallback(s=>{a(),t.setState({endDate:s})},[t,a]);return e.jsxs(g,{spacing:2,justifyContent:{xs:"space-between"},alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5},children:[e.jsx(ee,{sx:{flexGrow:1},value:t.state.name,onChange:l,placeholder:r("planReports.table.tableToolbar.searchPlaceholder"),InputProps:{startAdornment:e.jsx(te,{position:"start",children:e.jsx(T,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),e.jsx(S,{label:r("planReports.table.tableToolbar.startDate"),sx:{flexGrow:1},format:"DD/MM/YYYY",value:t.state.startDate,onChange:m}),e.jsx(S,{label:r("planReports.table.tableToolbar.endDate"),sx:{flexGrow:1},value:t.state.endDate,onChange:n,format:"DD/MM/YYYY"}),e.jsxs(ae,{sx:{width:420,textTransform:"capitalize"},value:p,onChange:o,children:[e.jsx(b,{value:"all",children:r("planReports.table.tableToolbar.selectMenu.allPlans")}),e.jsx(b,{value:"Pending",children:r("planReports.table.tableToolbar.selectMenu.pending")}),e.jsx(b,{value:"ProcessingA",children:r("planReports.table.tableToolbar.selectMenu.processingA")}),e.jsx(b,{value:"ProcessingB",children:r("planReports.table.tableToolbar.selectMenu.processingB")}),e.jsx(b,{value:"Ready",children:r("planReports.table.tableToolbar.selectMenu.ready")})]})]})}const oe=({plans:t})=>{const a=z({defaultOrderBy:"orderNumber"}),[p,c]=d.useState(t),{t:r}=v("reports"),l=[{id:"date",label:`${r("planReports.table.tableHeader.date")}`,width:300},{id:"planId",label:`${r("planReports.table.tableHeader.planId")}`},{id:"productName",label:`${r("planReports.table.tableHeader.productName")}`},{id:"orderAmount",label:`${r("planReports.table.tableHeader.productQty")}`},{id:"status",label:`${r("planReports.table.tableHeader.date")}`}],o=N({name:"",status:"all",startDate:null,endDate:null}),m=k(o.state.startDate,o.state.endDate),n=ne({inputData:p,comparator:G(a.order,a.orderBy),filters:o.state,dateError:m}),s=!!o.state.name||o.state.status!=="all"||!!o.state.startDate&&!!o.state.endDate,u=!n.length&&s||!n.length,h=[{displayName:"Date",key:"planDate"},{displayName:"Plan Ref",key:"ref"},{displayName:"Product Name",key:"name"},{displayName:"Product QTY",key:"quantity"},{displayName:"Status",key:"status"}];return e.jsx(B,{maxWidth:"xl",children:e.jsxs(g,{spacing:3,children:[e.jsx(q,{links:[{name:`${r("planReports.breadCrumbsPageRootTitle")}`,href:j.dashboard.root},{name:`${r("planReports.breadCrumbsParentPageTitle")}`,href:j.dashboard.reports.root},{name:`${r("planReports.breadCrumbsPageTitle")}`,href:j.dashboard.reports.plan}]}),e.jsxs(E,{children:[e.jsx(re,{filters:o,onResetPage:a.onResetPage,dateError:m}),e.jsxs(f,{sx:{position:"relative"},children:[e.jsx(V,{dense:a.dense,numSelected:a.selected.length,rowCount:n.length}),e.jsxs(U,{size:a.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Z,{order:a.order,orderBy:a.orderBy,headLabel:l,rowCount:n.length}),e.jsxs(J,{children:[n.slice(a.page*a.rowsPerPage,a.page*a.rowsPerPage+a.rowsPerPage).map(i=>e.jsx(se,{row:i,selected:a.selected.includes(i.id)},i.id)),e.jsx(_,{height:a.dense?56:76,emptyRows:Q(a.page,a.rowsPerPage,n.length)}),e.jsx(W,{notFound:u})]})]})]}),e.jsx(X,{className:"print-hide",page:a.page,count:n.length,rowsPerPage:a.rowsPerPage,onPageChange:a.onChangePage,onRowsPerPageChange:a.onChangeRowsPerPage}),e.jsx(f,{children:e.jsx(g,{direction:"row",justifyContent:"flex-end",sx:{p:3,typography:"body2"},children:e.jsx(f,{children:e.jsxs(g,{direction:"row",spacing:1,children:[e.jsx(D,{permission:C.DOWNLOAD_REPORT,children:e.jsx(R,{onClick:()=>{L("plan reports",h,n.map(i=>{var P;return{...i,name:(P=i==null?void 0:i.product)==null?void 0:P.name}}),"Stock")},variant:"contained",startIcon:e.jsx(T,{icon:"mdi:microsoft-excel"}),children:r("orderReports.downloadReport")})}),e.jsx(D,{permission:C.PRINT_REPORT,children:e.jsx(R,{variant:"outlined",startIcon:e.jsx(T,{icon:"solar:printer-minimalistic-bold"}),children:r("orderReports.printReport")})})]})})})})]})]})})};function ne({inputData:t,comparator:a,filters:p,dateError:c}){const{status:r,name:l,startDate:o,endDate:m}=p,n=t.map((s,u)=>[s,u]);return n.sort((s,u)=>{const h=a(s[0],u[0]);return h!==0?h:s[1]-u[1]}),t=n.map(s=>s[0]),l&&(t=t.filter(s=>s.orderNumber.toLowerCase().indexOf(l.toLowerCase())!==-1||s.customer.name.toLowerCase().indexOf(l.toLowerCase())!==-1||s.customer.email.toLowerCase().indexOf(l.toLowerCase())!==-1)),r!=="all"&&(t=t.filter(s=>s.status===r)),c||o&&m&&(t=t.filter(s=>A(s.planDate,o,m))),t}const le={title:`Reports list | Dashboard - ${H.site.name}`};function We(){const t=$({queryKey:["plans"],queryFn:async()=>{const{data:a}=await O.get(Y.plan.list);return a}});return t.isPending||t.isLoading?e.jsx(F,{}):t.isError?e.jsx(w,{route:j.dashboard.reports.root}):e.jsxs(e.Fragment,{children:[e.jsx(M,{children:e.jsxs("title",{children:[" ",le.title]})}),e.jsx(oe,{plans:t.data})]})}export{We as default};
